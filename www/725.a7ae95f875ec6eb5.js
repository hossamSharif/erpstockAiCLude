"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[725],{10725:(ot,f,_)=>{_.r(f),_.d(f,{EditPrchOrderPageModule:()=>et});var d=_(69808),u=_(34182),c=_(23349),g=_(94030),h=_(70655),y=_(3671),Z=_(79208),T=_(36387),x=_(5022),t=_(29863),A=_(90849),P=_(91472);const I=["dstEp"],b=["qtyIdEp"],v=["dstPop4"],q=["popInput4"],C=["popover4"];function M(o,r){1&o&&t._UZ(0,"option",25),2&o&&t.Q6J("value",r.$implicit.sub_name)}function O(o,r){if(1&o&&(t.TgZ(0,"datalist",23),t.YNc(1,M,1,1,"option",24),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.sub_account)}}function E(o,r){1&o&&(t.TgZ(0,"ion-label"),t.TgZ(1,"ion-text",26),t._uU(2,"\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644 "),t.qZA(),t.qZA())}function L(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).refresh("account")}),t._UZ(1,"ion-icon",28),t.qZA()}}function w(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",8),t.TgZ(1,"ion-item",18),t.TgZ(2,"input",20),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).selectedAccount.sub_name=n})("change",function(n){return t.CHM(e),t.oxw(2).pickAccount(n)}),t.qZA(),t.YNc(3,O,2,1,"datalist",21),t.YNc(4,E,3,0,"ion-label",3),t.YNc(5,L,2,0,"ion-button",22),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.selectedAccount.sub_name),t.xp6(1),t.Q6J("ngIf",e.sub_account),t.xp6(1),t.Q6J("ngIf",!e.sub_account),t.xp6(1),t.Q6J("ngIf",!e.sub_account)}}function J(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",8),t.TgZ(1,"ion-item",18),t.TgZ(2,"ion-input",9),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).sub_nameNew=n}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.sub_nameNew)}}function N(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",29),t.TgZ(1,"ion-item",18),t.TgZ(2,"ion-input",9),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).sub_nameNew=n}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.sub_nameNew)}}function k(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",30),t.TgZ(1,"ion-item",18),t.TgZ(2,"ion-input",31),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).selectedAccount.phone=n}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.selectedAccount.phone)}}function F(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",32),t.TgZ(1,"ion-item",18),t.TgZ(2,"ion-input",33),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).selectedAccount.address=n}),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.selectedAccount.address)}}function Q(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-grid"),t.TgZ(1,"ion-row",5),t.TgZ(2,"ion-col",6),t.TgZ(3,"ion-card",7),t.TgZ(4,"ion-grid",7),t.TgZ(5,"ion-row",5),t.TgZ(6,"ion-col",8),t.TgZ(7,"ion-radio-group",9),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().radioVal=n}),t.TgZ(8,"ion-grid",7),t.TgZ(9,"ion-row"),t.TgZ(10,"ion-col",7),t.TgZ(11,"ion-item",10),t._UZ(12,"ion-radio",11),t.TgZ(13,"ion-label"),t._uU(14,"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"ion-col",7),t.TgZ(16,"ion-item",10),t._UZ(17,"ion-radio",11),t.TgZ(18,"ion-label"),t._uU(19,"\u062d\u0633\u0627\u0628 \u062c\u062f\u064a\u062f"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"ion-col",12),t.TgZ(21,"ion-item",10),t.TgZ(22,"input",13),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().payInvo.pay_date=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"ion-row"),t.YNc(24,w,6,4,"ion-col",14),t.YNc(25,J,3,1,"ion-col",14),t.YNc(26,N,3,1,"ion-col",15),t.YNc(27,k,3,1,"ion-col",16),t.YNc(28,F,3,1,"ion-col",17),t.TgZ(29,"ion-col"),t.TgZ(30,"ion-item",18),t.TgZ(31,"ion-input",19),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().payInvo.payComment=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(7),t.Q6J("ngModel",e.radioVal),t.xp6(5),t.Q6J("value",0),t.xp6(5),t.Q6J("value",1),t.xp6(5),t.Q6J("ngModel",e.payInvo.pay_date),t.xp6(2),t.Q6J("ngIf",0==e.radioVal),t.xp6(1),t.Q6J("ngIf",1==e.radioVal),t.xp6(1),t.Q6J("ngIf",1==e.radioVal),t.xp6(1),t.Q6J("ngIf",1==e.radioVal),t.xp6(1),t.Q6J("ngIf",1==e.radioVal),t.xp6(3),t.Q6J("ngModel",e.payInvo.payComment)}}function U(o,r){1&o&&(t.TgZ(0,"ion-text"),t._uU(1,"(\u0639\u0631\u0628\u064a)"),t.qZA())}function S(o,r){1&o&&(t.TgZ(0,"ion-text"),t._uU(1,"(ENG)"),t.qZA())}function H(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-col",59),t.TgZ(1,"ion-button",60),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).presentModal2("null","save")}),t._uU(2," \u0635\u0646\u0641 \u062c\u062f\u064a\u062f "),t._UZ(3,"ion-icon",61),t.qZA(),t.qZA()}}function Y(o,r){1&o&&(t.TgZ(0,"ion-list",51),t.TgZ(1,"ion-label"),t._UZ(2,"ion-spinner",68),t.qZA(),t.qZA())}const D=function(o,r){return{red:o,dark:r}};function z(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item",70),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(4).selectFromPop(s)}),t._uU(1),t.qZA()}if(2&o){const e=r.$implicit;t.Q6J("ngClass",t.WLB(2,D,0==e.quantity,e.quantity>0)),t.xp6(1),t.hij(" ",e.item_name," ")}}function R(o,r){if(1&o&&(t.TgZ(0,"ion-list"),t.YNc(1,z,2,5,"ion-item",69),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.searchResult)}}function G(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar",5),t.TgZ(2,"ion-item"),t.TgZ(3,"ion-input",62,63),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).searchTerm=n})("ionChange",function(n){return t.CHM(e),t.oxw(2).searchItem(n)}),t.qZA(),t.TgZ(5,"ion-button",64),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).clear()}),t._UZ(6,"ion-icon",65),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"ion-content",66),t.YNc(8,Y,3,0,"ion-list",67),t.YNc(9,R,2,1,"ion-list",3),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(3),t.Q6J("ngModel",e.searchTerm),t.xp6(5),t.Q6J("ngIf",0==e.searchResult.length&&""==e.searchTerm),t.xp6(1),t.Q6J("ngIf",e.searchResult.length>0)}}function V(o,r){if(1&o&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.quantity)}}function B(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item"),t.TgZ(1,"ion-input",74),t.NdJ("keyup.enter",function(){t.CHM(e);const n=t.oxw().index;return t.oxw(2).editCell(n)})("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.quantity=n})("ionBlur",function(){t.CHM(e);const n=t.oxw().index;return t.oxw(2).editCell(n)}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.quantity)}}function $(o,r){if(1&o&&(t.TgZ(0,"ion-text"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.perch_price)}}function j(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item"),t.TgZ(1,"ion-input",74),t.NdJ("keyup.enter",function(){t.CHM(e);const n=t.oxw().index;return t.oxw(2).editCell(n)})("ngModelChange",function(n){return t.CHM(e),t.oxw().$implicit.perch_price=n})("ionBlur",function(){t.CHM(e);const n=t.oxw().index;return t.oxw(2).editCell(n)}),t.qZA(),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngModel",e.perch_price)}}function W(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"tr",71),t.NdJ("dblclick",function(){const s=t.CHM(e).index;return t.oxw(2).qtyClick(s)}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t.YNc(8,V,2,1,"ion-text",3),t.YNc(9,B,2,1,"ion-item",3),t.qZA(),t.TgZ(10,"td"),t.YNc(11,$,2,1,"ion-text",3),t.YNc(12,j,2,1,"ion-item",3),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td"),t.TgZ(16,"ion-button",72),t.NdJ("click",function(){const s=t.CHM(e).index;return t.oxw(2).deleteItem(s)}),t._UZ(17,"ion-icon",73),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=r.$implicit,i=r.index,n=t.oxw(2);t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.item_name),t.xp6(2),t.Oqu(e.item_desc),t.xp6(2),t.Q6J("ngIf",n.showMe!=i),t.xp6(1),t.Q6J("ngIf",n.showMe==i),t.xp6(2),t.Q6J("ngIf",n.showMe!=i),t.xp6(1),t.Q6J("ngIf",n.showMe==i),t.xp6(2),t.Oqu(+e.tot)}}function K(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"ion-grid",34),t.TgZ(1,"ion-row",5),t.TgZ(2,"ion-col",35),t.TgZ(3,"ion-grid"),t.TgZ(4,"ion-row"),t.TgZ(5,"ion-col",6),t.TgZ(6,"ion-card"),t.TgZ(7,"ion-grid"),t.TgZ(8,"ion-row"),t.TgZ(9,"ion-col",36),t.TgZ(10,"ion-grid",37),t.TgZ(11,"ion-row"),t.TgZ(12,"ion-col",38),t.TgZ(13,"ion-label"),t.TgZ(14,"strong"),t._uU(15,"\u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.YNc(16,U,2,0,"ion-text",3),t.YNc(17,S,2,0,"ion-text",3),t.qZA(),t.qZA(),t.YNc(18,H,4,0,"ion-col",39),t.qZA(),t.TgZ(19,"ion-row"),t.TgZ(20,"ion-item",18),t.TgZ(21,"ion-input",40,41),t.NdJ("click",function(n){return t.CHM(e),t.oxw().presentPopover(n)})("ngModelChange",function(n){return t.CHM(e),t.oxw().selectedItem.item_name=n}),t.qZA(),t.qZA(),t.TgZ(23,"ion-popover",42,43),t.NdJ("didDismiss",function(){return t.CHM(e),t.oxw().didDissmis()}),t.YNc(25,G,10,3,"ng-template"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"ion-col",44),t.TgZ(27,"ion-label",45),t.TgZ(28,"strong"),t._uU(29,"\u0627\u0644\u0643\u0645\u064a\u0629"),t.qZA(),t.qZA(),t.TgZ(30,"ion-item",18),t.TgZ(31,"ion-input",46,47),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().addTolist()})("ngModelChange",function(n){return t.CHM(e),t.oxw().selectedItem.qty=n})("ionChange",function(n){return t.CHM(e),t.oxw().qtyhange(n)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"ion-col",44),t.TgZ(34,"ion-label",45),t.TgZ(35,"strong"),t._uU(36,"\u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621"),t.qZA(),t.qZA(),t.TgZ(37,"ion-item",18),t.TgZ(38,"ion-input",46),t.NdJ("keyup.enter",function(){return t.CHM(e),t.oxw().addTolist()})("ngModelChange",function(n){return t.CHM(e),t.oxw().selectedItem.perch_price=n})("ionChange",function(n){return t.CHM(e),t.oxw().pricehange(n)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(39,"ion-col",44),t.TgZ(40,"ion-label",45),t.TgZ(41,"strong"),t._uU(42,"\u0627\u0644\u0645\u062c\u0645\u0648\u0639"),t.qZA(),t.qZA(),t.TgZ(43,"ion-item",18),t.TgZ(44,"ion-input",48),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().selectedItem.tot=n}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(45,"ion-col",49),t.TgZ(46,"ion-button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().addTolist()}),t.TgZ(47,"ion-label",51),t._uU(48," +"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(49,"ion-row"),t.TgZ(50,"ion-col",6),t.TgZ(51,"ion-card"),t.TgZ(52,"table",52),t.TgZ(53,"tr"),t.TgZ(54,"th"),t._uU(55,"no"),t.qZA(),t.TgZ(56,"th"),t._uU(57,"\u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.TgZ(58,"th"),t._uU(59,"\u064fEN"),t.qZA(),t.TgZ(60,"th"),t._uU(61,"\u0627\u0644\u0643\u0645\u064a\u0629"),t.qZA(),t.TgZ(62,"th"),t._uU(63,"\u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621"),t.qZA(),t.TgZ(64,"th"),t._uU(65,"\u0627\u0644\u0645\u062c\u0645\u0648\u0639"),t.qZA(),t._UZ(66,"th"),t.qZA(),t.YNc(67,W,18,8,"tr",53),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(68,"ion-col",54),t.TgZ(69,"ion-card"),t.TgZ(70,"ion-grid"),t.TgZ(71,"ion-row",55),t.TgZ(72,"ion-col",56),t.TgZ(73,"ion-label",45),t.TgZ(74,"strong"),t._uU(75,"\u0627\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u0628\u0644\u063a"),t.qZA(),t.qZA(),t.TgZ(76,"ion-item",18),t.TgZ(77,"ion-input",48),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw().payInvo.tot_pr=n}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(78,"ion-row",55),t.TgZ(79,"ion-col",57),t.TgZ(80,"ion-button",50),t.NdJ("click",function(){return t.CHM(e),t.oxw().update()}),t.TgZ(81,"ion-label",51),t._uU(82," \u062d\u0641\u0640\u0640\u0638"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(83,"ion-col",57),t.TgZ(84,"ion-button",58),t.NdJ("click",function(){return t.CHM(e),t.oxw().delete()}),t.TgZ(85,"ion-label",51),t._uU(86," \u062d\u0640\u0640\u0630\u0641"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(16),t.Q6J("ngIf",0==e.searchLang),t.xp6(1),t.Q6J("ngIf",1==e.searchLang),t.xp6(1),t.Q6J("ngIf",0==e.offline),t.xp6(3),t.Q6J("ngModel",e.selectedItem.item_name),t.xp6(2),t.Q6J("isOpen",e.isOpen),t.xp6(8),t.Q6J("ngModel",e.selectedItem.qty),t.xp6(7),t.Q6J("ngModel",e.selectedItem.perch_price),t.xp6(6),t.Q6J("ngModel",e.selectedItem.tot)("readonly",!0),t.xp6(23),t.Q6J("ngForOf",e.itemList),t.xp6(10),t.Q6J("ngModel",e.payInvo.tot_pr)("readonly",!0)}}const X=[{path:"",component:(()=>{class o{constructor(e,i,n,s,a,m,p,it,nt,st){this._location=e,this.alertController=i,this.route=n,this.rout=s,this.storage=a,this.modalController=m,this.loadingController=p,this.datePipe=it,this.api=nt,this.toast=st,this.isOpen=!1,this.sub_account=[],this.sub_accountLocalPurch=[],this.items=[],this.itemsLocal=[],this.itemList=[],this.sub_accountPurch=[],this.purchLocal=[],this.purchase=[],this.purchLocalUpdate=[],this.purchLocalDelete=[],this.randomsNumber=[],this.store_id=1,this.sub_nameNew="",this.discountPerc=0,this.radioVal=0,this.searchLang=0,this.showMe=null,this.searchTerm="",this.aliasTerm="",this.searchResult=[],this.aliasResult=[],this.selectedAccount={id:"",ac_id:"",sub_name:"",sub_type:"",sub_code:"",sub_balance:"",store_id:"",cat_name:"",cat_id:"",phone:"",address:""},this.route.queryParams.subscribe(l=>{l&&l.payInvo&&(this.payInvo=JSON.parse(l.payInvo),this.selectedAccount.sub_name=JSON.parse(l.sub_name),this.user_info=JSON.parse(l.user_info),this.store_info=JSON.parse(l.store_info),this.itemList=JSON.parse(l.itemList),this.discountPerc=(+this.payInvo.discount/+this.payInvo.tot_pr*100).toFixed(2),this.prepareOffline(),this.getAppInfo())}),this.selectedItem={id:void 0,dateCreated:"",pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,aliasEn:""}}ngOnInit(){this.getStockItems()}getItems(e){0==this.offline?this.api.getItems().subscribe(i=>{this.items=i.data,e&&this.pickDetail(e,"afterSave")},i=>{}):this.items=this.itemsLocal}getStockItems(e){0==this.offline?this.api.stockItems(1,this.year.id).subscribe(i=>{this.items=i.data,this.items.forEach(s=>{s.quantity=+s.perchQuantity+ +s.firstQuantity-+s.salesQuantity}),this.searchResult=this.items,e&&this.pickDetail(e,"afterSave")},i=>{},()=>{}):(this.items=this.itemsLocal,this.items.forEach(i=>{i.quantity=+i.perchQuantity+ +i.firstQuantity-+i.salesQuantity}),this.searchResult=this.items)}getOffliemode(){this.storage.get("offline").then(e=>{this.offline=e})}prepareOffline(){this.storage.get("offline").then(e=>{this.offline=e}),this.storage.get("purchLocal").then(e=>{e&&(this.purchLocal=e)}),this.storage.get("sub_accountPurch").then(e=>{e&&(this.sub_accountPurch=e)}),this.storage.get("sub_accountLocalPurch").then(e=>{e&&(this.sub_accountLocalPurch=e)}),this.storage.get("itemsLocal").then(e=>{e&&(this.itemsLocal=e,this.items=this.itemsLocal)}),this.storage.get("purchase").then(e=>{e&&(this.purchase=e)}),this.getStockItems()}getAppInfo(){this.storage.get("offline").then(e=>{this.offline=e}),this.storage.get("year").then(e=>{e&&(this.year=e)}),this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.getSalesAccountFirs())}),this.storage.get("purchLocalUpdate").then(e=>{e&&(this.purchLocalUpdate=e)}),this.storage.get("purchLocalDelete").then(e=>{e&&(this.purchLocalDelete=e)}),this.storage.get("searchLang").then(e=>{e&&(this.searchLang=e)})}getSalesAccountFirs(){0==this.offline?this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_account=e.data,this.addSubaccountLocal(),this.pickAccount(this.selectedAccount.sub_name,"fl")},e=>{}):(this.MixSubaccountSalesOffline(),this.pickAccount(this.selectedAccount.sub_name,"fl"))}qtyClick(e){this.showMe=e}hideMe(e){this.showMe=null}editCell(e){+this.itemList[e].quantity>0&&+this.itemList[e].perch_price>0?(this.itemList[e].tot=+this.itemList[e].quantity*+this.itemList[e].perch_price,this.discountPerc=0,this.payInvo.discount=0,this.hideMe(e),this.getTotal()):this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u062f\u062e\u0627\u0644 ","danger")}getSalesAccount(){0==this.offline?this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_account=e.data,this.addSubaccountLocal()},e=>{}):this.MixSubaccountSalesOffline()}addSubaccountLocal(){if(this.sub_account){if(this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account.push(this.sub_accountLocalPurch[e])}else this.sub_accountLocalPurch&&(this.sub_account=this.sub_accountLocalPurch)}MixSubaccountSalesOffline(){if(this.sub_account=[],this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account.push(this.sub_accountLocalPurch[e]);if(this.sub_accountPurch)for(let e=0;e<this.sub_accountPurch.length;e++)this.sub_account.push(this.sub_accountPurch[e])}prepareInvo(){this.sub_nameNew="",this.radioVal=0,this.payInvo={pay_id:this.payArray[0].pay_id,pay_ref:this.payArray[0].pay_ref,store_id:this.payArray[0].store_id,tot_pr:this.payArray[0].tot_pr,pay:this.payArray[0].pay,pay_date:this.payArray[0].pay_date,pay_time:this.payArray[0].pay_time,user_id:this.payArray[0].user_id,cust_id:this.payArray[0].cust_id,pay_method:this.payArray[0].pay_method,discount:this.payArray[0].discount,changee:this.payArray[0].changee,sub_name:this.payArray[0].sub_name,payComment:this.payArray[0].payComment,nextPay:this.payArray[0].nextPay},this.selectedAccount.sub_name=this.payArray[0].sub_name,this.pickAccount(this.payArray[0].sub_name),this.itemList=this.payArray.details,this.setFocusOnInput("dstEp")}setFocusOnInput(e){"dstEp"==e?this.dstEp.nativeElement.focus():"dstPop4"==e?(this.dstPop4.setFocus(),this.isOpen=!0,this.clear(),this.searchResult=this.items,setTimeout(()=>{this.popInput4.setFocus()},1500)):"qtyIdEp"==e?this.qtyIdEp.setFocus():"popInput4"==e&&this.popInput4.setFocus()}presentToast(e,i){return(0,h.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:e,duration:2e3,color:i,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}presentLoadingWithOptions(e){return(0,h.mG)(this,void 0,void 0,function*(){const i=yield this.loadingController.create({spinner:"bubbles",mode:"ios",duration:5e3,message:e,translucent:!0,backdropDismiss:!1});yield i.present(),yield i.onDidDismiss()})}pickAccount(e,i){let n;n=i?e:e.target.value;let s=this.sub_account.filter(a=>a.sub_name==n);s.length>0?(this.selectedAccount={id:s[0].id,ac_id:s[0].ac_id,sub_name:s[0].sub_name,sub_type:s[0].sub_type,sub_code:s[0].sub_code,store_id:s[0].store_id,sub_balance:s[0].sub_balance,cat_id:s[0].cat_id,cat_name:s[0].cat_name,phone:s[0].phone,address:s[0].address},this.payInvo.cust_id=this.selectedAccount.id):(this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628 ","danger"),this.selectedItem.item_name="")}selectFromPop(e){this.selectedItem={id:e.id,dateCreated:e.dateCreated,pay_ref:this.payInvo.pay_ref,item_desc:e.item_desc,item_name:e.item_name,item_unit:e.item_unit,parcode:e.parcode,pay_price:e.pay_price,perch_price:e.perch_price,qty:"",tot:e.perch_price,aliasEn:e.aliasEn},this.searchTerm=e.item_name,this.didDissmis()}pickDetail(e,i){let n;i?(n=e,this.searchLang=0):n=e.target.value;let s=[];s=this.items.filter(1==this.searchLang?a=>a.item_desc==n:a=>a.item_name==n),s.length>0?(this.selectedItem={id:s[0].id,dateCreated:s[0].dateCreated,pay_ref:this.payInvo.pay_ref,item_desc:s[0].item_desc,item_name:s[0].item_name,item_unit:s[0].item_unit,parcode:s[0].parcode,pay_price:s[0].pay_price,perch_price:s[0].perch_price,qty:"",tot:s[0].pay_price,aliasEn:s[0].aliasEn},this.setFocusOnInput("qtyIdEp")):(this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u0645 \u0627\u0644\u0635\u0646\u0641 ","danger"),this.selectedItem.item_name="")}presentModal2(e,i){return(0,h.mG)(this,void 0,void 0,function*(){const n=yield this.modalController.create({component:y.X,componentProps:{item:this.selectedItem,status:i}});return n.onDidDismiss().then(s=>{null!==s&&this.doAfterDissmiss(s)}),yield n.present()})}qtyhange(e){this.selectedItem.tot=(this.selectedItem.qty*+this.selectedItem.perch_price).toFixed(2)}pricehange(e){this.selectedItem.tot=(this.selectedItem.qty*+this.selectedItem.perch_price).toFixed(2)}payChange(e){this.payInvo.changee=+(this.payInvo.tot_pr-+this.payInvo.discount)-e.target.value}discountChange(e){this.discountPerc=(+this.payInvo.discount/+this.payInvo.tot_pr*100).toFixed(2),this.payInvo.changee=+(this.payInvo.tot_pr-e.target.value)-this.payInvo.pay}discountPerChange(e){this.payInvo.discount=(+this.payInvo.tot_pr*+this.discountPerc/100).toFixed(2),this.payInvo.changee=+(this.payInvo.tot_pr-this.payInvo.discount)-this.payInvo.pay}back(){this._location.back()}deleteItem(e){this.itemList.splice(e,1),this.payInvo.pay=0,this.payInvo.discount=0,this.getTotal()}getTotal(){let e=this.itemList.reduce((i,n)=>i+ +n.tot,0);this.payInvo.tot_pr=e-+this.payInvo.discount,this.payInvo.changee=+(e-+this.payInvo.discount)-this.payInvo.pay,this.payInvo.tot_pr=this.payInvo.tot_pr.toFixed(2),this.payInvo.changee=this.payInvo.changee.toFixed(2)}refresh(e){"account"==e?this.getSalesAccount():(this.getItems(),this.getStockItems())}addTolist(){if(""==this.selectedItem.item_name||""==this.selectedItem.id||0==+this.selectedItem.qty)this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062f\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u0635\u0646\u0641 \u0648\u062a\u062d\u062f\u064a\u062f \u0627\u0644\u0643\u0645\u064a\u0629","danger");else{let e=[];if(this.itemList.length>0&&(e=this.itemList.filter(i=>i.item_name==this.selectedItem.item_name&&i.perch_price==this.selectedItem.perch_price)),0==e.length){let i=new Date,n=this.datePipe.transform(i,"dd-MM-YYYY");this.itemList.push({id:"NULL",pay_ref:this.selectedItem.pay_ref,item_name:this.selectedItem.item_name,pay_price:this.selectedItem.pay_price,quantity:+this.selectedItem.qty,tot:this.selectedItem.tot,store_id:+this.store_info.id,item_id:+this.selectedItem.id,dateCreated:n,perch_price:this.selectedItem.perch_price})}else{this.selectedItem.qty=+e[0].quantity+ +this.selectedItem.qty;let i=this.itemList.map(n=>n.item_name).indexOf(this.selectedItem.item_name);this.itemList[i].quantity=+this.selectedItem.qty,this.itemList[i].tot=(+this.selectedItem.qty*+this.selectedItem.perch_price).toFixed(2),this.itemList[i].tot.toFixed(2)}this.selectedItem={id:void 0,dateCreated:"",pay_ref:this.payInvo.pay_ref,item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,aliasEn:""},this.getTotal(),this.setFocusOnInput("dstPop4")}}presentPopover(e){this.popover4.event=e,this.isOpen=!0,this.clear(),this.searchResult=this.items,setTimeout(()=>{this.setFocusOnInput("popInput4")},2e3)}didDissmis(){this.isOpen=!1,this.setFocusOnInput("qtyIdEP")}searchItem(e){this.searchResult=[],this.aliasTerm=e.target.value;const i=new Z.g,n=new T.V,s=new x.C;let a;a=0==this.searchLang?i.transform(this.items,e.target.value):s.transform(this.items,e.target.value);const m=n.transform(this.items,this.aliasTerm);a.length>0&&a.forEach(p=>{this.searchResult.push(p)}),m.length>0&&m.forEach(p=>{this.searchResult.push(p)})}clear(e){e?this.selectedItem={id:void 0,dateCreated:"",pay_ref:this.payInvo.pay_ref,item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,aliasEn:""}:this.searchTerm=""}validate(){let e=[];return this.sub_account&&(e=this.sub_account.filter(i=>i.sub_name==this.sub_nameNew)),0==this.itemList.length||""==this.payInvo.pay_ref?(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062f\u062e\u0627\u0644 \u0627\u0635\u0646\u0627\u0641 \u0627\u0644\u064a \u0627\u0644\u0642\u0627\u0626\u0645\u0629","danger"),!1):1==this.radioVal&&""==this.sub_nameNew?(this.presentToast("s\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062e\u062a\u064a\u0627\u0631 \u062d\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u064a\u0644","danger"),!1):0==this.radioVal&&""==this.selectedAccount.sub_name?(this.presentToast("w\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062e\u062a\u064a\u0627\u0631 \u062d\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u064a\u0644","danger"),!1):0==+this.payInvo.cust_id&&0==this.radioVal?(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062e\u062a\u064a\u0627\u0631 \u062d\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u064a\u0644","danger"),!1):""==this.payInvo.pay_date||null==this.payInvo.pay_date?(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u062a\u062d\u062f\u064a\u062f \u0627\u0644\u062a\u0627\u0631\u064a\u062e ","danger"),!1):this.payInvo.changee<0?(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0645\u0631\u0627\u062c\u0639\u0629 \u0627\u0644\u0645\u0628\u0644\u063a \u0627\u0644\u0645\u0633\u062a\u0644\u0645 \u0648\u0627\u0644\u062e\u0635\u0645  ","danger"),!1):!(1==this.radioVal&&e.length>0&&(this.presentToast("\u0627\u0644\u0639\u0645\u064a\u0644 \u0645\u0648\u062c\u0648\u062f \u0645\u0633\u0628\u0642\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631\u0629 \u0645\u0646 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0639\u0645\u0644\u0627\u0621","danger"),1))}doAfterDissmiss(e){"save"==e.role&&this.saveItem(e.data)}saveItem(e){this.presentLoadingWithOptions("\u062c\u0627\u0631\u064a \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a ..."),this.api.saveitemMulti(e[0]).subscribe(i=>{"Post Not Created"!=i.message?(this.firstq={id:null,item_id:i.message,store_id:this.store_info.id,quantity:e[1].quantity,pay_price:e[0].pay_price,perch_price:e[0].perch_price,fq_year:"2022"},this.saveFierstQty(e[0].item_name)):this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},i=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")})}saveFierstQty(e){return(0,h.mG)(this,void 0,void 0,function*(){this.api.saveFirstQty(this.firstq).subscribe(i=>{this.getStockItems(e),this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0641\u0638 \u0628\u0646\u062c\u0627\u062d","success")},i=>{this.presentToast("1\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger"),this.loadingController.dismiss()},()=>{this.loadingController.dismiss()})})}preparenewaccount(){this.selectedAccount.sub_name.length>0&&null==this.selectedAccount.id||(this.selectedAccount.sub_name=this.sub_nameNew,this.payInvo.sub_name=this.selectedAccount.sub_name),this.selectedAccount.id=null,this.selectedAccount.ac_id=2,this.selectedAccount.sub_type="credit",this.selectedAccount.sub_code=null,this.selectedAccount.sub_balance="0",this.selectedAccount.cat_id=2,this.selectedAccount.cat_name="\u0627\u0644\u0645\u0648\u0631\u062f\u064a\u0646",this.selectedAccount.store_id=this.store_info.id}update(){let e=this.payInvo.pay_date;this.payInvo.sub_name=this.selectedAccount.sub_name,this.payInvo.pay_date=this.datePipe.transform(e,"yyyy-MM-dd"),null!=this.payInvo.nextPay&&(this.payInvo.nextPay=this.datePipe.transform(e,"yyyy-MM-dd")),1==this.validate()&&(this.presentLoadingWithOptions("\u062c\u0627\u0631\u064a \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a ..."),0==this.radioVal&&null!=this.selectedAccount.id?1==this.offline&&this.payInvo.pay_id||1==this.offline&&!this.payInvo.pay_id||0==this.offline&&!this.payInvo.pay_id?this.presentToast("\u0644\u0627 \u064a\u0648\u062c\u062f \u0627\u062a\u0635\u0627\u0644 \u0628\u0627\u0644\u0625\u0646\u062a\u0631\u0646\u062a","danger"):this.updateInvo():1==this.offline?this.presentToast("\u0644\u0627 \u064a\u0648\u062c\u062f \u0627\u062a\u0635\u0627\u0644 \u0628\u0627\u0644\u0625\u0646\u062a\u0631\u0646\u062a","danger"):this.saveSubAccount())}updateInvo(){this.api.updatePerchOrderInvo(this.payInvo).subscribe(e=>{this.deleteSalesitemList4update()},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{this.loadingController.dismiss()})})}saveSubAccount(){this.preparenewaccount(),this.api.saveSubAccount(this.selectedAccount).subscribe(e=>{"Post Not Created"!=e.message?(this.payInvo.cust_id=e.message,0==this.radioVal&&null==this.selectedAccount.id&&0==this.offline&&(this.sub_accountLocalPurch=this.sub_accountLocalPurch.filter(i=>i.sub_name!=this.selectedAccount.sub_name),this.storage.set("sub_accountLocalPurch",this.sub_accountLocalPurch).then(i=>{})),this.updateInvo()):this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u0627\u0646\u0634\u0627\u0621 \u062d\u0633\u0627\u0628 \u0644\u0644\u0639\u0645\u064a\u0644 , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u0627\u0646\u0634\u0627\u0621 \u062d\u0633\u0627\u0628 \u0644\u0644\u0639\u0645\u064a\u0644 , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{this.loadingController.dismiss()})})}deleteSalesitemList4update(){this.api.deletePerchOrderitemList(this.payInvo.pay_ref).subscribe(e=>{"Post Not Deleted"!=e.message?this.saveitemList():this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{this.loadingController.dismiss()})},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{this.loadingController.dismiss()})})}saveSubAccountlocal(){this.preparenewaccount(),this.sub_account||(this.sub_account=[]),this.sub_account.push(this.selectedAccount),this.sub_accountLocalPurch.push(this.selectedAccount),this.storage.set("sub_accountLocalPurch",this.sub_accountLocalPurch).then(e=>{this.saveInvoLocal()})}saveInvoLocal(){let e=[];if(e=this.purchLocal.filter(i=>i.payInvo.pay_ref==this.payInvo.pay_ref),e.length>0)this.purchLocal=this.purchLocal.filter(i=>i.payInvo.pay_ref!=this.payInvo.pay_ref),this.purchLocal.push({payInvo:this.payInvo,itemList:this.itemList});else{let i=this.purchLocalUpdate.filter(n=>n.payInvo.pay_ref!=this.payInvo.pay_ref);this.purchLocalUpdate=i,this.purchLocalUpdate.push({payInvo:this.payInvo,itemList:this.itemList})}null!=this.payInvo.pay_id&&(this.purchase=this.purchase.filter(i=>i.payInvo.pay_ref!=this.payInvo.pay_ref),this.purchase.push({payInvo:this.payInvo,itemList:this.itemList}),this.storage.set("purchase",this.purchase).then(i=>{})),this.storage.set("purchLocalUpdate",this.purchLocalUpdate).then(i=>{}),this.storage.set("purchLocal",this.purchLocal).then(i=>{this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0641\u0638 \u0628\u0646\u062c\u0627\u062d","success"),this.back()})}saveitemList(){this.api.savePerchOrderitemList(this.itemList).subscribe(e=>{this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0641\u0638 \u0628\u0646\u062c\u0627\u062d","success"),this.presentAlertConfirm("order")},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loadingController.dismiss()})}presentAlertConfirm(e){return(0,h.mG)(this,void 0,void 0,function*(){let i="\u0647\u0644 \u062a\u0631\u064a\u062f \u062d\u0630\u0641 \u0627\u0644\u0633\u062c\u0644 \u061f ";"order"==e&&(i="\u0647\u0644 \u062a\u0631\u064a\u062f \u062a\u062d\u0648\u064a\u0644 \u0627\u0645\u0631 \u0627\u0644\u0634\u0631\u0627\u0621 \u0627\u0644\u064a \u0641\u0627\u062a\u0648\u0631\u0629 \u0645\u0634\u062a\u0631\u064a\u0627\u062a \u0646\u0647\u0627\u0626\u064a\u0629\u061f"),yield(yield this.alertController.create({cssClass:"my-custom-class",header:"\u062a\u0623\u0643\u064a\u062f!",mode:"ios",message:i,buttons:[{text:"\u0625\u0644\u063a\u0627\u0621",role:"cancel",cssClass:"secondary",id:"cancel-button",handler:s=>{}},{text:"\u0645\u0648\u0627\u0641\u0642",id:"confirm-button",handler:()=>{0==this.offline&&null!=this.payInvo.pay_id?"order"==e?this.goTpurchase():this.deleteSalesInvo():1==this.offline&&this.presentToast("\u0644\u0627 \u064a\u0648\u062c\u062f \u0627\u062a\u0635\u0627\u0644 \u0628\u0627\u0644\u0625\u0646\u062a\u0631\u0646\u062a","danger")}}]})).present()})}goTpurchase(){let e={queryParams:{payInvo:JSON.stringify(this.payInvo),sub_name:JSON.stringify(this.payInvo.sub_name),user_info:JSON.stringify(this.user_info),store_info:JSON.stringify(this.store_info),itemList:JSON.stringify(this.itemList)}};this.rout.navigate(["folder/purchase"],e)}delete(){this.presentAlertConfirm()}deleteSalesInvo(){this.presentLoadingWithOptions("\u062c\u0627\u0631\u064a \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a ..."),this.api.deletePerchOrderInvo(this.payInvo.pay_id).subscribe(e=>{"Post Not Deleted"!=e.message?this.deleteSalesitemList():this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")})}deleteSalesInvoLocal(){this.storage.get("purchLocalDelete").then(e=>{e&&(this.purchLocalDelete=e)}),null==this.payInvo.pay_id?(this.purchLocal=this.purchLocal.filter(e=>e.payInvo.pay_ref!=this.payInvo.pay_ref),this.storage.set("purchLocal",this.purchLocal).then(e=>{this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d","success"),this.back()})):(this.purchase=this.purchase.filter(e=>e.payInvo.pay_ref!=this.payInvo.pay_ref),this.storage.set("purchase",this.purchase).then(e=>{this.purchLocalDelete.push({payInvo:this.payInvo,itemList:this.itemList}),this.storage.set("purchLocalDelete",this.purchLocalDelete).then(i=>{this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d","success"),this.back()})}))}deleteSalesitemList(){this.api.deletePerchOrderitemList(this.payInvo.pay_ref).subscribe(e=>{"Post Not Deleted"!=e.message?(this.purchase=this.purchase.filter(i=>i.payInvo.pay_ref!=this.payInvo.pay_ref),this.storage.set("purchase",this.purchase).then(i=>{this.presentToast("\u062a\u0645 \u0627\u0644\u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d","success"),this.back()})):this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},e=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loadingController.dismiss()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(d.Ye),t.Y36(c.Br),t.Y36(g.gz),t.Y36(g.F0),t.Y36(A.K),t.Y36(c.IN),t.Y36(c.HT),t.Y36(d.uU),t.Y36(P.r),t.Y36(c.yF))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-edit-prch-order"]],viewQuery:function(e,i){if(1&e&&(t.Gf(I,5),t.Gf(b,5),t.Gf(v,5),t.Gf(q,5),t.Gf(C,5)),2&e){let n;t.iGM(n=t.CRH())&&(i.dstEp=n.first),t.iGM(n=t.CRH())&&(i.qtyIdEp=n.first),t.iGM(n=t.CRH())&&(i.dstPop4=n.first),t.iGM(n=t.CRH())&&(i.popInput4=n.first),t.iGM(n=t.CRH())&&(i.popover4=n.first)}},decls:10,vars:2,consts:[["slot","end"],["fill","clear",3,"click"],["name","arrow-back-sharp"],[4,"ngIf"],["class","ion-margin-top",4,"ngIf"],["dir","rtl"],["size","12"],[1,"ion-no-padding","ion-no-margin"],["size","4","offset","4"],[3,"ngModel","ngModelChange"],["lines","none"],[1,"ion-margin-end",3,"value"],["size","4",1,"ion-text-end"],["type","date","id","startingDate","name","startingDate",2,"width","100%",3,"ngModel","ngModelChange"],["size","4","offset","4",4,"ngIf"],["size","3","offset","1",4,"ngIf"],["size","2","offset","1",4,"ngIf"],["size","3","offset","2",4,"ngIf"],[1,"custInput"],["placeholder","\u0623\u0643\u062a\u0628 \u062a\u0639\u0644\u064a\u0642\u0627",3,"ngModel","ngModelChange"],["placeholder","\u0627\u062e\u062a\u0631  \u062d\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u064a\u0644","list","accountsPe","id","accountPe",1,"bnone",3,"ngModel","ngModelChange","change"],["style","border: none;","id","accountsPe","style","height: auto;max-height: 20px;",4,"ngIf"],["fill","clear","size","small","slot","end",3,"click",4,"ngIf"],["id","accountsPe",2,"height","auto","max-height","20px"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["color","danger"],["fill","clear","size","small","slot","end",3,"click"],["name","refresh","color","success"],["size","3","offset","1"],["size","2","offset","1"],["placeholder","\u0627\u0644\u062c\u0648\u0627\u0644",3,"ngModel","ngModelChange"],["size","3","offset","2"],["placeholder","\u0627\u0644\u0639\u0646\u0648\u0627\u0646",3,"ngModel","ngModelChange"],[1,"ion-margin-top"],["size","8",1,"ion-no-padding"],["size","4",1,"ion-no-margin","ion-no-padding"],[1,"ion-no-margin","ion-no-padding"],["size","6",1,"custPadding","ion-no-margin","ion-no-padding"],["size","6","class","ion-no-margin ion-no-padding ion-text-end",4,"ngIf"],[3,"ngModel","click","ngModelChange"],["dstPop4",""],[3,"isOpen","didDismiss"],["popover4",""],["size","2"],[1,"ion-padding"],[3,"ngModel","keyup.enter","ngModelChange","ionChange"],["qtyIdEp",""],[3,"ngModel","readonly","ngModelChange"],["size","2",1,"ion-padding"],["expand","block","routerDirection","root","color","success",3,"click"],[1,"ion-text-center"],[1,"table"],[3,"dblclick",4,"ngFor","ngForOf"],["size","4",1,"ion-no-padding"],[1,"ion-justify-content-center"],["size","9"],["size","5"],["expand","block","routerDirection","root","color","danger",3,"click"],["size","6",1,"ion-no-margin","ion-no-padding","ion-text-end"],["size","small","fill","clear",3,"click"],["name","add-circle-outline","color","success","slot","end"],[3,"ngModel","ngModelChange","ionChange"],["popInput4",""],["fill","clear","slot","end",3,"click"],["name","close","color","danger"],["dir","rtl",1,"ion-padding"],["class","ion-text-center",4,"ngIf"],["name","lines-sharp"],["button","","class","dark",3,"ngClass","click",4,"ngFor","ngForOf"],["button","",1,"dark",3,"ngClass","click"],[3,"dblclick"],["fill","clear","size","small",3,"click"],["name","trash","color","danger"],[3,"ngModel","keyup.enter","ngModelChange","ionBlur"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t.TgZ(3,"ion-button",1),t.NdJ("click",function(){return i.back()}),t._UZ(4,"ion-icon",2),t.qZA(),t.qZA(),t.TgZ(5,"ion-title"),t._uU(6," \u062a\u0639\u062f\u064a\u0644 \u0627\u0645\u0631 \u0634\u0631\u0627\u0621"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"ion-content"),t.YNc(8,Q,32,10,"ion-grid",3),t.YNc(9,K,87,12,"ion-grid",4),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngIf",i.payInvo),t.xp6(1),t.Q6J("ngIf",i.payInvo))},directives:[c.Gu,c.sr,c.Sm,c.YG,c.gu,c.wd,c.W2,d.O5,c.jY,c.Nd,c.wI,c.PM,c.se,c.QI,u.JJ,u.On,c.Ie,c.B7,c.U5,c.Q$,u.Fj,c.pK,c.j9,d.sg,u.YN,u.Kr,c.yW,c.d8,c.q_,c.PQ,d.mk],styles:[".custInput[_ngcontent-%COMP%]{border-style:solid;border-color:var(--ion-color-light);border-radius:5px}.cust-card[_ngcontent-%COMP%]{border-radius:5px}.custRow[_ngcontent-%COMP%]{margin-top:5rem}.custInp[_ngcontent-%COMP%]{border-right-style:solid;border-right-width:.5px;text-align:center}.red[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.dark[_ngcontent-%COMP%]{color:var(--ion-color-dark)}ion-popover[_ngcontent-%COMP%]{--offset-y: -30px }.table[_ngcontent-%COMP%]{text-align:center;width:100%;margin:12px}.bnone[_ngcontent-%COMP%]{border:none}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#ddd}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #dddddd;text-align:center;padding:8px;font-size:16px;font-weight:700;color:#000}"]}),o})()}];let tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.Bz.forChild(X)],g.Bz]}),o})(),et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.ez,u.u5,c.Pc,tt]]}),o})()}}]);