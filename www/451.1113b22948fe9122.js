"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[451],{10451:(Z,L,h)=>{h.r(L),h.d(L,{SettingsPageModule:()=>A});var g=h(69808),d=h(34182),r=h(23349),p=h(94030),f=h(70655),s=h(29863),b=h(90849),_=h(91472);function y(l,c){if(1&l&&s._UZ(0,"ion-progress-bar",13),2&l){const e=s.oxw();s.Q6J("value",e.progressVal)}}function S(l,c){if(1&l&&(s.TgZ(0,"ion-col",14),s.TgZ(1,"ion-item",15),s._UZ(2,"ion-radio",16),s.TgZ(3,"ion-label"),s._uU(4),s.TgZ(5,"ion-text"),s._uU(6),s.qZA(),s.TgZ(7,"ion-text",17),s.TgZ(8,"strong"),s._uU(9,"-"),s.qZA(),s.qZA(),s.TgZ(10,"ion-text"),s._uU(11),s.qZA(),s._uU(12,") "),s.qZA(),s.qZA(),s.qZA()),2&l){const e=c.$implicit;s.xp6(2),s.Q6J("value",e.id),s.xp6(2),s.hij(" ",e.yearDesc," ("),s.xp6(2),s.hij(" ",e.yearStart,""),s.xp6(5),s.hij(" ",e.yearEnd,"")}}const P=[{path:"",component:(()=>{class l{constructor(e,t,i,a,o,n){this.route=e,this.alertController=t,this.storage=i,this.loadingController=a,this.api=o,this.toast=n,this.purchase=[],this.sales=[],this.tswia=[],this.tswiaDetails=[],this.salesDetails=[],this.purchDetails=[],this.itemsLocal=[],this.firstq=[],this.sub_account=[],this.purchLocal=[],this.salesLocal=[],this.sub_accountLocalSales=[],this.sub_accountLocalPurch=[],this.sub_accountSales=[],this.sub_accountPurch=[],this.purchLocalUpdate=[],this.purchLocalDelete=[],this.salesLocalDelete=[],this.salesLocalUpdate=[],this.yearArr=[],this.newAccounts=[],this.color="dark",this.radioVal=null,this.selectedYear=null,this.progressVal=.2}ngOnInit(){this.getAppInfo(),setTimeout(()=>{this.afterLoad="loaded"},3e3)}radioChangeS(e){this.storage.set("searchLang",this.radioVal).then(t=>{})}getOfflineMode(){this.storage.get("offline").then(e=>{this.offline=e,this.color=1==this.offline?"dark":"primary"})}getAppInfo(){this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("year").then(e=>{e&&(this.year=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e)}),this.storage.get("offline").then(e=>{this.offline=e,this.color=1==this.offline?"dark":"primary"}),this.storage.get("searchLang").then(e=>{e&&(this.radioVal=e)}),this.getyear()}getyear(){this.api.getYear().subscribe(e=>{this.yearArr=e.data,this.setCurrentYear()},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}setCurrentYear(){this.storage.get("year").then(e=>{e?(this.year=e,this.selectedYear=this.year.id):(this.year=this.yearArr[0],this.storage.set("year",this.year).then(t=>{}))})}presentAlertConfirm(){return(0,f.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:"my-custom-class",header:"\u062a\u0623\u0643\u064a\u062f!",mode:"ios",message:"\u0633\u064a\u062a\u0645 \u0627\u0639\u0627\u062f\u0629 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0646\u0638\u0627\u0645 \u0645\u0646 \u062c\u062f\u064a\u062f , \u0627\u0636\u063a\u0637 \u0639\u0644\u064a \u0645\u0648\u0627\u0641\u0642 \u0644\u0644\u0625\u0633\u062a\u0645\u0631\u0627\u0631",buttons:[{text:"\u0625\u0644\u063a\u0627\u0621",role:"cancel",cssClass:"secondary",id:"cancel-button",handler:i=>{}},{text:"\u0645\u0648\u0627\u0641\u0642",id:"confirm-button",handler:()=>{window.location.reload()}}]})).present()})}yearChange(e,t){this.year=this.yearArr[this.yearArr.findIndex(i=>i.id==e.target.value)],this.storage.set("year",this.year).then(i=>{"loaded"==t&&this.presentAlertConfirm()})}sync(){this.progressVal=.2,this.firstTimeSync()}firstTimeSync(){this.getTswia()}getStockItems(){this.api.getAllStockItemsWithouteCounts(this.store_info.id,this.year.id).subscribe(e=>{console.log("new items call ",e),this.itemsLocal=e.data,this.storage.set("itemsLocal",this.itemsLocal).then(i=>{this.getSalesAccount(),this.progressVal=+this.progressVal+.2})},e=>{},()=>{})}getTswia(){this.api.getToptswia(this.store_info.id,this.year.id).subscribe(e=>{"No record Found"!=e.message&&(this.tswia=e.data),this.getAllTswiaDetail()},e=>{},()=>{})}getAllTswiaDetail(){this.api.getAllTswiaDetail(this.store_info.id,this.year.id).subscribe(e=>{"No record Found"!=e.message&&(this.tswiaDetails=e.data),this.tswia.length>0&&(this.addSTswiaDetails(),this.storage.set("tswia",this.tswia).then(i=>{})),this.getfirstQty()},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")},()=>{})}addSTswiaDetails(){let e=[];for(let t=0;t<this.tswia.length;t++){const i=this.tswia[t];let a=this.tswiaDetails.filter(o=>o.pay_ref==i.pay_ref);e.push({payInvo:i,itemList:a})}this.tswia=e}getfirstQty(){this.api.getFirstQty(this.store_info.id).subscribe(e=>{this.firstq=e.data,this.storage.set("firstq",this.firstq).then(i=>{this.getStockItems(),this.progressVal=+this.progressVal+.2})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getItems(){this.api.getItems().subscribe(e=>{this.itemsLocal=e.data,this.storage.set("itemsLocal",this.itemsLocal).then(i=>{this.getSalesAccount(),this.progressVal=+this.progressVal+.2})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getSalesAccount(){this.api.getSalesAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_accountSales=e.data,this.storage.set("sub_accountSales",this.sub_accountSales).then(i=>{this.getPurchAccount(),this.progressVal=+this.progressVal+.2})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getPurchAccount(){this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_accountPurch=e.data,this.storage.set("sub_accountPurch",this.sub_accountPurch).then(i=>{this.getTopPerch(),this.progressVal=+this.progressVal+.2})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getTopPerch(){this.api.getTopPerch(this.store_info.id,this.year.id).subscribe(e=>{let t=e;this.purchase=t.data,"No record Found"==t.message?this.getTopSales():this.storage.set("purchase",this.purchase).then(i=>{this.getTopSales(),this.progressVal=+this.progressVal+.2})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")},()=>{})}getTopSales(){this.api.getTopSales(this.store_info.id,this.year.id).subscribe(e=>{let t=e;this.sales=t.data,"No record Found"==t.message?this.getAllPurchDetail():this.storage.set("sales",this.sales).then(i=>{this.getAllSalesDetail()})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")},()=>{})}getAllSalesDetail(){this.api.getAllSalesDetail(this.store_info.id,this.year.id).subscribe(e=>{this.salesDetails=e.data,this.sales.length>0&&(this.addSalesDetails(),this.storage.set("sales",this.sales).then(i=>{})),this.getAllPurchDetail()},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")},()=>{})}addSalesDetails(){let e=[];for(let t=0;t<this.sales.length;t++){const i=this.sales[t];let a=this.salesDetails.filter(o=>o.pay_ref==i.pay_ref);e.push({payInvo:i,itemList:a})}this.sales=e}getAllPurchDetail(){this.api.getAllPerchDetail(this.store_info.id,this.year.id).subscribe(e=>{let t=e;"No record Found"==t.message?this.prepareNewAccounts():(this.purchDetails=t.data,this.addPurchDetails(),this.storage.set("purchase",this.purchase).then(i=>{this.prepareNewAccounts()}))},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")},()=>{})}addPurchDetails(){let e=[];for(let t=0;t<this.purchase.length;t++){const i=this.purchase[t];let a=this.purchDetails.filter(o=>o.pay_ref==i.pay_ref);e.push({payInvo:i,itemList:a})}this.purchase=e}presentLoadingWithOptions(e){return(0,f.mG)(this,void 0,void 0,function*(){const t=yield this.loadingController.create({spinner:"bubbles",mode:"ios",duration:5e3,message:e,translucent:!0,backdropDismiss:!1});yield t.present(),yield t.onDidDismiss()})}presentToast(e,t){return(0,f.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:e,duration:2e3,color:t,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}clickTo(){0==this.offline?(this.offline=!0,this.color="dark"):(this.offline=!1,this.color="primary")}radioChange(e){1==e.detail.checked?(this.offline=!0,this.color="dark"):(this.offline=!1,this.color="primary"),this.storage.set("offline",this.offline).then(t=>{})}prepareNewAccounts(){this.newAccounts=[],this.sub_accountLocalSales=[],this.sub_accountLocalPurch=[],this.storage.get("sub_accountLocalSales").then(e=>{if(e&&(this.sub_accountLocalSales=e,this.sub_accountLocalSales.length>0))for(let t=0;t<this.sub_accountLocalSales.length;t++)this.newAccounts.push(this.sub_accountLocalSales[t]);this.storage.get("sub_accountLocalPurch").then(t=>{if(t&&(this.sub_accountLocalPurch=t,this.sub_accountLocalPurch.length>0))for(let i=0;i<this.sub_accountLocalPurch.length;i++)this.newAccounts.push(this.sub_accountLocalPurch[i]);this.newAccounts.length>0?this.saveSubAccountMulti(this.newAccounts):this.addAccountstosalesLocal()})})}saveSubAccountMulti(e){this.api.createMultiAccount(e).subscribe(t=>{"Post Not Created"!=t.message?(this.sub_accountLocalSales=[],this.sub_accountLocalPurch=[],this.storage.set("sub_accountLocalSales",this.sub_accountLocalSales).then(i=>{this.storage.set("sub_accountLocalPurch",this.sub_accountLocalPurch).then(a=>{})}),this.getSalesAccounts2()):this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u0627\u0646\u0634\u0627\u0621 \u062d\u0633\u0627\u0628 \u0644\u0644\u0639\u0645\u064a\u0644 , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},t=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getSalesAccounts2(){this.api.getSalesAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_accountSales=e.data,this.storage.set("sub_accountSales",this.sub_accountSales).then(i=>{this.getPurchAccount2()})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}getPurchAccount2(){this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_accountPurch=e.data,this.storage.set("sub_accountPurch",this.sub_accountPurch).then(i=>{this.addAccountstosalesLocal()})},e=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}addAccountstosalesLocal(){this.storage.get("sub_accountSales").then(e=>{this.sub_accountSales=e,this.storage.get("salesLocal").then(t=>{if(t&&(this.salesLocal=t,this.salesLocal.length>0))for(let i=0;i<this.salesLocal.length;i++){const a=this.salesLocal[i];if(null==a.payInvo.cust_id){let o=this.sub_accountSales.filter(n=>n.sub_name==a.payInvo.sub_name);o&&(a.payInvo.cust_id=o[0].id)}}if(this.salesLocal.length>0){let i=[],a=[];for(let o=0;o<this.salesLocal.length;o++){const n=this.salesLocal[o];i.push(n.payInvo);for(let u=0;u<n.itemList.length;u++)a.push(n.itemList[u])}this.createMultiSales(i,a)}else this.addSubaccoutPurch()})})}createMultiSales(e,t){this.api.createMultiSales(e).subscribe(i=>{"Post Not Created"!=i.message?this.createPayDetais(t):this.presentToast("\u0644\u0645 \u064a\u062a\u0645  \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a, \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},i=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}createPayDetais(e){this.api.saveSalesitemList(e).subscribe(t=>{"Post Not Created"!=t.message&&(this.salesLocal=[],this.storage.set("salesLocal",this.salesLocal).then(i=>{this.addSubaccoutPurch()}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{})}addSubaccoutPurch(){this.storage.get("sub_accountPurch").then(e=>{this.sub_accountPurch=e,this.storage.get("purchLocal").then(t=>{if(t&&(this.purchLocal=t,this.purchLocal.length>0))for(let i=0;i<this.purchLocal.length;i++){const a=this.purchLocal[i];if(null==a.payInvo.cust_id){let o=this.sub_accountPurch.filter(n=>n.sub_name==a.payInvo.sub_name);o&&(a.payInvo.cust_id=o[0].id)}}if(this.presentToast("\u062a\u0645\u062a \u0627\u0644\u0645\u0632\u0627\u0645\u0646\u0629 ","success"),this.purchLocal.length>0){let i=[],a=[];for(let o=0;o<this.purchLocal.length;o++){const n=this.purchLocal[o];i.push(n.payInvo);for(let u=0;u<n.itemList.length;u++)a.push(n.itemList[u])}this.createMultiPurch(i,a)}else this.deleteSalesLocal()})})}createMultiPurch(e,t){this.api.createMultiPurch(e).subscribe(i=>{"Post Not Created"!=i.message?this.createPerchDetais(t):this.presentToast("\u0644\u0645 \u064a\u062a\u0645  \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a, \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},i=>{this.presentToast("\u062d\u062f\u062b \u062e\u0637\u0623 \u0645\u0627 , \u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629 ","danger")})}createPerchDetais(e){this.api.savePerchitemList(e).subscribe(t=>{"Post Not Created"!=t.message&&(this.purchLocal=[],this.storage.set("purchLocal",this.purchLocal).then(i=>{this.deleteSalesLocal()}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{})}deleteSalesLocal(){this.storage.get("salesLocalDelete").then(e=>{if(e){this.salesLocalDelete=e;for(let t=0;t<this.salesLocalDelete.length;t++)this.api.deleteSalesInvo(this.salesLocalDelete[t].payInvo.pay_id).subscribe(a=>{},a=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")});this.deleteSalesitemList(this.salesLocalDelete[0].payInvo.pay_ref)}else this.updateSalesInvo()})}deleteSalesitemList(e){this.api.deleteSalesitemList(e).subscribe(t=>{"Post Not Deleted"!=t.message&&(this.salesLocalDelete=[],this.storage.set("salesLocalDelete",this.salesLocalDelete).then(i=>{}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{})}updateSalesInvo(){this.storage.get("salesLocalUpdate").then(e=>{if(e){this.salesLocalUpdate=e;for(let t=0;t<this.salesLocalUpdate.length;t++)this.api.updateSalesInvo(this.salesLocalUpdate[t].payInvo).subscribe(a=>{},a=>{});this.deleteSalesitemList4update(this.salesLocalUpdate)}else this.deletePurchLocal()})}deleteSalesitemList4update(e){let t=[];for(let i=0;i<e.length;i++){const a=e[i];for(let o=0;o<a.itemList.length;o++)t.push(a.itemList[o]);this.api.deleteSalesitemList(a.payInvo.pay_ref).subscribe(o=>{},o=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{})})}t.length>0?this.saveSalesitemList(t):this.deletePurchLocal()}saveSalesitemList(e){this.api.saveSalesitemList(e).subscribe(t=>{"Post Not Deleted"!=t.message&&(this.salesLocalUpdate=[],this.storage.set("salesLocalUpdate",this.salesLocalUpdate).then(i=>{this.deletePurchLocal()}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loadingController.dismiss()})}deletePurchLocal(){this.storage.get("purchLocalDelete").then(e=>{if(e){this.purchLocalDelete=e;for(let t=0;t<this.purchLocalDelete.length;t++)this.api.deletePerchInvo(this.purchLocalDelete[t].payInvo.pay_id).subscribe(a=>{},a=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")});this.deletePurchitemList(this.salesLocalDelete[0].payInvo.pay_ref)}else this.updatePurchInvo()})}deletePurchitemList(e){this.api.deletePerchitemList(e).subscribe(t=>{"Post Not Deleted"!=t.message&&(this.purchLocalDelete=[],this.storage.set("purchLocalDelete",this.purchLocalDelete).then(i=>{}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{})}updatePurchInvo(){this.storage.get("purchLocalUpdate").then(e=>{if(e){this.purchLocalUpdate=e;for(let t=0;t<this.purchLocalUpdate.length;t++)this.api.updatePerchInvo(this.purchLocalUpdate[t].payInvo).subscribe(a=>{},a=>{});this.deletePurchitemList4update(this.purchLocalUpdate)}})}deletePurchitemList4update(e){let t=[];for(let i=0;i<e.length;i++){const a=e[i];t.push(a.itemList);for(let o=0;o<a.itemList.length;o++)t.push(a.itemList[o]);this.api.deletePerchitemList(a.payInvo.pay_ref).subscribe(o=>{},o=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger").then(()=>{})})}t.length>0?this.savePurchitemList(t):this.presentToast("\u062a\u0645\u062a \u0627\u0644\u0645\u0632\u0627\u0645\u0646\u0629 ","success")}savePurchitemList(e){this.api.savePerchitemList(e).subscribe(t=>{"Post Not Deleted"!=t.message&&(this.salesLocalUpdate=[],this.storage.set("purchLocalUpdate",this.purchLocalUpdate).then(i=>{this.presentToast("\u062a\u0645\u062a \u0627\u0644\u0645\u0632\u0627\u0645\u0646\u0629 ","success")}))},t=>{this.presentToast("\u0644\u0645 \u064a\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a , \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loadingController.dismiss()})}}return l.\u0275fac=function(e){return new(e||l)(s.Y36(p.F0),s.Y36(r.Br),s.Y36(b.K),s.Y36(r.HT),s.Y36(_.r),s.Y36(r.yF))},l.\u0275cmp=s.Xpm({type:l,selectors:[["app-settings"]],decls:34,vars:6,consts:[["slot","start"],[3,"value",4,"ngIf"],[1,"ion-margin-top"],["dir","rtl",1,"ion-justify-content-center"],["size","12"],[1,"ion-margin-top","ion-margin-bottom"],["button","",3,"click"],["name","cloud-upload-outline","color","dark","slot","start"],["slot","end",3,"ngModel","value","ngModelChange","ionChange"],["name","wifi-outline","slot","start",3,"color"],[3,"ngModel","ngModelChange","ionChange"],[1,"ion-no-padding","ion-no-margin"],["size","12","class","ion-no-padding ion-no-margin",4,"ngFor","ngForOf"],[3,"value"],["size","12",1,"ion-no-padding","ion-no-margin"],["lines","none"],[1,"ion-margin-end",3,"value"],["color","primary"]],template:function(e,t){1&e&&(s.TgZ(0,"ion-header"),s.TgZ(1,"ion-toolbar"),s.TgZ(2,"ion-buttons",0),s._UZ(3,"ion-menu-button"),s.qZA(),s.TgZ(4,"ion-title"),s._uU(5,"\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0648\u0627\u0644\u0636\u0628\u0637"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(6,"ion-content"),s.YNc(7,y,1,1,"ion-progress-bar",1),s.TgZ(8,"ion-grid",2),s._UZ(9,"ion-row",3),s.TgZ(10,"ion-row",3),s.TgZ(11,"ion-col",4),s.TgZ(12,"h5"),s._uU(13," \u0627\u0644\u0645\u0632\u0627\u0645\u0646\u0629 \u0648\u0627\u0644\u0625\u062a\u0635\u0627\u0644"),s.qZA(),s.TgZ(14,"ion-card"),s.TgZ(15,"ion-list",5),s.TgZ(16,"ion-item",6),s.NdJ("click",function(){return t.sync()}),s.TgZ(17,"ion-label"),s._uU(18,"\u0645\u0632\u0627\u0645\u0646\u0629 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a "),s.qZA(),s._UZ(19,"ion-icon",7),s.qZA(),s.TgZ(20,"ion-item",6),s.NdJ("click",function(){return t.clickTo()}),s.TgZ(21,"ion-label"),s._uU(22,"\u0648\u0636\u0639 \u0639\u062f\u0645 \u0627\u0644\u0625\u062a\u0635\u0627\u0644 (\u0627\u0644\u0639\u0645\u0644 \u0628\u062f\u0648\u0646 \u0627\u0646\u062a\u0631\u0646\u062a) "),s.qZA(),s.TgZ(23,"ion-toggle",8),s.NdJ("ngModelChange",function(a){return t.offline=a})("ionChange",function(a){return t.radioChange(a)}),s.qZA(),s._UZ(24,"ion-icon",9),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(25,"ion-col",4),s.TgZ(26,"h5"),s._uU(27,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u0645\u0627\u0644\u064a\u0629"),s.qZA(),s.TgZ(28,"ion-card"),s.TgZ(29,"ion-list",5),s.TgZ(30,"ion-radio-group",10),s.NdJ("ngModelChange",function(a){return t.selectedYear=a})("ionChange",function(a){return t.yearChange(a,t.afterLoad)}),s.TgZ(31,"ion-grid",11),s.TgZ(32,"ion-row"),s.YNc(33,S,13,4,"ion-col",12),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&e&&(s.xp6(7),s.Q6J("ngIf",t.progressVal>.2&&t.progressVal<1),s.xp6(16),s.Q6J("ngModel",t.offline)("value",t.offline),s.xp6(1),s.Q6J("color",t.color),s.xp6(6),s.Q6J("ngModel",t.selectedYear),s.xp6(3),s.Q6J("ngForOf",t.yearArr))},directives:[r.Gu,r.sr,r.Sm,r.fG,r.wd,r.W2,g.O5,r.jY,r.Nd,r.wI,r.PM,r.q_,r.Ie,r.Q$,r.gu,r.ho,r.w,d.JJ,d.On,r.se,r.QI,g.sg,r.X7,r.B7,r.U5,r.yW],styles:[""]}),l})()}];let T=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[[p.Bz.forChild(P)],p.Bz]}),l})(),A=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=s.oAB({type:l}),l.\u0275inj=s.cJS({imports:[[g.ez,d.u5,r.Pc,T]]}),l})()}}]);