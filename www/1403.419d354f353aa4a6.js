"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1403],{61403:(P,f,u)=>{u.r(f),u.d(f,{BalanceSheet2PageModule:()=>Q});var h=u(69808),p=u(34182),s=u(23349),b=u(94030),c=u(70655),t=u(29863),_=u(90849),m=u(91472),C=u(52562),n=u(79002),a=u(6612),i=u(12317),g=u(90733),x=u(1212);function Z(o,d){1&o&&(t.TgZ(0,"div",11),t._UZ(1,"ion-spinner",12),t.TgZ(2,"p",13),t._uU(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),t.qZA(),t.qZA())}function v(o,d){if(1&o&&(t.TgZ(0,"ion-card",39),t.TgZ(1,"ion-card-content",40),t.TgZ(2,"div",41),t.TgZ(3,"div",42),t.TgZ(4,"div",43),t._uU(5,"\u0639\u062f\u062f \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.TgZ(6,"div",44),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"div",42),t.TgZ(9,"div",43),t._uU(10,"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u062f\u064a\u0646"),t.qZA(),t.TgZ(11,"div",45),t._uU(12),t.ALo(13,"currencyDisplay"),t.qZA(),t.qZA(),t.TgZ(14,"div",42),t.TgZ(15,"div",43),t._uU(16,"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0627\u0626\u0646"),t.qZA(),t.TgZ(17,"div",46),t._uU(18),t.ALo(19,"currencyDisplay"),t.qZA(),t.qZA(),t.TgZ(20,"div",42),t.TgZ(21,"div",43),t._uU(22,"\u0627\u0644\u0641\u0631\u0642"),t.qZA(),t.TgZ(23,"div",44),t._uU(24),t.ALo(25,"currencyDisplay"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(2);t.xp6(7),t.Oqu(e.summary.total_accounts),t.xp6(5),t.Oqu(t.Dn7(13,8,e.summary.grand_debit_total,"SDG",!1)),t.xp6(6),t.Oqu(t.Dn7(19,12,e.summary.grand_credit_total,"SDG",!1)),t.xp6(5),t.ekj("debit-total",e.summary.difference>0)("credit-total",e.summary.difference<0),t.xp6(1),t.hij(" ",t.Dn7(25,16,e.getAbsoluteValue(e.summary.difference),"SDG",!1)," ")}}function A(o,d){if(1&o&&(t.TgZ(0,"span",63),t._uU(1),t.qZA()),2&o){const e=t.oxw(3);t.xp6(1),t.hij(" (",e.filteredAccounts.length," \u062d\u0633\u0627\u0628) ")}}function T(o,d){if(1&o&&(t.TgZ(0,"span",78),t._uU(1),t.ALo(2,"currencyDisplay"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,e.display_debit,"SDG",!1)," ")}}function w(o,d){1&o&&(t.TgZ(0,"span",79),t._uU(1),t.ALo(2,"currencyDisplay"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.Dn7(2,1,0,"SDG",!1)))}function S(o,d){if(1&o&&(t.TgZ(0,"span",80),t._uU(1),t.ALo(2,"currencyDisplay"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.Dn7(2,1,e.display_credit,"SDG",!1)," ")}}function D(o,d){1&o&&(t.TgZ(0,"span",79),t._uU(1),t.ALo(2,"currencyDisplay"),t.qZA()),2&o&&(t.xp6(1),t.Oqu(t.Dn7(2,1,0,"SDG",!1)))}const M=function(o,d,e,r){return{"customer-type":o,"supplier-type":d,"sales-type":e,"purchase-type":r}},O=function(o,d){return{"debit-status":o,"credit-status":d}};function q(o,d){if(1&o&&(t.TgZ(0,"tr",64),t.TgZ(1,"td",65),t._uU(2),t.qZA(),t.TgZ(3,"td",66),t._uU(4),t.qZA(),t.TgZ(5,"td",67),t._uU(6),t.qZA(),t.TgZ(7,"td",68),t.TgZ(8,"span",69),t._uU(9),t.qZA(),t.qZA(),t.TgZ(10,"td",70),t._uU(11),t.ALo(12,"currencyDisplay"),t.qZA(),t.TgZ(13,"td",71),t.YNc(14,T,3,5,"span",72),t.YNc(15,w,3,5,"span",73),t.qZA(),t.TgZ(16,"td",74),t.YNc(17,S,3,5,"span",75),t.YNc(18,D,3,5,"span",73),t.qZA(),t.TgZ(19,"td",76),t.TgZ(20,"span",77),t._uU(21),t.qZA(),t.qZA(),t.qZA()),2&o){const e=d.$implicit,r=d.index,l=t.oxw(3);t.xp6(2),t.Oqu(r+1),t.xp6(2),t.Oqu(e.sub_name),t.xp6(2),t.Oqu(e.sub_code||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"),t.xp6(2),t.Q6J("ngClass",t.l5B(16,M,1==e.ac_id,2==e.ac_id,8==e.ac_id,9==e.ac_id)),t.xp6(1),t.hij(" ",l.getAccountTypeDisplay(e)," "),t.xp6(2),t.Oqu(t.Dn7(12,12,e.opening_balance,"SDG",!1)),t.xp6(3),t.Q6J("ngIf",e.display_debit>0),t.xp6(1),t.Q6J("ngIf",0==e.display_debit),t.xp6(2),t.Q6J("ngIf",e.display_credit>0),t.xp6(1),t.Q6J("ngIf",0==e.display_credit),t.xp6(2),t.Q6J("ngClass",t.WLB(21,O,"debit"==e.balance_status,"credit"==e.balance_status)),t.xp6(1),t.hij(" ",l.getBalanceStatusDisplay(e)," ")}}function U(o,d){1&o&&(t.TgZ(0,"tr",81),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",82),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",82),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",82),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",82),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",82),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",82),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"ion-skeleton-text",82),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"ion-skeleton-text",82),t.qZA(),t.qZA())}function k(o,d){if(1&o&&(t.TgZ(0,"tfoot"),t.TgZ(1,"tr",83),t.TgZ(2,"td",84),t._uU(3,"\u0627\u0644\u0625\u062c\u0645\u0627\u0644\u064a:"),t.qZA(),t.TgZ(4,"td",85),t.TgZ(5,"span",78),t._uU(6),t.ALo(7,"currencyDisplay"),t.qZA(),t.qZA(),t.TgZ(8,"td",86),t.TgZ(9,"span",80),t._uU(10),t.ALo(11,"currencyDisplay"),t.qZA(),t.qZA(),t.TgZ(12,"td",87),t.TgZ(13,"span",88),t._uU(14),t.ALo(15,"currencyDisplay"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw(3);t.xp6(6),t.Oqu(t.Dn7(7,7,e.summary.grand_debit_total,"SDG",!1)),t.xp6(4),t.Oqu(t.Dn7(11,11,e.summary.grand_credit_total,"SDG",!1)),t.xp6(3),t.ekj("debit-amount",e.summary.difference>0)("credit-amount",e.summary.difference<0),t.xp6(1),t.hij(" ",t.Dn7(15,15,e.getAbsoluteValue(e.summary.difference),"SDG",!1)," ")}}function B(o,d){1&o&&(t.TgZ(0,"div",89),t._UZ(1,"ion-icon",90),t.TgZ(2,"h4"),t._uU(3,"\u0644\u0627 \u062a\u0648\u062c\u062f \u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0623\u064a \u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.qZA())}function F(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card",47),t.TgZ(1,"ion-card-header",48),t.TgZ(2,"div",49),t.TgZ(3,"ion-card-title",50),t._UZ(4,"ion-icon",51),t._uU(5," \u0645\u064a\u0632\u0627\u0646 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629 \u0648\u0627\u0644\u0623\u0631\u0635\u062f\u0629 "),t.YNc(6,A,2,1,"span",52),t.qZA(),t.TgZ(7,"app-export-buttons",53),t.NdJ("exportPDF",function(){return t.CHM(e),t.oxw(2).exportToPDF()})("exportExcel",function(){return t.CHM(e),t.oxw(2).exportToExcel()}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(8,"ion-card-content",54),t.TgZ(9,"div",55),t.TgZ(10,"table",56),t.TgZ(11,"thead"),t.TgZ(12,"tr"),t.TgZ(13,"th"),t._uU(14,"\u0627\u0644\u062a\u0633\u0644\u0633\u0644"),t.qZA(),t.TgZ(15,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("sub_name")}),t._UZ(16,"ion-icon",58),t._uU(17," \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628 "),t.qZA(),t.TgZ(18,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("sub_code")}),t._UZ(19,"ion-icon",58),t._uU(20," \u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628 "),t.qZA(),t.TgZ(21,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("ac_id")}),t._UZ(22,"ion-icon",58),t._uU(23," \u0646\u0648\u0639 \u0627\u0644\u062d\u0633\u0627\u0628 "),t.qZA(),t.TgZ(24,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("opening_balance")}),t._UZ(25,"ion-icon",58),t._uU(26),t.qZA(),t.TgZ(27,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("display_debit")}),t._UZ(28,"ion-icon",58),t._uU(29),t.qZA(),t.TgZ(30,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("display_credit")}),t._UZ(31,"ion-icon",58),t._uU(32),t.qZA(),t.TgZ(33,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortBy("balance_status")}),t._UZ(34,"ion-icon",58),t._uU(35," \u062d\u0627\u0644\u0629 \u0627\u0644\u0631\u0635\u064a\u062f "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(36,"tbody"),t.YNc(37,q,22,24,"tr",59),t.YNc(38,U,17,0,"tr",60),t.qZA(),t.YNc(39,k,16,19,"tfoot",61),t.qZA(),t.qZA(),t.YNc(40,B,6,0,"div",62),t.qZA(),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(6),t.Q6J("ngIf",e.filteredAccounts.length>0),t.xp6(1),t.Q6J("hasData",e.filteredAccounts&&e.filteredAccounts.length>0)("isLoading",e.loading),t.xp6(9),t.Q6J("name",e.getSortIcon("sub_name")),t.xp6(3),t.Q6J("name",e.getSortIcon("sub_code")),t.xp6(3),t.Q6J("name",e.getSortIcon("ac_id")),t.xp6(3),t.Q6J("name",e.getSortIcon("opening_balance")),t.xp6(1),t.hij(" \u0627\u0644\u0631\u0635\u064a\u062f \u0627\u0644\u0627\u0641\u062a\u062a\u0627\u062d\u064a (",e.getCurrencySymbol(),") "),t.xp6(2),t.Q6J("name",e.getSortIcon("display_debit")),t.xp6(1),t.hij(" \u0645\u062f\u064a\u0646 (\u0639\u0644\u064a\u0647) (",e.getCurrencySymbol(),") "),t.xp6(2),t.Q6J("name",e.getSortIcon("display_credit")),t.xp6(1),t.hij(" \u062f\u0627\u0626\u0646 (\u0644\u0647) (",e.getCurrencySymbol(),") "),t.xp6(2),t.Q6J("name",e.getSortIcon("balance_status")),t.xp6(3),t.Q6J("ngForOf",e.sortedAccounts),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",e.filteredAccounts.length>0),t.xp6(1),t.Q6J("ngIf",e.showEmpty&&!e.loading)}}function E(o,d){if(1&o&&(t.TgZ(0,"div",101),t.TgZ(1,"span",102),t._uU(2,"\u0645\u062f\u064a\u0646 (\u0639\u0644\u064a\u0647):"),t.qZA(),t.TgZ(3,"span",105),t._uU(4),t.ALo(5,"currencyDisplay"),t.qZA(),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(t.Dn7(5,1,e.display_debit,"SDG",!1))}}function I(o,d){if(1&o&&(t.TgZ(0,"div",101),t.TgZ(1,"span",102),t._uU(2,"\u062f\u0627\u0626\u0646 (\u0644\u0647):"),t.qZA(),t.TgZ(3,"span",106),t._uU(4),t.ALo(5,"currencyDisplay"),t.qZA(),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(t.Dn7(5,1,e.display_credit,"SDG",!1))}}function N(o,d){if(1&o&&(t.TgZ(0,"ion-card",95),t.TgZ(1,"ion-card-content",96),t.TgZ(2,"div",97),t.TgZ(3,"div",98),t.TgZ(4,"h3"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"div",99),t.TgZ(9,"span",69),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",100),t.TgZ(12,"div",101),t.TgZ(13,"span",102),t._uU(14,"\u0627\u0644\u0631\u0635\u064a\u062f \u0627\u0644\u0627\u0641\u062a\u062a\u0627\u062d\u064a:"),t.qZA(),t.TgZ(15,"span",103),t._uU(16),t.ALo(17,"currencyDisplay"),t.qZA(),t.qZA(),t.YNc(18,E,6,5,"div",104),t.YNc(19,I,6,5,"div",104),t.TgZ(20,"div",101),t.TgZ(21,"span",102),t._uU(22,"\u062d\u0627\u0644\u0629 \u0627\u0644\u0631\u0635\u064a\u062f:"),t.qZA(),t.TgZ(23,"span",77),t._uU(24),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=d.$implicit,r=t.oxw(3);t.xp6(5),t.Oqu(e.sub_name),t.xp6(2),t.Oqu(e.sub_code||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f"),t.xp6(2),t.Q6J("ngClass",t.l5B(13,M,1==e.ac_id,2==e.ac_id,8==e.ac_id,9==e.ac_id)),t.xp6(1),t.hij(" ",r.getAccountTypeDisplay(e)," "),t.xp6(6),t.Oqu(t.Dn7(17,9,e.opening_balance,"SDG",!1)),t.xp6(2),t.Q6J("ngIf",e.display_debit>0),t.xp6(1),t.Q6J("ngIf",e.display_credit>0),t.xp6(4),t.Q6J("ngClass",t.WLB(18,O,"debit"==e.balance_status,"credit"==e.balance_status)),t.xp6(1),t.hij(" ",r.getBalanceStatusDisplay(e)," ")}}function z(o,d){1&o&&(t.TgZ(0,"div",89),t._UZ(1,"ion-icon",90),t.TgZ(2,"h4"),t._uU(3,"\u0644\u0627 \u062a\u0648\u062c\u062f \u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0623\u064a \u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.qZA())}function J(o,d){if(1&o&&(t.TgZ(0,"div",91),t.TgZ(1,"ion-card",92),t.TgZ(2,"ion-card-header"),t.TgZ(3,"ion-card-title",93),t._UZ(4,"ion-icon",51),t._uU(5," \u0645\u064a\u0632\u0627\u0646 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629 "),t.qZA(),t.qZA(),t.qZA(),t.YNc(6,N,25,21,"ion-card",94),t.YNc(7,z,6,0,"div",62),t.qZA()),2&o){const e=t.oxw(2);t.xp6(6),t.Q6J("ngForOf",e.sortedAccounts),t.xp6(1),t.Q6J("ngIf",e.showEmpty&&!e.loading)}}function G(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"div",14),t.TgZ(1,"ion-card",15),t.TgZ(2,"ion-card-content",16),t.TgZ(3,"div",17),t.TgZ(4,"ion-label",18),t._uU(5,"\u062a\u0635\u0641\u064a\u0629 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a:"),t.qZA(),t.TgZ(6,"ion-segment",19),t.NdJ("ngModelChange",function(l){return t.CHM(e),t.oxw().segmentValue=l})("ionChange",function(l){return t.CHM(e),t.oxw().segmentChanged(l)}),t.TgZ(7,"ion-segment-button",20),t.TgZ(8,"div",21),t._UZ(9,"ion-icon",22),t.TgZ(10,"span"),t._uU(11,"\u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"ion-segment-button",23),t.TgZ(13,"div",21),t._UZ(14,"ion-icon",24),t.TgZ(15,"span"),t._uU(16,"\u0627\u0644\u0639\u0645\u0644\u0627\u0621"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"ion-segment-button",25),t.TgZ(18,"div",21),t._UZ(19,"ion-icon",26),t.TgZ(20,"span"),t._uU(21,"\u0627\u0644\u0645\u0648\u0631\u062f\u0648\u0646"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"ion-segment-button",27),t.TgZ(23,"div",21),t._UZ(24,"ion-icon",28),t.TgZ(25,"span"),t._uU(26,"\u0627\u0644\u0645\u0628\u064a\u0639\u0627\u062a"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"ion-segment-button",29),t.TgZ(28,"div",21),t._UZ(29,"ion-icon",30),t.TgZ(30,"span"),t._uU(31,"\u0627\u0644\u0645\u0634\u062a\u0631\u064a\u0627\u062a"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(32,"ion-segment-button",31),t.TgZ(33,"div",21),t._UZ(34,"ion-icon",32),t.TgZ(35,"span"),t._uU(36,"\u0623\u062e\u0631\u0649"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(37,"div",33),t.TgZ(38,"ion-item",34),t.TgZ(39,"ion-checkbox",35),t.NdJ("ngModelChange",function(l){return t.CHM(e),t.oxw().showOnlyWithBalance=l})("ionChange",function(){return t.CHM(e),t.oxw().balanceFilterChanged()}),t.qZA(),t.TgZ(40,"ion-label"),t._uU(41,"\u0639\u0631\u0636 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0630\u0627\u062a \u0627\u0644\u0631\u0635\u064a\u062f \u0641\u0642\u0637"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(42,v,26,20,"ion-card",36),t.YNc(43,F,41,17,"ion-card",37),t.YNc(44,J,8,2,"div",38),t.qZA()}if(2&o){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.segmentValue),t.xp6(33),t.Q6J("ngModel",e.showOnlyWithBalance),t.xp6(3),t.Q6J("ngIf",!e.loading),t.xp6(1),t.Q6J("ngIf","desktop"==e.device),t.xp6(1),t.Q6J("ngIf","mobile"==e.device)}}const L=[{path:"",component:(()=>{class o{constructor(e,r,l,y,j,$,W,V,K,H,X,tt,et){this.platform=e,this.alertController=r,this.router=l,this.storage=y,this.modalController=j,this.loadingController=$,this.datePipe=W,this.api=V,this.toast=K,this.sortingService=H,this.exportService=X,this.currencyService=tt,this.cdr=et,this.accounts=[],this.filteredAccounts=[],this.sortedAccounts=[],this.currentSort=null,this.store_info=null,this.user_info=null,this.year=null,this.segmentValue="all",this.showOnlyWithBalance=!1,this.loading=!1,this.showEmpty=!1,this.device="",this.summary={total_accounts:0,grand_debit_total:0,grand_credit_total:0,difference:0},this.checkPlatform(),this.getAppInfo()}ngOnInit(){this.initializeCurrency()}ngOnDestroy(){this.currencySubscription&&this.currencySubscription.unsubscribe()}ionViewDidEnter(){this.getAppInfo()}initializeCurrency(){return(0,c.mG)(this,void 0,void 0,function*(){yield this.currencyService.initializeCurrency(),yield this.currencyService.loadSupportedCurrencies(),this.store_info&&this.year&&(yield this.currencyService.loadRatesByYear(this.store_info.id,this.year.id)),this.currencySubscription=this.currencyService.getCurrentCurrency().subscribe(e=>{this.cdr.detectChanges()})})}checkPlatform(){this.platform.is("desktop")?this.device="desktop":this.platform.is("mobile")&&(this.device="mobile")}getAppInfo(){this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("year").then(e=>{e&&(this.year=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.loadBalanceSheet())})}loadBalanceSheet(){var e,r;!(null===(e=this.store_info)||void 0===e?void 0:e.id)||!(null===(r=this.year)||void 0===r?void 0:r.id)||(this.loading=!0,this.showEmpty=!1,this.api.getComprehensiveBalanceSheet(this.store_info.id,this.year.id).subscribe(l=>{this.loading=!1,l&&l.accounts?(this.accounts=l.accounts,this.summary=l.summary,this.applyFilters()):(this.showEmpty=!0,this.accounts=[])},l=>{console.error("Error loading balance sheet:",l),this.loading=!1,this.showEmpty=!0,this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u0645\u064a\u0644 \u0645\u064a\u0632\u0627\u0646 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629","danger")}))}segmentChanged(e){this.segmentValue=e.detail.value,this.applyFilters()}balanceFilterChanged(){this.applyFilters()}applyFilters(){let e=[...this.accounts];if("all"!==this.segmentValue)switch(this.segmentValue){case"customer":e=e.filter(r=>1==r.cat_id);break;case"supplier":e=e.filter(r=>2==r.cat_id);break;case"sales":e=e.filter(r=>8==r.ac_id);break;case"purchases":e=e.filter(r=>9==r.ac_id);break;case"other":e=e.filter(r=>![1,2,8,9].includes(r.ac_id))}this.showOnlyWithBalance&&(e=e.filter(r=>r.display_debit>0||r.display_credit>0)),this.filteredAccounts=e,this.calculateFilteredTotals(),this.applySorting()}calculateFilteredTotals(){this.summary={total_accounts:this.filteredAccounts.length,grand_debit_total:this.filteredAccounts.reduce((e,r)=>e+r.display_debit,0),grand_credit_total:this.filteredAccounts.reduce((e,r)=>e+r.display_credit,0),difference:0},this.summary.difference=this.summary.grand_debit_total-this.summary.grand_credit_total}formatBalance(e){return e||0===e?new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.abs(e)):"0.00"}getAccountTypeDisplay(e){return 1==e.ac_id?"\u0639\u0645\u064a\u0644":2==e.ac_id?"\u0645\u0648\u0631\u062f":8==e.ac_id?"\u0645\u0628\u064a\u0639\u0627\u062a":9==e.ac_id?"\u0645\u0634\u062a\u0631\u064a\u0627\u062a":e.sub_type}getBalanceStatusDisplay(e){return"debit"===e.balance_status?"\u0645\u062f\u064a\u0646":"credit"===e.balance_status?"\u062f\u0627\u0626\u0646":"\u0645\u062a\u0648\u0627\u0632\u0646"}getAbsoluteValue(e){return e||0===e?Math.abs(e):0}refresh(){this.loadBalanceSheet()}presentToast(e,r="primary"){return(0,c.mG)(this,void 0,void 0,function*(){yield(yield this.toast.create({message:e,duration:2e3,color:r,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}applySorting(){this.sortedAccounts=this.currentSort?this.sortingService.sortData(this.filteredAccounts,this.currentSort.column,this.currentSort.direction):[...this.filteredAccounts]}sortBy(e){const r=this.sortingService.getNextSortDirection(e,this.currentSort);this.currentSort={column:e,direction:r},this.applySorting()}getSortIcon(e){return this.sortingService.getSortIcon(e,this.currentSort)}exportToPDF(){var e,r;return(0,c.mG)(this,void 0,void 0,function*(){if(!this.filteredAccounts||0===this.filteredAccounts.length)return void(yield this.presentToast("\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u062a\u0635\u062f\u064a\u0631","warning"));const l={title:this.exportService.generateDynamicTitle("balance-sheet2"),subtitle:this.generateSubtitle(),fileName:`balance-sheet-${this.datePipe.transform(new Date,"yyyy-MM-dd")}`,data:this.filteredAccounts,columns:this.getExportColumns(),userName:(null===(e=this.user_info)||void 0===e?void 0:e.full_name)||(null===(r=this.user_info)||void 0===r?void 0:r.user_name)||"\u0645\u0633\u062a\u062e\u062f\u0645 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641",pageType:"balance-sheet2",currentDate:this.datePipe.transform(new Date,"yyyy-MM-dd")||""};yield this.exportService.exportToPDF(l)})}exportToExcel(){var e,r;return(0,c.mG)(this,void 0,void 0,function*(){if(!this.filteredAccounts||0===this.filteredAccounts.length)return void(yield this.presentToast("\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u062a\u0635\u062f\u064a\u0631","warning"));const l={title:this.exportService.generateDynamicTitle("balance-sheet2"),subtitle:this.generateSubtitle(),fileName:`balance-sheet-${this.datePipe.transform(new Date,"yyyy-MM-dd")}`,data:this.filteredAccounts,columns:this.getExportColumns(),userName:(null===(e=this.user_info)||void 0===e?void 0:e.full_name)||(null===(r=this.user_info)||void 0===r?void 0:r.user_name)||"\u0645\u0633\u062a\u062e\u062f\u0645 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641",pageType:"balance-sheet2",currentDate:this.datePipe.transform(new Date,"yyyy-MM-dd")||""};yield this.exportService.exportToExcel(l)})}generateSubtitle(){let e="";return this.segmentValue&&"all"!==this.segmentValue&&(e=`\u0641\u0644\u062a\u0631: ${{all:"\u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a",customer:"\u0627\u0644\u0639\u0645\u0644\u0627\u0621",supplier:"\u0627\u0644\u0645\u0648\u0631\u062f\u0648\u0646",sales:"\u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u0645\u0628\u064a\u0639\u0627\u062a",purchases:"\u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u0645\u0634\u062a\u0631\u064a\u0627\u062a",other:"\u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u0623\u062e\u0631\u0649"}[this.segmentValue]}`),this.showOnlyWithBalance&&(e=e?`${e} - \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0630\u0627\u062a \u0627\u0644\u0631\u0635\u064a\u062f \u0641\u0642\u0637`:"\u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0630\u0627\u062a \u0627\u0644\u0631\u0635\u064a\u062f \u0641\u0642\u0637"),e}getExportColumns(){return[{key:"sub_name",title:"\u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628",width:25,type:"text"},{key:"cat_name",title:"\u0646\u0648\u0639 \u0627\u0644\u062d\u0633\u0627\u0628",width:15,type:"text"},{key:"opening_balance",title:"\u0627\u0644\u0631\u0635\u064a\u062f \u0627\u0644\u0627\u0641\u062a\u062a\u0627\u062d\u064a",width:15,type:"currency"},{key:"total_debit",title:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u062f\u064a\u0646",width:15,type:"currency"},{key:"total_credit",title:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0627\u0626\u0646",width:15,type:"currency"},{key:"current_balance",title:"\u0627\u0644\u0631\u0635\u064a\u062f \u0627\u0644\u062d\u0627\u0644\u064a",width:15,type:"currency"},{key:"balance_type",title:"\u0646\u0648\u0639 \u0627\u0644\u0631\u0635\u064a\u062f",width:10,type:"text"}]}getCurrencySymbol(){return this.currencyService.getCurrentCurrencySymbol()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.t4),t.Y36(s.Br),t.Y36(b.F0),t.Y36(_.K),t.Y36(s.IN),t.Y36(s.HT),t.Y36(h.uU),t.Y36(m.r),t.Y36(s.yF),t.Y36(C.$),t.Y36(n.T),t.Y36(a.i),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-balance-sheet2"]],decls:13,vars:2,consts:[[1,"transparent-header"],[1,"transparent-toolbar"],["slot","start"],[1,"glass-menu-button"],[1,"glass-title"],["slot","end"],["fill","clear",3,"click"],["name","refresh-outline"],[1,"modern-content"],["class","loading-container",4,"ngIf"],["class","main-container",4,"ngIf"],[1,"loading-container"],["name","crescent"],[1,"loading-text"],[1,"main-container"],[1,"filter-card"],[1,"filter-content"],[1,"segment-container"],[1,"segment-label"],[1,"balance-segment",3,"ngModel","ngModelChange","ionChange"],["value","all"],[1,"segment-content"],["name","list-outline"],["value","customer"],["name","people-outline"],["value","supplier"],["name","business-outline"],["value","sales"],["name","trending-up-outline"],["value","purchases"],["name","trending-down-outline"],["value","other"],["name","folder-outline"],[1,"balance-filter"],["lines","none"],["slot","start",3,"ngModel","ngModelChange","ionChange"],["class","summary-card",4,"ngIf"],["class","table-card","color","primary",4,"ngIf"],["class","mobile-cards",4,"ngIf"],[1,"summary-card"],[1,"summary-content"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"summary-value","debit-total"],[1,"summary-value","credit-total"],["color","primary",1,"table-card"],[1,"table-header","ion-no-padding"],[1,"card-header-with-export"],[1,"table-title"],["name","analytics-outline","slot","start"],["class","account-count",4,"ngIf"],[3,"hasData","isLoading","exportPDF","exportExcel"],[1,"table-content"],[1,"table-container"],[1,"modern-table"],[1,"sortable-header",3,"click"],[1,"sort-icon",3,"name"],["class","table-row",4,"ngFor","ngForOf"],["class","skeleton-row",4,"ngIf"],[4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"account-count"],[1,"table-row"],[1,"serial"],[1,"account-name"],[1,"account-code"],[1,"account-type"],[1,"type-badge",3,"ngClass"],[1,"opening-balance"],[1,"debit"],["class","amount debit-amount",4,"ngIf"],["class","amount zero-amount",4,"ngIf"],[1,"credit"],["class","amount credit-amount",4,"ngIf"],[1,"balance-status"],[1,"status-badge",3,"ngClass"],[1,"amount","debit-amount"],[1,"amount","zero-amount"],[1,"amount","credit-amount"],[1,"skeleton-row"],["animated","",2,"width","100%"],[1,"totals-row"],["colspan","5",1,"totals-label"],[1,"debit-total"],[1,"credit-total"],[1,"difference-cell"],[1,"amount"],[1,"empty-state"],["name","analytics-outline",1,"empty-icon"],[1,"mobile-cards"],["color","primary",1,"mobile-header-card"],[1,"mobile-title"],["class","mobile-account-card",4,"ngFor","ngForOf"],[1,"mobile-account-card"],[1,"mobile-content"],[1,"mobile-header"],[1,"account-info"],[1,"account-type-mobile"],[1,"mobile-balances"],[1,"balance-row"],[1,"balance-label"],[1,"balance-value"],["class","balance-row",4,"ngIf"],[1,"balance-value","debit-amount"],[1,"balance-value","credit-amount"]],template:function(e,r){1&e&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-buttons",2),t._UZ(3,"ion-menu-button",3),t.qZA(),t.TgZ(4,"ion-title",4),t._uU(5,"\u0645\u064a\u0632\u0627\u0646 \u0627\u0644\u0645\u0631\u0627\u062c\u0639\u0629 \u0648\u0627\u0644\u0623\u0631\u0635\u062f\u0629"),t.qZA(),t.TgZ(6,"ion-buttons",5),t._UZ(7,"app-currency-switcher"),t.TgZ(8,"ion-button",6),t.NdJ("click",function(){return r.refresh()}),t._UZ(9,"ion-icon",7),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"ion-content",8),t.YNc(11,Z,4,0,"div",9),t.YNc(12,G,45,5,"div",10),t.qZA()),2&e&&(t.xp6(11),t.Q6J("ngIf",!r.user_info||!r.store_info),t.xp6(1),t.Q6J("ngIf",r.user_info&&r.store_info))},directives:[s.Gu,s.sr,s.Sm,s.fG,s.wd,i.d,s.YG,s.gu,s.W2,h.O5,s.PQ,s.PM,s.FN,s.Q$,s.cJ,s.QI,p.JJ,p.On,s.GO,s.Ie,s.nz,s.w,s.Zi,s.Dq,g.a,h.sg,h.mk,s.CK],pipes:[x.v],styles:['.modern-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, rgba(255, 255, 255, .1), rgba(255, 255, 255, .05) );--color: var(--ion-color-dark);min-height:100vh;padding:8px;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px)}.modern-content[_ngcontent-%COMP%]:before{content:"";position:fixed;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(74,144,226,.1),rgba(80,227,194,.1),rgba(245,166,35,.1));animation:gradientShift 15s ease infinite;z-index:-1}@keyframes gradientShift{0%,to{background:linear-gradient(45deg,rgba(74,144,226,.1),rgba(80,227,194,.1),rgba(245,166,35,.1))}50%{background:linear-gradient(225deg,rgba(245,166,35,.1),rgba(74,144,226,.1),rgba(80,227,194,.1))}}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:16px}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:48px;height:48px;--color: var(--ion-color-primary)}.loading-container[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:14px;margin:0}.main-container[_ngcontent-%COMP%]{width:100%;max-width:1400px;margin:0 auto;display:flex;flex-direction:column;gap:12px}.filter-card[_ngcontent-%COMP%], .summary-card[_ngcontent-%COMP%], .table-card[_ngcontent-%COMP%], .mobile-header-card[_ngcontent-%COMP%], .mobile-account-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:16px;box-shadow:0 8px 32px #0000001a,inset 0 1px #fff3;margin:0;overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1)}.filter-card[_ngcontent-%COMP%]:hover, .summary-card[_ngcontent-%COMP%]:hover, .table-card[_ngcontent-%COMP%]:hover, .mobile-header-card[_ngcontent-%COMP%]:hover, .mobile-account-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 48px #00000026,inset 0 1px #ffffff4d}.filter-content[_ngcontent-%COMP%]{padding:16px}.segment-container[_ngcontent-%COMP%]{margin-bottom:16px}.segment-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:var(--ion-color-dark);margin-bottom:12px}.balance-segment[_ngcontent-%COMP%]{border-radius:12px;background:rgba(255,255,255,.7);border:1px solid rgba(0,0,0,.1);overflow:hidden}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: var(--ion-color-primary);--color: var(--ion-color-dark);--color-checked: white;border-radius:8px;margin:4px;transition:all .3s ease;min-height:44px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 4px 12px #4a90e24d;transform:translateY(-1px)}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;padding:6px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.balance-filter[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent;--color: var(--ion-color-dark);--padding-start: 0}.balance-filter[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:500}.balance-filter[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--color: var(--ion-color-primary);--color-checked: var(--ion-color-primary)}.summary-content[_ngcontent-%COMP%]{padding:16px}.summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));grid-gap:16px;gap:16px}.summary-item[_ngcontent-%COMP%]{text-align:center;padding:12px;background:rgba(255,255,255,.6);border-radius:12px;border:1px solid rgba(0,0,0,.05);transition:all .3s ease}.summary-item[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.8);transform:translateY(-1px);box-shadow:0 4px 16px #0000001a}.summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:13px;color:var(--ion-color-medium);margin-bottom:8px;font-weight:500}.summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--ion-color-dark);font-family:Courier New,monospace}.summary-item[_ngcontent-%COMP%]   .summary-value.debit-total[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.summary-item[_ngcontent-%COMP%]   .summary-value.credit-total[_ngcontent-%COMP%]{color:var(--ion-color-success)}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary),var(--ion-color-primary-shade));color:#fff}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{color:#fff;display:flex;align-items:center;gap:8px;font-size:18px;font-weight:600}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   .account-count[_ngcontent-%COMP%]{font-size:14px;color:#fffc;font-weight:400}.table-content[_ngcontent-%COMP%]{padding:0}.table-container[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:visible;border-radius:12px;background:rgba(255,255,255,.9);position:relative;margin-bottom:80px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:rgba(0,0,0,.1);border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:rgba(74,144,226,.6);border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:rgba(74,144,226,.8)}.modern-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0;font-size:14px}.modern-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(74,144,226,.1),rgba(80,227,194,.1))}.modern-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 12px;text-align:center;font-weight:600;color:var(--ion-color-dark);border-bottom:2px solid rgba(74,144,226,.2);white-space:nowrap;font-size:13px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{transition:all .2s ease;border-bottom:1px solid rgba(0,0,0,.05)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background:rgba(74,144,226,.05);transform:scale(1.001)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:center;vertical-align:middle;color:var(--ion-color-dark);font-size:13px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.serial[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-medium);width:60px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.account-name[_ngcontent-%COMP%]{text-align:right;font-weight:500;max-width:200px;word-break:break-word}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.account-code[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-family:Courier New,monospace}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.account-type[_ngcontent-%COMP%]{width:120px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.opening-balance[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.debit[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.credit[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-weight:600;width:120px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:6px;font-size:11px;font-weight:500}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .type-badge.customer-type[_ngcontent-%COMP%]{background:rgba(16,220,96,.1);color:var(--ion-color-success);border:1px solid rgba(16,220,96,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .type-badge.supplier-type[_ngcontent-%COMP%]{background:rgba(245,166,35,.1);color:var(--ion-color-warning);border:1px solid rgba(245,166,35,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .type-badge.sales-type[_ngcontent-%COMP%]{background:rgba(74,144,226,.1);color:var(--ion-color-primary);border:1px solid rgba(74,144,226,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .type-badge.purchase-type[_ngcontent-%COMP%]{background:rgba(220,53,69,.1);color:var(--ion-color-danger);border:1px solid rgba(220,53,69,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:6px;font-size:11px;font-weight:500}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .status-badge.debit-status[_ngcontent-%COMP%]{background:rgba(220,53,69,.1);color:var(--ion-color-danger);border:1px solid rgba(220,53,69,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .status-badge.credit-status[_ngcontent-%COMP%]{background:rgba(16,220,96,.1);color:var(--ion-color-success);border:1px solid rgba(16,220,96,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-family:Courier New,monospace}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount.debit-amount[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-weight:600}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount.credit-amount[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount.zero-amount[_ngcontent-%COMP%]{color:var(--ion-color-medium);opacity:.6}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .skeleton-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:10}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(74,144,226,.95),rgba(80,227,194,.95));border-top:3px solid rgba(74,144,226,.8);box-shadow:0 -4px 20px #0000001a;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:18px 12px;font-weight:700;font-size:14px;border:none;position:relative}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.totals-label[_ngcontent-%COMP%]{text-align:center;color:#fff;font-size:16px;text-shadow:0 1px 2px rgba(0,0,0,.2)}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.debit-total[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.credit-total[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.difference-cell[_ngcontent-%COMP%]{text-align:center}.modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.debit-total[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.credit-total[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td.difference-cell[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-weight:700;font-size:15px;color:#fff!important;text-shadow:0 1px 2px rgba(0,0,0,.3);background:rgba(255,255,255,.1);padding:4px 8px;border-radius:6px;display:inline-block;min-width:80px}.mobile-cards[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.mobile-header-card[color=primary][_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary),var(--ion-color-primary-shade))}.mobile-header-card[color=primary][_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .mobile-title[_ngcontent-%COMP%]{color:#fff;display:flex;align-items:center;gap:8px;font-size:18px;font-weight:600}.mobile-header-card[color=primary][_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   .mobile-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.mobile-content[_ngcontent-%COMP%]{padding:16px}.mobile-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}.mobile-header[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]{flex:1}.mobile-header[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;font-weight:600;color:var(--ion-color-dark)}.mobile-header[_ngcontent-%COMP%]   .account-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:var(--ion-color-medium);font-family:Courier New,monospace}.mobile-header[_ngcontent-%COMP%]   .account-type-mobile[_ngcontent-%COMP%]{flex-shrink:0}.mobile-balances[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.balance-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.05)}.balance-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.balance-row[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{font-size:13px;color:var(--ion-color-medium);font-weight:500}.balance-row[_ngcontent-%COMP%]   .balance-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;font-family:Courier New,monospace;color:var(--ion-color-dark)}.balance-row[_ngcontent-%COMP%]   .balance-value.debit-amount[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.balance-row[_ngcontent-%COMP%]   .balance-value.credit-amount[_ngcontent-%COMP%]{color:var(--ion-color-success)}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;opacity:.8}@media (max-width: 768px){.modern-content[_ngcontent-%COMP%]{padding:6px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]{padding:4px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px}.summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:12px}.summary-item[_ngcontent-%COMP%]{padding:8px}.summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:12px}.summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 480px){.summary-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.balance-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   .segment-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px}}.card-header-with-export[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:transparent;border-bottom:1px solid rgba(255,255,255,.1)}.card-header-with-export[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:600;color:#fff;display:flex;align-items:center;flex:1}.card-header-with-export[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:8px}.card-header-with-export[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   .account-count[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium);margin-right:8px}']}),o})()}];let Y=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[b.Bz.forChild(L)],b.Bz]}),o})();var R=u(62279);let Q=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[h.ez,p.u5,s.Pc,Y,R.m]]}),o})()},62279:(P,f,u)=>{u.d(f,{m:()=>t});var h=u(69808),p=u(34182),s=u(23349),b=u(32090),c=u(29863);let t=(()=>{class _{}return _.\u0275fac=function(C){return new(C||_)},_.\u0275mod=c.oAB({type:_}),_.\u0275inj=c.cJS({providers:[h.uU],imports:[[h.ez,p.u5,p.UX,s.Pc,b.Fw]]}),_})()},6612:(P,f,u)=>{u.d(f,{i:()=>_});var h=u(70655),p=u(40520),s=u(591),b=u(29863),c=u(90849),t=u(91472);let _=(()=>{class m{constructor(n,a,i){this.http=n,this.storage=a,this.servicesService=i,this.currentCurrency=new s.X("SDG"),this.currentYear=new s.X(null),this.exchangeRates=new s.X({}),this.supportedCurrencies=new s.X([]),this.ratesCache=new Map,this.api=this.servicesService.api}getCurrentCurrency(){return this.currentCurrency.asObservable()}getCurrentCurrencyValue(){return this.currentCurrency.value}setCurrency(n){this.currentCurrency.next(n),this.storage.set("selectedCurrency",n)}setCurrentYear(n){this.currentYear.next(n)}loadRatesByYear(n,a){return(0,h.mG)(this,void 0,void 0,function*(){try{const i=(new p.LE).set("store_id",n).set("year_id",a),g=yield this.http.get(this.api+"currency_rates/latest.php",{params:i}).toPromise();return g&&g.data&&(this.cacheRates(g.data,a),this.exchangeRates.next(g.data)),g}catch(i){return console.error("Error loading currency rates:",i),null}})}getExchangeRate(n){if("SDG"===n)return 1;const a=this.exchangeRates.value;if(Array.isArray(a)){const i=a.find(g=>g.target_currency===n);return i?parseFloat(i.exchange_rate):1}return 1}createCurrencyRate(n){const a={headers:new p.WM({"Content-Type":"application/json"})};return this.http.post(this.api+"currency_rates/create.php",n,a)}getCurrencyRates(n){let a=new p.LE;return Object.keys(n).forEach(i=>{n[i]&&(a=a.set(i,n[i]))}),this.http.get(this.api+"currency_rates/read.php",{params:a})}updateCurrencyRate(n,a){const i=Object.assign({id:n},a),g={headers:new p.WM({"Content-Type":"application/json"})};return this.http.put(this.api+"currency_rates/update.php",i,g)}deleteCurrencyRate(n){const a=(new p.LE).set("id",n);return this.http.delete(this.api+"currency_rates/delete.php",{params:a})}getNearestRate(n,a,i,g){const x=(new p.LE).set("currency",n).set("date",a).set("store_id",i).set("year_id",g);return this.http.get(this.api+"currency_rates/nearestDate.php",{params:x})}convertFromSDG(n,a){return"SDG"!==a&&n?n/this.getExchangeRate(a):n}convertToSDG(n,a){return"SDG"!==a&&n?n*this.getExchangeRate(a):n}formatCurrency(n,a){return`${n.toLocaleString("en-US",{minimumFractionDigits:2})} ${{SDG:"\u062c.\u0633",USD:"$",AED:"\u062f.\u0625",SAR:"\u0631.\u0633"}[a]||a}`}getSupportedCurrencies(){return this.http.get(this.api+"currencies/read.php")}getActiveCurrencies(){const n=(new p.LE).set("active_only","true");return this.http.get(this.api+"currencies/read.php",{params:n})}addSupportedCurrency(n){return this.http.post(this.api+"currencies/create.php",n)}updateSupportedCurrency(n,a){return this.http.put(this.api+"currencies/update.php",Object.assign({id:n},a))}deleteSupportedCurrency(n){const a=(new p.LE).set("id",n);return this.http.delete(this.api+"currencies/delete.php",{params:a})}cacheKey(n,a,i){return`${n}_${a}_${i}`}cacheRates(n,a){Array.isArray(n)&&n.forEach(i=>{const g=this.cacheKey(i.target_currency,i.rate_date,a);this.ratesCache.set(g,i)})}getCachedRate(n,a,i){const g=this.cacheKey(n,a,i);return this.ratesCache.get(g)}clearCache(){this.ratesCache.clear()}initializeCurrency(){return(0,h.mG)(this,void 0,void 0,function*(){try{yield this.storage.create();const n=yield this.storage.get("selectedCurrency");n&&this.currentCurrency.next(n)}catch(n){console.error("Error initializing currency:",n)}})}getCurrentExchangeRates(){return this.exchangeRates.asObservable()}getSupportedCurrenciesObservable(){return this.supportedCurrencies.asObservable()}loadSupportedCurrencies(){return(0,h.mG)(this,void 0,void 0,function*(){try{const n=yield this.getSupportedCurrencies().toPromise();n&&n.data&&this.supportedCurrencies.next(n.data)}catch(n){console.error("Error loading supported currencies:",n)}})}formatAmount(n,a){const i=a||this.getCurrentCurrencyValue();let g=n;return"SDG"!==i&&(g=this.convertFromSDG(n,i)),this.formatCurrency(g,i)}convertToCurrentCurrency(n,a="SDG"){const i=this.getCurrentCurrencyValue();if(a===i)return n;if("SDG"===a)return this.convertFromSDG(n,i);if("SDG"===i)return this.convertToSDG(n,a);{const g=this.convertToSDG(n,a);return this.convertFromSDG(g,i)}}getCurrentCurrencySymbol(){const n=this.getCurrentCurrencyValue();return{SDG:"\u062c.\u0633",USD:"$",AED:"\u062f.\u0625",SAR:"\u0631.\u0633"}[n]||n}getCurrentCurrencySymbolForHeader(n){return`${n} (${this.getCurrentCurrencySymbol()})`}formatAmountWithoutSymbol(n,a){const i=a||this.getCurrentCurrencyValue();let g=n;return"SDG"!==i&&(g=this.convertFromSDG(n,i)),g.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}return m.\u0275fac=function(n){return new(n||m)(b.LFG(p.eN),b.LFG(c.K),b.LFG(t.r))},m.\u0275prov=b.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},52562:(P,f,u)=>{u.d(f,{$:()=>p});var h=u(29863);let p=(()=>{class s{constructor(){}compareStrings(c,t){return c||t?c?t?c.localeCompare(t,"ar",{numeric:!0,sensitivity:"base",caseFirst:"lower"}):1:-1:0}compareNumbers(c,t){return(parseFloat(null==c?void 0:c.toString())||0)-(parseFloat(null==t?void 0:t.toString())||0)}compareDates(c,t){const _=new Date(c),m=new Date(t);return _.getTime()-m.getTime()}sortData(c,t,_){return c&&0!==c.length?[...c].sort((C,n)=>{let a=0;const i=C[t],g=n[t];return null==i&&null==g?0:null==i?"asc"===_?-1:1:null==g?"asc"===_?1:-1:(a=this.isDateColumn(t)||this.isDateValue(i)?this.compareDates(i,g):this.isNumericColumn(t)||this.isNumericValue(i)?this.compareNumbers(i,g):this.compareStrings(String(i),String(g)),"desc"===_?-a:a)}):c}isDateColumn(c){return["j_date","pay_date","date","created_at","updated_at"].includes(c)}isDateValue(c){return"string"==typeof c?/^\d{4}-\d{2}-\d{2}$|^\d{2}\/\d{2}\/\d{4}$/.test(c)||!isNaN(Date.parse(c)):c instanceof Date}isNumericColumn(c){return["amount","total","balance","price","quantity","qty","tot_pr","discount","pay","changee","sub_balance","current_balance","opening_balance","debit","credit","j_pay","perch_price","pay_price","id"].some(_=>c.toLowerCase().includes(_))}isNumericValue(c){return!isNaN(parseFloat(c))&&isFinite(c)}getSortIcon(c,t){return t&&t.column===c?"asc"===t.direction?"chevron-up-outline":"chevron-down-outline":"swap-vertical-outline"}getNextSortDirection(c,t){return t&&t.column===c&&"asc"===t.direction?"desc":"asc"}}return s.\u0275fac=function(c){return new(c||s)},s.\u0275prov=h.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);