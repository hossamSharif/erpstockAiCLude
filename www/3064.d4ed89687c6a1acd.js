"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3064],{73064:(Z,x,h)=>{h.r(x),h.d(x,{ItemsReportPageModule:()=>gt});var _=h(69808),f=h(34182),s=h(23349),y=h(94030),d=h(70655),p=h(79208),t=h(29863),C=h(65465),M=h(90849),I=h(91472),w=h(52562);const P=["searchInput"],b=["inputWrapper"];function q(r,c){1&r&&t._UZ(0,"ion-spinner",14)}function S(r,c){if(1&r&&(t.TgZ(0,"div",15),t.TgZ(1,"ion-text",16),t._uU(2," \u0627\u0644\u0635\u0646\u0641 \u0627\u0644\u0645\u062e\u062a\u0627\u0631: "),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5," | \u0627\u0644\u0645\u062e\u0632\u0648\u0646: "),t.TgZ(6,"strong",17),t._uU(7),t.qZA(),t.qZA(),t.qZA()),2&r){const e=t.oxw();t.xp6(4),t.Oqu(e.selectedItem.item_name),t.xp6(3),t.Oqu(e.selectedItem.availQty||0)}}let Q=(()=>{class r{constructor(e,n,i,o,l,u,a,g,m){this.alertController=e,this.router=n,this.api=i,this.storage=o,this.toast=l,this.loadingController=u,this.datePipe=a,this.cdr=g,this.renderer=m,this.placeholder="\u0627\u062e\u062a\u0631 \u0627\u0644\u0635\u0646\u0641",this.searchLang=0,this.showQuantityDisplay=!1,this.parentPage="items-report",this.itemSelected=new t.vpe,this.refreshRequested=new t.vpe,this.showDropdown=!1,this.highlightedIndex=-1,this.searchTerm="",this.items=[],this.loadingItems=!1,this.loadingQty=!1,this.qtyError=!1,this.qtyErrorMsg="",this.dropdownPosition={top:"0px",left:"0px",width:"250px"},this.componentHasFocus=!1,this.portalDropdownElement=null,this.initializeSelectedItem()}ngOnInit(){this.getAppInfo(),this.loadItemsFromBackend()}ngOnDestroy(){this.destroyPortalDropdown()}initializeSelectedItem(){this.selectedItem={id:void 0,dateCreated:"",pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,availQty:0,aliasEn:"",tax:0,imageUrl:""}}getAppInfo(){this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.loadItemsFromBackend())}),this.storage.get("year").then(e=>{e&&(this.year=e,this.loadItemsFromBackend())})}loadItemsFromBackend(){!this.store_info||!this.year||(console.log("Loading items from backend..."),this.loadingItems=!0,this.api.getAllStockItemsWithouteCounts(this.store_info.id,this.year.id).subscribe(e=>{console.log("Items loaded successfully:",e),this.items=e.data||[],this.loadingItems=!1,this.storage.set("itemsLocal",this.items).then(()=>{console.log("Items stored locally")})},e=>{console.error("Error loading items:",e),this.loadingItems=!1,this.loadItemsFromStorage(),this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0623\u0635\u0646\u0627\u0641\u060c \u062a\u0645 \u0627\u0644\u062a\u062d\u0645\u064a\u0644 \u0645\u0646 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062d\u0641\u0648\u0638\u0629","warning")},()=>{this.loadingItems=!1}))}loadItemsFromStorage(){this.storage.get("itemsLocal").then(e=>{e?(this.items=e,console.log("Items loaded from storage:",this.items.length)):(this.items=[],this.presentToast("\u0644\u0627 \u062a\u0648\u062c\u062f \u0623\u0635\u0646\u0627\u0641 \u0645\u062d\u0641\u0648\u0638\u0629","warning"))})}createPortalDropdown(){var e,n;this.portalDropdownElement&&this.destroyPortalDropdown();const i=(null===(e=this.inputWrapper)||void 0===e?void 0:e.nativeElement)||(null===(n=this.searchInput)||void 0===n?void 0:n.nativeElement);if(!i)return;const o=i.getBoundingClientRect();this.portalDropdownElement=this.renderer.createElement("div"),this.renderer.addClass(this.portalDropdownElement,"portal-dropdown-container"),this.renderer.setStyle(this.portalDropdownElement,"position","fixed"),this.renderer.setStyle(this.portalDropdownElement,"top",`${o.bottom+4}px`),this.renderer.setStyle(this.portalDropdownElement,"left",`${o.left}px`),this.renderer.setStyle(this.portalDropdownElement,"width",`${o.width}px`),this.renderer.setStyle(this.portalDropdownElement,"z-index","2147483647"),this.renderer.setStyle(this.portalDropdownElement,"background","white"),this.renderer.setStyle(this.portalDropdownElement,"border","1px solid #ccc"),this.renderer.setStyle(this.portalDropdownElement,"border-radius","8px"),this.renderer.setStyle(this.portalDropdownElement,"box-shadow","0 8px 24px rgba(0, 0, 0, 0.2)"),this.renderer.setStyle(this.portalDropdownElement,"max-height","300px"),this.renderer.setStyle(this.portalDropdownElement,"overflow-y","auto"),this.renderer.setStyle(this.portalDropdownElement,"min-width","250px"),this.createDropdownContent(),this.renderer.appendChild(document.body,this.portalDropdownElement),console.log("Portal dropdown created at:",{top:o.bottom+4,left:o.left,width:o.width})}createDropdownContent(){if(!this.portalDropdownElement)return;const e=this.getFilteredItems();if(0===e.length){const n=this.renderer.createElement("div");this.renderer.setStyle(n,"padding","12px"),this.renderer.setStyle(n,"text-align","center"),this.renderer.setStyle(n,"color","#666"),this.renderer.setStyle(n,"font-style","italic");const i=this.renderer.createText("\u0644\u0627 \u062a\u0648\u062c\u062f \u0646\u062a\u0627\u0626\u062c \u0645\u0637\u0627\u0628\u0642\u0629");return this.renderer.appendChild(n,i),void this.renderer.appendChild(this.portalDropdownElement,n)}e.forEach((n,i)=>{const o=this.renderer.createElement("div");this.renderer.addClass(o,"portal-dropdown-item"),this.renderer.setAttribute(o,"data-index",i.toString()),this.renderer.setStyle(o,"padding","12px"),this.renderer.setStyle(o,"border-bottom","1px solid #eee"),this.renderer.setStyle(o,"cursor","pointer"),this.renderer.setStyle(o,"direction","rtl"),this.renderer.setStyle(o,"text-align","right"),this.renderer.setStyle(o,"transition","background-color 0.2s ease");const l=this.renderer.createElement("div");this.renderer.setStyle(l,"font-size","14px"),this.renderer.setStyle(l,"font-weight","500"),this.renderer.setStyle(l,"color","#333"),this.renderer.setStyle(l,"margin-bottom","4px");const u=this.renderer.createText(n.item_name);this.renderer.appendChild(l,u),this.renderer.appendChild(o,l);const a=this.renderer.createElement("div");this.renderer.setStyle(a,"display","flex"),this.renderer.setStyle(a,"gap","12px"),this.renderer.setStyle(a,"font-size","11px");const g=this.renderer.createElement("span");this.renderer.setStyle(g,"color","#10dc60"),this.renderer.setStyle(g,"font-weight","600");const m=this.renderer.createText(`\u0628\u064a\u0639: ${n.pay_price}`);this.renderer.appendChild(g,m),this.renderer.appendChild(a,g);const O=this.renderer.createElement("span");this.renderer.setStyle(O,"color","#f04141"),this.renderer.setStyle(O,"font-weight","600");const T=this.renderer.createText(`\u0634\u0631\u0627\u0621: ${n.perch_price}`);this.renderer.appendChild(O,T),this.renderer.appendChild(a,O),this.renderer.appendChild(o,a),this.renderer.listen(o,"mousedown",A=>{A.preventDefault()}),this.renderer.listen(o,"click",A=>{console.log("Item clicked:",n.item_name),A.stopPropagation(),this.componentHasFocus=!0,this.selectItem(n)}),this.renderer.listen(o,"mouseenter",()=>{this.componentHasFocus=!0,this.updateHighlighting(i)}),this.renderer.appendChild(this.portalDropdownElement,o)}),this.updateHighlighting(this.highlightedIndex)}updateHighlighting(e){this.portalDropdownElement&&(this.highlightedIndex=e,this.portalDropdownElement.querySelectorAll(".portal-dropdown-item").forEach((i,o)=>{const l=i;o===this.highlightedIndex?(this.renderer.setStyle(l,"background-color","rgba(74, 144, 226, 0.1)"),this.renderer.setStyle(l,"border-left","3px solid #4A90E2")):(this.renderer.removeStyle(l,"background-color"),this.renderer.removeStyle(l,"border-left"))}))}updatePortalDropdown(){if(this.portalDropdownElement){for(;this.portalDropdownElement.firstChild;)this.renderer.removeChild(this.portalDropdownElement,this.portalDropdownElement.firstChild);this.createDropdownContent()}}destroyPortalDropdown(){this.portalDropdownElement&&(this.renderer.removeChild(document.body,this.portalDropdownElement),this.portalDropdownElement=null)}calculateDropdownPosition(){var e,n;const i=(null===(e=this.inputWrapper)||void 0===e?void 0:e.nativeElement)||(null===(n=this.searchInput)||void 0===n?void 0:n.nativeElement);if(i){const o=i.getBoundingClientRect();this.dropdownPosition={top:o.bottom+4+"px",left:o.left+"px",width:o.width+"px"}}}getFilteredItems(){if(!this.items||0===this.items.length)return[];if(this.searchTerm&&""!==this.searchTerm.trim()){const e=this.searchTerm.toLowerCase();return this.items.filter(n=>n.item_name.toLowerCase().includes(e)||n.item_desc&&n.item_desc.toLowerCase().includes(e)||n.aliasEn&&n.aliasEn.toLowerCase().includes(e))}return this.items}onInputFocus(){console.log("Input focused, items:",this.items.length),this.componentHasFocus=!0,this.highlightedIndex=-1,this.items.length>0?setTimeout(()=>{this.showDropdown=!0,this.createPortalDropdown()},10):console.warn("No items available to show in dropdown")}onInputBlur(){console.log("Input blur triggered"),this.componentHasFocus=!1,setTimeout(()=>{this.componentHasFocus||(console.log("Hiding dropdown after blur delay"),this.showDropdown=!1,this.highlightedIndex=-1,this.destroyPortalDropdown())},300)}onWindowScroll(){this.showDropdown&&this.portalDropdownElement&&this.createPortalDropdown()}onWindowResize(){this.showDropdown&&this.portalDropdownElement&&this.createPortalDropdown()}onDocumentClick(e){var n,i;const o=e.target;if(!o)return;const l=(null===(n=this.inputWrapper)||void 0===n?void 0:n.nativeElement)||(null===(i=this.searchInput)||void 0===i?void 0:i.nativeElement);let u=!1,a=!1;l&&(u=l.contains(o)||null!==o.closest(".item-selector-wrapper")),this.portalDropdownElement&&(a=this.portalDropdownElement.contains(o)||null!==o.closest(".portal-dropdown-container")||null!==o.closest(".portal-dropdown-item")),console.log("Document click detected:",{isClickInsideComponent:u,isClickInsidePortalDropdown:a,targetClass:o.className,showDropdown:this.showDropdown}),!u&&!a&&this.showDropdown&&(console.log("Hiding dropdown due to outside click"),this.showDropdown=!1,this.highlightedIndex=-1,this.componentHasFocus=!1,this.destroyPortalDropdown())}onSearchInput(e){this.searchTerm=e.target.value||e.detail.value||"",console.log("Search term changed to:",this.searchTerm),0===this.searchTerm.length&&(console.log("Input field cleared - resetting selection"),this.resetSelection()),this.highlightedIndex=-1,this.searchTerm.length>0||this.items.length>0?(this.showDropdown?this.portalDropdownElement&&this.updatePortalDropdown():(this.showDropdown=!0,this.createPortalDropdown()),console.log("Showing dropdown with",this.getFilteredItems().length,"filtered items")):(this.showDropdown=!1,this.destroyPortalDropdown())}onInputClear(e){console.log("Clear button clicked"),this.searchTerm="",this.resetSelection(),this.showDropdown=!1,this.highlightedIndex=-1,this.destroyPortalDropdown()}onModelChange(e){console.log("Model changed to:",e),this.searchTerm=e||"",(!e||0===e.length)&&(console.log("Model change detected empty value - resetting component"),this.resetSelection()),this.highlightedIndex=-1,this.searchTerm.length>0||this.getFilteredItems().length>0?this.showDropdown||(this.showDropdown=!0,this.calculateDropdownPosition()):this.showDropdown=!1}resetSelection(){this.initializeSelectedItem(),this.searchTerm="",this.showDropdown=!1,this.highlightedIndex=-1,this.itemSelected.emit(null),this.destroyPortalDropdown(),this.searchInput&&this.searchInput.nativeElement&&(this.searchInput.nativeElement.value=""),this.cdr.detectChanges()}toggleDropdown(){console.log("Toggle dropdown clicked, items:",this.items.length),this.items.length>0?(this.showDropdown=!this.showDropdown,this.showDropdown&&(this.calculateDropdownPosition(),this.searchInput&&setTimeout(()=>{this.searchInput.nativeElement.focus()},100)),this.highlightedIndex=-1):console.warn("No items loaded yet")}onKeyDown(e){if(this.showDropdown&&0!==this.getFilteredItems().length)switch(e.key){case"ArrowDown":e.preventDefault();const n=Math.min(this.highlightedIndex+1,this.getFilteredItems().length-1);this.updateHighlighting(n),this.scrollHighlightedItemIntoView();break;case"ArrowUp":e.preventDefault();const i=Math.max(this.highlightedIndex-1,-1);this.updateHighlighting(i),this.scrollHighlightedItemIntoView();break;case"Enter":e.preventDefault(),this.highlightedIndex>=0&&this.highlightedIndex<this.getFilteredItems().length&&this.selectItem(this.getFilteredItems()[this.highlightedIndex]);break;case"Escape":e.preventDefault(),this.showDropdown=!1,this.highlightedIndex=-1,this.destroyPortalDropdown();break;case"Tab":this.showDropdown=!1,this.highlightedIndex=-1,this.destroyPortalDropdown()}else"ArrowDown"===e.key&&this.getFilteredItems().length>0&&(e.preventDefault(),this.showDropdown=!0,this.createPortalDropdown(),this.updateHighlighting(0))}scrollHighlightedItemIntoView(){if(this.highlightedIndex>=0&&this.portalDropdownElement){const e=this.portalDropdownElement.querySelector(`[data-index="${this.highlightedIndex}"]`);if(e){const n=this.portalDropdownElement.getBoundingClientRect(),i=e.getBoundingClientRect();i.bottom>n.bottom?this.portalDropdownElement.scrollTop+=i.bottom-n.bottom+10:i.top<n.top&&(this.portalDropdownElement.scrollTop-=n.top-i.top+10)}}}selectItem(e){console.log("\u2705 selectItem called with:",e.item_name),this.selectedItem={id:e.id,dateCreated:e.dateCreated,pay_ref:"",item_desc:e.item_desc,item_name:e.item_name,item_unit:e.item_unit,parcode:e.parcode,pay_price:e.pay_price,perch_price:e.perch_price,qty:"",tot:e.pay_price,availQty:e.quantity||e.availQty,aliasEn:e.aliasEn,tax:e.tax||0,imageUrl:e.imageUrl||""},this.searchTerm=e.item_name,this.showDropdown=!1,this.highlightedIndex=-1,this.componentHasFocus=!1,this.destroyPortalDropdown(),console.log("\u2705 Item selection completed, emitting event"),this.cdr.detectChanges(),this.searchInput&&this.searchInput.nativeElement&&setTimeout(()=>{const n=this.searchInput.nativeElement;n.value=e.item_name;const i=new Event("input",{bubbles:!0});n.dispatchEvent(i)},10),this.itemSelected.emit(this.selectedItem),console.log("\u2705 Item selected and emitted:",this.selectedItem.item_name)}refreshItems(){console.log("Refreshing items..."),this.loadItemsFromBackend(),this.refreshRequested.emit()}trackByItemId(e,n){return n.id||e}presentToast(e,n){return(0,d.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:e,duration:2e3,color:n,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}refreshQuantity(){console.log("Refresh quantity called")}viewSelectedItemReport(){if(this.selectedItem&&this.selectedItem.id){const e={queryParams:{item:JSON.stringify(this.selectedItem)}};this.router.navigate(["/items-report"],e)}}viewSelectedItemDetails(){console.log("View item details called for:",this.selectedItem)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(s.Br),t.Y36(y.F0),t.Y36(I.r),t.Y36(M.K),t.Y36(s.yF),t.Y36(s.HT),t.Y36(_.uU),t.Y36(t.sBO),t.Y36(t.Qsj))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-enhanced-item-selector"]],viewQuery:function(e,n){if(1&e&&(t.Gf(P,5),t.Gf(b,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.searchInput=i.first),t.iGM(i=t.CRH())&&(n.inputWrapper=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("scroll",function(o){return n.onWindowScroll(o)},!1,t.Jf7)("resize",function(o){return n.onWindowResize(o)},!1,t.Jf7)("click",function(o){return n.onDocumentClick(o)},!1,t.evT)},inputs:{placeholder:"placeholder",searchLang:"searchLang",showQuantityDisplay:"showQuantityDisplay",parentPage:"parentPage"},outputs:{itemSelected:"itemSelected",refreshRequested:"refreshRequested"},decls:19,vars:9,consts:[[1,"ion-no-margin","ion-no-padding"],["size","12",1,"ion-no-margin","ion-no-padding"],[1,"label-with-buttons-container"],[1,"action-buttons-left"],["fill","clear","size","small",1,"item-refresh-btn-left",3,"disabled","click"],["name","refresh","color","primary"],["name","dots","class","item-loading-spinner-left",4,"ngIf"],[2,"text-align","right"],[1,"custInput","item-selector-wrapper"],[1,"input-container-wrapper"],["inputWrapper",""],[1,"item-selector-input",3,"ngModel","placeholder","disabled","clearInput","ngModelChange","ionInput","ionClear","ionFocus","ionBlur","click","keydown"],["searchInput",""],["class","selected-item-info",4,"ngIf"],["name","dots",1,"item-loading-spinner-left"],[1,"selected-item-info"],["color","medium",1,"selected-info"],["color","danger"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-grid",0),t.TgZ(1,"ion-row"),t.TgZ(2,"ion-col",1),t.TgZ(3,"div",2),t.TgZ(4,"div",3),t.TgZ(5,"ion-button",4),t.NdJ("click",function(){return n.refreshItems()}),t._UZ(6,"ion-icon",5),t.qZA(),t.YNc(7,q,1,0,"ion-spinner",6),t.qZA(),t.TgZ(8,"ion-label",7),t.TgZ(9,"strong"),t._uU(10,"\u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"ion-row"),t.TgZ(12,"ion-col",1),t.TgZ(13,"ion-item",8),t.TgZ(14,"div",9,10),t.TgZ(16,"ion-input",11,12),t.NdJ("ngModelChange",function(o){return n.searchTerm=o})("ngModelChange",function(o){return n.onModelChange(o)})("ionInput",function(o){return n.onSearchInput(o)})("ionClear",function(o){return n.onInputClear(o)})("ionFocus",function(){return n.onInputFocus()})("ionBlur",function(){return n.onInputBlur()})("click",function(){return n.onInputFocus()})("keydown",function(o){return n.onKeyDown(o)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(18,S,8,2,"div",13)),2&e&&(t.xp6(5),t.Q6J("disabled",n.loadingItems),t.xp6(1),t.ekj("spin",n.loadingItems),t.xp6(1),t.Q6J("ngIf",n.loadingItems),t.xp6(9),t.Q6J("ngModel",n.searchTerm)("placeholder",n.placeholder||"\u0627\u062e\u062a\u0631 \u0627\u0644\u0635\u0646\u0641")("disabled",n.loadingItems)("clearInput",!0),t.xp6(2),t.Q6J("ngIf",n.showQuantityDisplay&&n.selectedItem.id))},directives:[s.jY,s.Nd,s.wI,s.YG,s.gu,_.O5,s.Q$,s.Ie,s.pK,s.j9,f.JJ,f.On,s.PQ,s.yW],styles:[".custInput[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;margin:5px 0}.red[_ngcontent-%COMP%]{--background: #ffebee;--color: #c62828}.darko[_ngcontent-%COMP%]{--background: #f5f5f5;--color: #333}.cust_Toast[_ngcontent-%COMP%]{--border-radius: 10px;--box-shadow: 0 10px 15px -3px rgba(0, 0, 0, .1)}.label-with-buttons-container[_ngcontent-%COMP%]{direction:rtl;display:flex;justify-content:space-between;align-items:center;position:relative;text-align:right}.label-with-buttons-container[_ngcontent-%COMP%]   .action-buttons-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;order:1}.item-refresh-btn-left[_ngcontent-%COMP%]{--color: var(--ion-color-success);--padding-start: 3px;--padding-end: 3px;height:32px;width:32px}.item-refresh-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px;transition:transform .3s ease}.item-refresh-btn-left[_ngcontent-%COMP%]   ion-icon.spin[_ngcontent-%COMP%]{animation:spin 1s linear infinite}.item-refresh-btn-left[_ngcontent-%COMP%]:hover{--color: var(--ion-color-success-shade);--background: rgba(var(--ion-color-success-rgb), .1)}.item-refresh-btn-left[disabled][_ngcontent-%COMP%]{--color: var(--ion-color-medium);opacity:.5}.item-loading-spinner-left[_ngcontent-%COMP%]{width:18px;height:18px;margin:0}.item-selector-wrapper[_ngcontent-%COMP%]{width:100%;margin:5px 0;z-index:1000}.item-selector-wrapper[_ngcontent-%COMP%]   .input-container-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]{--background: transparent;--color: var(--ion-color-dark);--placeholder-color: var(--ion-color-medium);width:100%;direction:rtl;text-align:right;--padding-start: 12px;--padding-end: 45px}.item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%], .item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important;max-width:calc(100% - 80px)!important;display:block!important}.item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[disabled][_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-medium);cursor:not-allowed}.dropdown-container[_ngcontent-%COMP%]{position:fixed!important;z-index:2147483647!important;background:white!important;border:1px solid var(--ion-color-light)!important;border-radius:8px!important;box-shadow:0 8px 24px #0003!important;max-height:300px!important;overflow-y:auto!important;min-width:250px!important;transform:translateZ(0)!important;will-change:transform!important;-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important}.dropdown-container[_ngcontent-%COMP%]   .dropdown-header[_ngcontent-%COMP%]{background:var(--ion-color-light-tint);border-bottom:1px solid var(--ion-color-light-shade);padding:8px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]{margin:0;padding:0;background:transparent}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]{--background: transparent;--border-color: transparent;--color: var(--ion-color-dark);--padding-start: 12px;--padding-end: 12px;--min-height: 60px;direction:rtl;text-align:right}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]:hover{--background: var(--ion-color-light)}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]:active{--background: rgba(var(--ion-color-primary-rgb), .1)}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item.highlighted[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-primary-rgb), .1);border-left:3px solid var(--ion-color-primary)}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:var(--ion-color-dark);margin:0 0 4px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-desc[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin:2px 0}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-prices-compact[_ngcontent-%COMP%]{display:flex;gap:12px;font-size:11px;margin-top:4px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-prices-compact[_ngcontent-%COMP%]   .price-sale[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:600}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-prices-compact[_ngcontent-%COMP%]   .price-purchase[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-weight:600}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-prices-compact[_ngcontent-%COMP%]   .stock-qty[_ngcontent-%COMP%]{color:var(--ion-color-dark);font-weight:500}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--padding-start: 12px;--padding-end: 12px;text-align:center;font-style:italic}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.label-with-buttons-container[_ngcontent-%COMP%]   .action-buttons-left[_ngcontent-%COMP%]{gap:2px}.label-with-buttons-container[_ngcontent-%COMP%]   .item-refresh-btn-left[_ngcontent-%COMP%]{height:28px;width:28px;--padding-start: 2px;--padding-end: 2px}.label-with-buttons-container[_ngcontent-%COMP%]   .item-refresh-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px}.label-with-buttons-container[_ngcontent-%COMP%]   .item-loading-spinner-left[_ngcontent-%COMP%]{width:16px;height:16px}.item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]{font-size:13px;--padding-start: 10px;--padding-end: 40px}.item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%], .item-selector-wrapper[_ngcontent-%COMP%]   .item-selector-input[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:calc(100% - 45px)!important;font-size:13px!important}.dropdown-container[_ngcontent-%COMP%]{max-height:200px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]{--min-height: 50px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:13px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-desc[_ngcontent-%COMP%]{font-size:11px}.dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .item-prices-compact[_ngcontent-%COMP%]{font-size:10px}}.item-selector-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]   .native-input[_ngcontent-%COMP%], .item-selector-wrapper[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important;width:100%!important}.item-selector-wrapper[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{overflow:hidden!important}.item-selector-wrapper[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}[_nghost-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{position:fixed!important;z-index:2147483647!important;transform:translateZ(0)!important;will-change:transform!important;-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important}.selected-item-info[_ngcontent-%COMP%]{margin-top:8px;padding:8px 12px;background:#f8f9fa;border-radius:4px;border:1px solid #e9ecef}.selected-item-info[_ngcontent-%COMP%]   .selected-info[_ngcontent-%COMP%]{font-size:13px;color:#495057}@media (prefers-color-scheme: dark){.item-selector-wrapper[_ngcontent-%COMP%]   .custInput[_ngcontent-%COMP%]{--background: #1e1e1e;--color: white;border-color:#404040}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{background:#1e1e1e;border-color:#404040}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]{--background: #1e1e1e;--color: white}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]:hover{--background: #2a2a2a}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item.highlighted[_ngcontent-%COMP%]{--background: #1565c0;--color: white}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .item-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.item-selector-wrapper[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .item-dropdown[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{--background: #1e1e1e;--color: #aaa}.item-selector-wrapper[_ngcontent-%COMP%]   .selected-item-info[_ngcontent-%COMP%]{background:#2a2a2a;border-color:#404040}.item-selector-wrapper[_ngcontent-%COMP%]   .selected-item-info[_ngcontent-%COMP%]   .selected-info[_ngcontent-%COMP%]{color:#ccc}}"]}),r})();const k=["dst"],E=["qtyId"],N=["dstPop"],R=["popInput"],U=["popover"];function F(r,c){1&r&&t._UZ(0,"ion-back-button",13)}function B(r,c){1&r&&t._UZ(0,"ion-menu-button",14)}function J(r,c){1&r&&(t.TgZ(0,"div",15),t._UZ(1,"ion-spinner",16),t.TgZ(2,"p",17),t._uU(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),t.qZA(),t.qZA())}function L(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"ion-input",39),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).startingDate=i}),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("ngModel",e.startingDate)}}function z(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"ion-input",40),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).startingDate=i}),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("ngModel",e.startingDate)}}function Y(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"ion-input",41),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw(2).endDate=i}),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("ngModel",e.endDate)}}function H(r,c){if(1&r&&(t.TgZ(0,"ion-card",42),t.TgZ(1,"ion-card-content",43),t.TgZ(2,"div",44),t.TgZ(3,"div",45),t.TgZ(4,"div",46),t.TgZ(5,"span",47),t._uU(6,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0625\u0641\u062a\u062a\u0627\u062d\u064a\u0629:"),t.qZA(),t.TgZ(7,"span",48),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",45),t.TgZ(10,"div",46),t.TgZ(11,"span",47),t._uU(12,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u062d\u0627\u0644\u064a\u0629:"),t.qZA(),t.TgZ(13,"span",48),t._uU(14),t.qZA(),t.qZA(),t.qZA(),t.TgZ(15,"div",45),t.TgZ(16,"div",46),t.TgZ(17,"span",47),t._uU(18,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0635\u0627\u062f\u0631\u0629:"),t.qZA(),t.TgZ(19,"span",48),t._uU(20),t.qZA(),t.qZA(),t.qZA(),t.TgZ(21,"div",45),t.TgZ(22,"div",46),t.TgZ(23,"span",47),t._uU(24,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0648\u0627\u0631\u062f\u0629:"),t.qZA(),t.TgZ(25,"span",48),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r){const e=t.oxw(2);t.xp6(8),t.Oqu(e.selectedItemNew.firstQty),t.xp6(5),t.Udp("color",e.selectedItemNew.availQty>0?"#10dc60":"#f04141"),t.xp6(1),t.hij(" ",e.selectedItemNew.availQty," "),t.xp6(6),t.Oqu(e.selectedItemNew.payTotQty),t.xp6(6),t.Oqu(e.selectedItemNew.perchTotQty)}}function j(r,c){if(1&r&&(t.TgZ(0,"span",62),t._uU(1),t.qZA()),2&r){const e=t.oxw(3);t.xp6(1),t.hij(" (",e.displayedPayArray.length," \u062d\u0631\u0643\u0629) ")}}function V(r,c){if(1&r&&(t.TgZ(0,"span",73),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.toPositive(e.quantity)," ")}}function W(r,c){if(1&r&&(t.TgZ(0,"span",73),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.toPositive(e.quantity)," ")}}function G(r,c){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.sub_name)}}const v=function(r,c,e){return{"sales-type":r,"purchase-type":c,"voucher-type":e}};function $(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"tr",63),t.TgZ(1,"td",64),t._uU(2),t.qZA(),t.TgZ(3,"td",65),t.TgZ(4,"span",66),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"td",67),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"td",68),t.YNc(10,V,2,1,"span",69),t.qZA(),t.TgZ(11,"td",70),t.YNc(12,W,2,1,"span",69),t.qZA(),t.TgZ(13,"td",71),t.YNc(14,G,2,1,"span",72),t.qZA(),t.TgZ(15,"td",73),t._uU(16),t.qZA(),t.TgZ(17,"td",73),t._uU(18),t.qZA(),t.TgZ(19,"td",73),t._uU(20),t.qZA(),t.TgZ(21,"td",74),t.TgZ(22,"ion-button",75),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw(3).getPayInvoDetail(o,o.sub_name,"edit")}),t._UZ(23,"ion-icon",76),t.qZA(),t.qZA(),t.qZA()}if(2&r){const e=c.$implicit,n=c.index,i=t.oxw(3);t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Q6J("ngClass",t.kEZ(13,v,"\u0645\u0628\u064a\u0639\u0627\u062a"===e.type,"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"===e.type,"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"===e.type)),t.xp6(1),t.hij(" ",e.type," "),t.xp6(2),t.Oqu(t.xi3(8,10,e.pay_date,"dd/MM/yyyy")),t.xp6(3),t.Q6J("ngIf","\u0645\u0634\u062a\u0631\u064a\u0627\u062a"==e.type||"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==e.type&&+e.quantity<0),t.xp6(2),t.Q6J("ngIf","\u0645\u0628\u064a\u0639\u0627\u062a"==e.type||"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==e.type&&+e.quantity>0),t.xp6(2),t.Q6J("ngIf","\u0645\u0628\u064a\u0639\u0627\u062a"==e.type||"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"==e.type),t.xp6(2),t.Oqu(e.pay_price),t.xp6(2),t.Oqu(e.perch_price),t.xp6(2),t.Oqu(i.toPositive(+e.tot))}}function K(r,c){1&r&&(t.TgZ(0,"tr",77),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",78),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",78),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",78),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",78),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",78),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",78),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"ion-skeleton-text",78),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"ion-skeleton-text",78),t.qZA(),t.TgZ(17,"td"),t._UZ(18,"ion-skeleton-text",78),t.qZA(),t.TgZ(19,"td"),t._UZ(20,"ion-skeleton-text",78),t.qZA(),t.qZA())}function X(r,c){1&r&&(t.TgZ(0,"tr",77),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",78),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",78),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",78),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",78),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",78),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",78),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"ion-skeleton-text",78),t.qZA(),t.TgZ(15,"td"),t._UZ(16,"ion-skeleton-text",78),t.qZA(),t.TgZ(17,"td"),t._UZ(18,"ion-skeleton-text",78),t.qZA(),t.TgZ(19,"td"),t._UZ(20,"ion-skeleton-text",78),t.qZA(),t.qZA())}function tt(r,c){1&r&&(t.TgZ(0,"div",79),t._UZ(1,"ion-icon",80),t.TgZ(2,"h4"),t._uU(3,"\u0644\u0627 \u062a\u0648\u062c\u062f \u062d\u0631\u0643\u0627\u062a"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062d\u0631\u0643\u0627\u062a \u0644\u0647\u0630\u0627 \u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.qZA())}function et(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"ion-card",49),t.TgZ(1,"ion-card-header",50),t.TgZ(2,"ion-card-title",51),t._UZ(3,"ion-icon",52),t._uU(4),t.YNc(5,j,2,1,"span",53),t.qZA(),t.qZA(),t.TgZ(6,"ion-card-content",54),t.TgZ(7,"div",55),t.TgZ(8,"table",56),t.TgZ(9,"thead"),t.TgZ(10,"tr"),t.TgZ(11,"th"),t._uU(12,"\u0627\u0644\u062a\u0633\u0644\u0633\u0644"),t.qZA(),t.TgZ(13,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("type")}),t._UZ(14,"ion-icon",58),t._uU(15," \u0646\u0648\u0639 \u0627\u0644\u062d\u0631\u0643\u0629 "),t.qZA(),t.TgZ(16,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("pay_date")}),t._UZ(17,"ion-icon",58),t._uU(18," \u0627\u0644\u062a\u0627\u0631\u064a\u062e "),t.qZA(),t.TgZ(19,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("quantity")}),t._UZ(20,"ion-icon",58),t._uU(21," \u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0648\u0627\u0631\u062f\u0629 "),t.qZA(),t.TgZ(22,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("quantity")}),t._UZ(23,"ion-icon",58),t._uU(24," \u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0635\u0627\u062f\u0631\u0629 "),t.qZA(),t.TgZ(25,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("sub_name")}),t._UZ(26,"ion-icon",58),t._uU(27," \u0627\u0644\u0639\u0645\u064a\u0644/\u0627\u0644\u0645\u0648\u0631\u062f "),t.qZA(),t.TgZ(28,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("pay_price")}),t._UZ(29,"ion-icon",58),t._uU(30," \u0633\u0639\u0631 \u0627\u0644\u0628\u064a\u0639 "),t.qZA(),t.TgZ(31,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("perch_price")}),t._UZ(32,"ion-icon",58),t._uU(33," \u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621 "),t.qZA(),t.TgZ(34,"th",57),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sortTransactionsBy("tot")}),t._UZ(35,"ion-icon",58),t._uU(36," \u0627\u0644\u0645\u062c\u0645\u0648\u0639 "),t.qZA(),t.TgZ(37,"th"),t._uU(38,"\u0639\u0631\u0636 \u0627\u0644\u0641\u0627\u062a\u0648\u0631\u0629"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(39,"tbody"),t.YNc(40,$,24,17,"tr",59),t.YNc(41,K,21,0,"tr",60),t.YNc(42,X,21,0,"tr",60),t.qZA(),t.qZA(),t.qZA(),t.YNc(43,tt,6,0,"div",61),t.qZA(),t.qZA()}if(2&r){const e=t.oxw(2);t.xp6(4),t.hij(" \u062a\u0642\u0631\u064a\u0631 \u062d\u0631\u0643\u0629 \u0627\u0644\u0635\u0646\u0641 - ",(null==e.selectedItemNew?null:e.selectedItemNew.item_name)||"\u0627\u062e\u062a\u0631 \u0635\u0646\u0641 \u0644\u0639\u0631\u0636 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a"," "),t.xp6(1),t.Q6J("ngIf",e.displayedPayArray&&e.displayedPayArray.length>0),t.xp6(9),t.Q6J("name",e.getTransactionsSortIcon("type")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("pay_date")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("quantity")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("quantity")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("sub_name")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("pay_price")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("perch_price")),t.xp6(3),t.Q6J("name",e.getTransactionsSortIcon("tot")),t.xp6(5),t.Q6J("ngForOf",e.displayedPayArray)("ngForTrackBy",e.trackByPaymentId),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",e.showEmpty&&!e.loading)}}function nt(r,c){if(1&r&&(t.TgZ(0,"span",62),t._uU(1),t.qZA()),2&r){const e=t.oxw(3);t.xp6(1),t.hij(" (",e.payArrayDaily.length," \u0635\u0646\u0641) ")}}function it(r,c){if(1&r&&(t.TgZ(0,"span",73),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.toPositive(e.quantity)," ")}}function ot(r,c){if(1&r&&(t.TgZ(0,"span",73),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit,n=t.oxw(3);t.xp6(1),t.hij(" ",n.toPositive(e.quantity)," ")}}function rt(r,c){if(1&r&&(t.TgZ(0,"tr",63),t.TgZ(1,"td",64),t._uU(2),t.qZA(),t.TgZ(3,"td",71),t._uU(4),t.qZA(),t.TgZ(5,"td",65),t.TgZ(6,"span",66),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"td",68),t.YNc(9,it,2,1,"span",69),t.qZA(),t.TgZ(10,"td",70),t.YNc(11,ot,2,1,"span",69),t.qZA(),t.TgZ(12,"td",73),t._uU(13),t.qZA(),t.qZA()),2&r){const e=c.$implicit,n=c.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(e.item_name),t.xp6(2),t.Q6J("ngClass",t.kEZ(7,v,"\u0645\u0628\u064a\u0639\u0627\u062a"===e.type,"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"===e.type,"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"===e.type)),t.xp6(1),t.hij(" ",e.type," "),t.xp6(2),t.Q6J("ngIf","\u0645\u0634\u062a\u0631\u064a\u0627\u062a"==e.type||"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==e.type&&+e.quantity<0),t.xp6(2),t.Q6J("ngIf","\u0645\u0628\u064a\u0639\u0627\u062a"==e.type||"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==e.type&&+e.quantity>0),t.xp6(2),t.Oqu(e.currenQty)}}function st(r,c){1&r&&(t.TgZ(0,"tr",77),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",78),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",78),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",78),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",78),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",78),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",78),t.qZA(),t.qZA())}function at(r,c){1&r&&(t.TgZ(0,"div",79),t._UZ(1,"ion-icon",80),t.TgZ(2,"h4"),t._uU(3,"\u0644\u0627 \u062a\u0648\u062c\u062f \u062d\u0631\u0643\u0627\u062a"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062d\u0631\u0643\u0627\u062a \u0641\u064a \u0647\u0630\u0627 \u0627\u0644\u062a\u0627\u0631\u064a\u062e"),t.qZA(),t.qZA())}function ct(r,c){if(1&r&&(t.TgZ(0,"ion-card",49),t.TgZ(1,"ion-card-header",50),t.TgZ(2,"ion-card-title",51),t._UZ(3,"ion-icon",81),t._uU(4," \u0627\u0644\u062d\u0631\u0643\u0629 \u0627\u0644\u064a\u0648\u0645\u064a\u0629 \u0644\u0644\u0623\u0635\u0646\u0627\u0641 "),t.YNc(5,nt,2,1,"span",53),t.qZA(),t.qZA(),t.TgZ(6,"ion-card-content",54),t.TgZ(7,"div",55),t.TgZ(8,"table",56),t.TgZ(9,"thead"),t.TgZ(10,"tr"),t.TgZ(11,"th"),t._uU(12,"\u0627\u0644\u062a\u0633\u0644\u0633\u0644"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"\u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"\u0646\u0648\u0639 \u0627\u0644\u062d\u0631\u0643\u0629"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0648\u0627\u0631\u062f\u0629"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u0635\u0627\u062f\u0631\u0629"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u062d\u0627\u0644\u064a\u0629"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"tbody"),t.YNc(24,rt,14,11,"tr",82),t.YNc(25,st,13,0,"tr",60),t.qZA(),t.qZA(),t.qZA(),t.YNc(26,at,6,0,"div",61),t.qZA(),t.qZA()),2&r){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf",e.payArrayDaily&&e.payArrayDaily.length>0),t.xp6(19),t.Q6J("ngForOf",e.payArrayDaily),t.xp6(1),t.Q6J("ngIf",e.loading),t.xp6(1),t.Q6J("ngIf",e.showEmpty&&!e.loading)}}function lt(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",18),t.TgZ(1,"div",19),t.TgZ(2,"ion-card",20),t.TgZ(3,"ion-card-content",21),t.TgZ(4,"div",22),t.TgZ(5,"div",23),t.TgZ(6,"app-enhanced-item-selector",24),t.NdJ("itemSelected",function(i){return t.CHM(e),t.oxw().onItemSelected(i)})("refreshRequested",function(){return t.CHM(e),t.oxw().onRefreshRequested()}),t.qZA(),t.qZA(),t.TgZ(7,"div",25),t.TgZ(8,"ion-label",26),t._uU(9,"\u0646\u0648\u0639 \u0627\u0644\u0628\u062d\u062b"),t.qZA(),t.TgZ(10,"ion-segment",27),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().radioVal=i})("ionChange",function(i){return t.CHM(e),t.oxw().radioChange(i)}),t.TgZ(11,"ion-segment-button",28),t.TgZ(12,"span"),t._uU(13,"\u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0631\u0643\u0627\u062a"),t.qZA(),t.qZA(),t.TgZ(14,"ion-segment-button",29),t.TgZ(15,"span"),t._uU(16,"\u0628\u062d\u062b \u0641\u064a \u062a\u0627\u0631\u064a\u062e \u0645\u062d\u062f\u062f"),t.qZA(),t.qZA(),t.TgZ(17,"ion-segment-button",30),t.TgZ(18,"span"),t._uU(19,"\u0628\u062d\u062b \u0641\u064a \u0641\u062a\u0631\u0629 \u0632\u0645\u0646\u064a\u0629"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",31),t.YNc(21,L,1,1,"ion-input",32),t.YNc(22,z,1,1,"ion-input",33),t.YNc(23,Y,1,1,"ion-input",34),t.TgZ(24,"ion-button",35),t.NdJ("click",function(){return t.CHM(e),t.oxw().search()}),t._UZ(25,"ion-icon",36),t._uU(26," \u0628\u062d\u062b "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(27,H,27,6,"ion-card",37),t.YNc(28,et,44,15,"ion-card",38),t.YNc(29,ct,27,4,"ion-card",38),t.qZA(),t.qZA()}if(2&r){const e=t.oxw();t.xp6(6),t.Q6J("placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u0635\u0646\u0641 \u0644\u0644\u062a\u0642\u0631\u064a\u0631")("searchLang",e.searchLang)("showQuantityDisplay",!1)("parentPage","items-report"),t.xp6(4),t.Q6J("ngModel",e.radioVal),t.xp6(11),t.Q6J("ngIf",1==e.radioVal||3==e.radioVal),t.xp6(1),t.Q6J("ngIf",2==e.radioVal),t.xp6(1),t.Q6J("ngIf",2==e.radioVal),t.xp6(4),t.Q6J("ngIf",e.selectedItemNew&&e.selectedItemNew.id&&3!=e.radioVal),t.xp6(1),t.Q6J("ngIf",3!=e.radioVal),t.xp6(1),t.Q6J("ngIf",3==e.radioVal)}}function dt(r,c){if(1&r&&(t.TgZ(0,"ion-footer",83),t.TgZ(1,"div",84),t.TgZ(2,"div",85),t.TgZ(3,"div",86),t._uU(4,"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0635\u0627\u062f\u0631:"),t.qZA(),t.TgZ(5,"div",87),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",85),t.TgZ(8,"div",86),t._uU(9,"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0648\u0627\u0631\u062f:"),t.qZA(),t.TgZ(10,"div",88),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r){const e=t.oxw();t.xp6(6),t.Oqu(e.selectedItemNew.totSales),t.xp6(5),t.Oqu(e.selectedItemNew.totPurch)}}const pt=[{path:"",component:(()=>{class r{constructor(e,n,i,o,l,u,a,g,m,O,T,A,_t){this.route=e,this.rout=n,this.renderer=i,this.modalController=o,this.alertController=l,this.authenticationService=u,this.storage=a,this.loadingController=g,this.datePipe=m,this.api=O,this.toast=T,this.sortingService=A,this.cdr=_t,this.searchResult=[],this.isOpen=!1,this.payArray=[],this.sortedPayArray=[],this.currentTransactionsSort=null,this.payArrayDaily=[],this.perchDetailsArr=[],this.payDetailsArr=[],this.tswiaDetailsArr=[],this.hasParameter=!1,this.searchTerm="",this.searchLang=0,this.sub_account1=[],this.sub_account2=[],this.sub_accountLocalSales=[],this.sub_accountLocalPurch=[],this.sub_accountSales=[],this.sub_accountPurch=[],this.items=[],this.itemsLocal=[],this.itemList=[],this.sortedItems=[],this.currentSort=null,this.salesLocal=[],this.loading=!1,this.sales=[],this.randomsNumber=[],this.sub_nameNew="",this.radioVal=0,this.printMode=!1,this.printArr=[],this.offline=!1,this.color="dark",this.showEmpty=!1,this.showError=!1,this.loadingItems=!1,this.qtyReal=0,this.availQty=0,this.currenQty=0,this.firstQty=0,this.perchTotQty=0,this.payTotQty=0,this.perchTot=0,this.payTot=0,this.totSales=0,this.totPurch=0,this.selectedItem={id:void 0,dateCreated:"",pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,availQty:0,firstQuantity:0,aliasEn:""},this.selectedItemNew={id:void 0,pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qtyReal:0,availQty:0,currenQty:0,firstQty:0,perchTotQty:0,payTotQty:0,totSales:0,totPurch:0};let D=new Date;this.startingDate=this.datePipe.transform(D,"yyyy-MM-dd"),this.endDate=this.datePipe.transform(D,"yyyy-MM-dd")}changeMode(){1==this.offline?(this.offline=!1,this.color="primary"):0==this.offline&&(this.offline=!0,this.color="dark"),this.storage.set("offline",this.offline).then(e=>{})}ionViewDidEnter(){this.route.queryParams.subscribe(e=>{if(e.item)try{const n=JSON.parse(e.item);return void this.handleItemFromNavigation(n)}catch(n){console.error("Error parsing item parameter:",n)}}),this.selectedItem.id&&(console.log("ionViewDidEnter",this.selectedItem.id),this.search())}ngOnInit(){this.route.queryParams.subscribe(e=>{Object.keys(e).length>0&&(this.hasParameter=!0)}),this.prepareOffline(),this.getAppInfo(),this.route.queryParams.subscribe(e=>{if(e.item)try{console.log("item param",e.item);const n=JSON.parse(e.item);this.handleItemFromNavigation(n)}catch(n){console.error("Error parsing item parameter:",n)}})}handleItemFromNavigation(e){setTimeout(()=>{this.items&&this.items.length>0?(this.selectFromPop(e),this.search()):setTimeout(()=>{this.items&&this.items.length>0&&(this.selectFromPop(e),this.search())},2e3)},1e3)}readItemByIdQty(){var e;!(null===(e=this.selectedItem)||void 0===e?void 0:e.id)||this.api.readItemByIdQty(this.store_info.id,this.selectedItem.id,this.year.id).subscribe(n=>{console.log("readItemByIdQty",n);let i=n.data[0];i&&"No record Found"!=i.message&&(this.payTotQty=i.salesQuantity,this.availQty=i.availQty,this.qtyReal=i.qtyReal,this.perchTotQty=i.perchQuantity,this.firstQty=i.firstQuantity,console.log("readItemByIdQty",this.payTotQty,this.availQty,this.qtyReal,this.perchTotQty,this.firstQty),this.selectedItemNew={id:i.id,pay_ref:"",item_desc:i.item_desc||"",item_name:i.item_name||"",item_unit:i.item_unit||"",parcode:i.item_parcode||0,pay_price:i.pay_price||0,perch_price:i.perch_price||0,qtyReal:i.qtyReal||0,availQty:i.availQty||0,firstQty:i.firstQuantity||0,perchTotQty:i.perchQuantity||0,payTotQty:i.salesQuantity||0,totSales:i.sales28||0,totPurch:i.purch28||0,currenQty:0},this.getQtyTotalItemId())},n=>{console.log(n),this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649","danger")},()=>{})}getQtyTotalItemId(){+this.selectedItemNew.availQty-+this.selectedItemNew.qtyReal<0?this.selectedItemNew.perchTotQty=+this.selectedItemNew.perchTotQty+Math.abs(+this.selectedItemNew.availQty-+this.selectedItemNew.qtyReal):+this.selectedItemNew.availQty-+this.selectedItemNew.qtyReal>0&&(this.selectedItemNew.payTotQty=+this.selectedItemNew.availQty-+this.selectedItemNew.qtyReal+ +this.selectedItemNew.payTotQty),this.selectedItemNew.availQty=+this.selectedItemNew.firstQty+ +this.selectedItemNew.perchTotQty-+this.selectedItemNew.payTotQty,console.log(this.selectedItemNew.availQty)}performSync(){return(0,d.mG)(this,void 0,void 0,function*(){yield this.getAllStockItemsWithouteCounts()})}getItemLocalOff(){this.storage.get("itemsLocal").then(e=>{e&&(this.itemsLocal=e,this.items=this.itemsLocal,this.searchResult=this.items)})}getAllStockItemsWithouteCounts(){this.storage.get("year").then(e=>{e&&(this.year=e,0==this.offline?this.api.getAllStockItemsWithouteCounts(1,this.year.id).subscribe(n=>{this.items=n.data,this.applySorting(),this.loadingItems=!1,this.storage.set("itemsLocal",this.items).then(o=>{})},n=>{this.loadingItems=!1},()=>{this.loadingItems=!1}):(this.items=this.itemsLocal,this.applySorting(),this.searchResult=this.items))})}getStockItems(){this.loadingItems=!0,this.storage.get("year").then(e=>{e&&(this.year=e,0==this.offline?this.api.stockItems(1,this.year.id).subscribe(n=>{this.items=n.data,this.items.forEach(o=>{+o.tswiaQuantity>0?o.salesQuantity=+o.salesQuantity+ +o.tswiaQuantity:+o.tswiaQuantity<0&&(o.perchQuantity=+o.perchQuantity+Math.abs(+o.tswiaQuantity)),o.quantity=+o.perchQuantity+ +o.firstQuantity-+o.salesQuantity,o.availQty=+o.quantity})},n=>{this.loadingItems=!1},()=>{this.loadingItems=!1}):(this.items=this.itemsLocal,this.items.forEach(n=>{+n.tswiaQuantity>0?n.salesQuantity=+n.salesQuantity+ +n.tswiaQuantity:+n.tswiaQuantity<0&&(n.perchQuantity=+n.perchQuantity+Math.abs(+n.tswiaQuantity)),n.quantity=+n.perchQuantity+ +n.firstQuantity-+n.salesQuantity,n.availQty=+n.quantity})))})}getOffliemode(){this.storage.get("offline").then(e=>{this.offline=e,this.color=1==this.offline?"dark":"primary"})}getAppInfo(){this.getOffliemode(),this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("year").then(e=>{e&&(this.year=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.getSalesAccount(),this.getItemLocalOff())}),this.storage.get("searchLang").then(e=>{e&&(this.searchLang=e)})}getSalesAccount(){0==this.offline?this.api.getSalesAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_account1=e.data,this.addSubaccountLocal()},e=>{}):this.MixSubaccountSalesOffline()}addSubaccountLocal(){if(this.sub_account1){if(this.sub_accountLocalSales)for(let e=0;e<this.sub_accountLocalSales.length;e++)this.sub_account1.push(this.sub_accountLocalSales[e])}else this.sub_accountLocalSales&&(this.sub_account1=this.sub_accountLocalSales)}MixSubaccountSalesOffline(){if(this.sub_account1=[],this.sub_accountLocalSales)for(let e=0;e<this.sub_accountLocalSales.length;e++)this.sub_account1.push(this.sub_accountLocalSales[e]);if(this.sub_accountSales)for(let e=0;e<this.sub_accountSales.length;e++)this.sub_account1.push(this.sub_accountSales[e])}getPurchAccount(){0==this.offline?this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_account1=e.data,this.addSubaccountLocalPurch()},e=>{}):this.MixSubaccountPurchOffline()}addSubaccountLocalPurch(){if(this.sub_account2){if(this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account2.push(this.sub_accountLocalPurch[e])}else this.sub_accountLocalPurch&&(this.sub_account2=this.sub_accountLocalPurch)}MixSubaccountPurchOffline(){if(this.sub_account2=[],this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account2.push(this.sub_accountLocalPurch[e]);if(this.sub_accountPurch)for(let e=0;e<this.sub_accountPurch.length;e++)this.sub_account1.push(this.sub_accountPurch[e])}prepareOffline(){this.storage.get("salesLocal").then(e=>{e&&(this.salesLocal=e)}),this.storage.get("sales").then(e=>{e&&(this.sales=e)}),this.storage.get("itemsLocal").then(e=>{e&&(this.itemsLocal=e,this.items=this.itemsLocal)}),this.storage.get("sub_accountLocalSales").then(e=>{e&&(this.sub_accountLocalSales=e)}),this.storage.get("sub_accountSales").then(e=>{e&&(this.sub_accountSales=e)})}radioChange(e){}presentToast(e,n){return(0,d.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:e,duration:2e3,color:n,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}setFocusOnInput(e){"dst"==e?this.nameField.nativeElement.focus():"dstPop"==e?(this.dstPop.setFocus(),this.isOpen=!0,this.clear(),this.searchResult=this.items,setTimeout(()=>{this.popInput.setFocus()},1500)):"popInput"==e&&this.popInput.setFocus()}clear(e){e?this.selectedItem={id:void 0,dateCreated:"",pay_ref:this.payInvo.pay_ref,item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,availQty:0,firstQuantity:0,aliasEn:""}:this.searchTerm=""}presentPopover(e){this.popover.event=e,this.isOpen=!0,this.clear(),this.searchResult=this.items,setTimeout(()=>{this.setFocusOnInput("popInput")},2e3)}searchItem(e){this.searchResult=[];let i=(new p.g).transform(this.items,e.target.value);i.length>0&&i.forEach(o=>{this.searchResult.push(o)})}didDissmis(){this.isOpen=!1,this.readItemByIdQty(),this.setFocusOnInput("qtyId")}pickDetail(e){this.readItemByIdQty();let n=[];n=this.items.filter(1==this.searchLang?i=>i.item_desc==e.target.value:i=>i.item_name==e.target.value),this.selectedItem={id:n[0].id,dateCreated:n[0].dateCreated,pay_ref:"",item_desc:n[0].item_desc,item_name:n[0].item_name,item_unit:n[0].item_unit,parcode:n[0].parcode,pay_price:n[0].pay_price,perch_price:n[0].perch_price,qty:0,tot:n[0].pay_price,availQty:+n[0].availQty,firstQuantity:n[0].firstQuantity,aliasEn:n[0].aliasEn}}selectFromPop(e){this.readItemByIdQty(),this.selectedItem={id:e.id,dateCreated:e.dateCreated,pay_ref:"",item_desc:e.item_desc,item_name:e.item_name,item_unit:e.item_unit,parcode:e.parcode,pay_price:e.pay_price,perch_price:e.perch_price,qty:"",tot:e.pay_price,availQty:e.quantity,aliasEn:e.aliasEn,firstQuantity:e.firstQuantity},this.searchTerm=e.item_name,this.didDissmis()}presentLoadingWithOptions(e){return(0,d.mG)(this,void 0,void 0,function*(){const n=yield this.loadingController.create({spinner:"bubbles",mode:"ios",duration:3e3,message:e,translucent:!0,backdropDismiss:!1});yield n.present(),yield n.onDidDismiss()})}getPayInvoDetail(e,n,i){console.log(e,n,i),this.presentLoadingWithOptions("\u062c\u0627\u0631\u064a \u062c\u0644\u0628 \u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644 ...");let l={pay_id:e.pay_id,pay_ref:e.pay_ref,store_id:e.store_id,tot_pr:e.tot_pr,pay:e.pay,pay_date:e.pay_date,pay_time:e.pay_time,user_id:e.user_id,cust_id:e.cust_id,pay_method:e.pay_method,discount:e.discount,changee:e.changee,sub_name:e.sub_name,yearId:e.yearId,payComment:e.payComment,nextPay:e.payComment},u={pay_id:e.pay_id,pay_ref:e.pay_ref,store_id:e.store_id,tot_pr:e.tot_pr,pay_date:e.pay_date,pay_time:e.pay_time,user_id:e.user_id,yearId:e.yearId,payComment:e.payComment};"\u0645\u0628\u064a\u0639\u0627\u062a"==e.type?this.api.getPayInvoDetail(this.store_info.id,e.pay_ref,this.year.id).subscribe(a=>{let g=a;this.loadingController.dismiss();let m={queryParams:{payInvo:JSON.stringify(l),sub_name:JSON.stringify(n),user_info:JSON.stringify(this.user_info),store_info:JSON.stringify(this.store_info),itemList:JSON.stringify(g.data),screen:"itemReport"}};this.rout.navigate(["folder/edit-sales"],m)},a=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")}):"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"==e.type?this.api.getPerchInvoDetail(this.store_info.id,e.pay_ref,this.year.id).subscribe(a=>{let g=a;this.loadingController.dismiss();let m={queryParams:{payInvo:JSON.stringify(l),sub_name:JSON.stringify(n),user_info:JSON.stringify(this.user_info),store_info:JSON.stringify(this.store_info),itemList:JSON.stringify(g.data),screen:"itemReport"}};this.rout.navigate(["folder/edit-perch"],m)},a=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")}):"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==e.type&&this.api.getTswiaInvoDetail(this.store_info.id,e.pay_ref,this.year.id).subscribe(a=>{let g=a;this.loadingController.dismiss();let m={queryParams:{payInvo:JSON.stringify(u),user_info:JSON.stringify(this.user_info),store_info:JSON.stringify(this.store_info),itemList:JSON.stringify(g.data),screen:"itemReport"}};this.rout.navigate(["folder/edit-tswia"],m)},a=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")})}getItemPaysByItemIdBydate(){this.loading=!0,this.api.getItemPaysByItemIdBydate(this.store_info.id,this.selectedItem.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.payDetailsArr=e.data,this.payDetailsArr=this.payDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.payDetailsArr.length;i++)this.payDetailsArr[i].type="\u0645\u0628\u064a\u0639\u0627\u062a"}this.getItemPurchsByItemIdBydate()},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemPaysBydate(){this.loading=!0,this.api.getItemPaysBydate(this.store_info.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.payDetailsArr=e.data,this.payDetailsArr=this.payDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.payDetailsArr.length;i++)this.payDetailsArr[i].type="\u0645\u0628\u064a\u0639\u0627\u062a"}this.getItemPurchsBydate()},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemPaysByItemId(){this.loading=!0,this.api.getItemPaysByItemId(this.store_info.id,this.selectedItem.id,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.payDetailsArr=e.data,this.payDetailsArr=this.payDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.payDetailsArr.length;i++)this.payDetailsArr[i].type="\u0645\u0628\u064a\u0639\u0627\u062a"}this.getItemPurchByItemId()},e=>{this.presentToast("1\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger"),this.loading=!1},()=>{})}getItemPaysByItemIdBy2date(){this.loading=!0,this.api.getItemPaysByItemIdBy2date(this.store_info.id,this.selectedItem.id,this.startingDate,this.endDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.payDetailsArr=e.data,this.payDetailsArr=this.payDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.payDetailsArr.length;i++)this.payDetailsArr[i].type="\u0645\u0628\u064a\u0639\u0627\u062a"}this.getItemPurchByItemIdBy2date()},e=>{this.loading=!1,this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemPurchsBydate(){this.perchDetailsArr=[],this.loading=!0,this.api.getItemPurchsBydate(this.store_info.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.perchDetailsArr=e.data,this.perchDetailsArr=this.perchDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.perchDetailsArr.length;i++)this.perchDetailsArr[i].type="\u0645\u0634\u062a\u0631\u064a\u0627\u062a"}this.getItemTswiasBydate()},e=>{this.loading=!1,this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemPurchsByItemIdBydate(){this.perchDetailsArr=[],this.loading=!0,this.api.getItemPurchsByItemIdBydate(this.store_info.id,this.selectedItem.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.perchDetailsArr=e.data,this.perchDetailsArr=this.perchDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.perchDetailsArr.length;i++)this.perchDetailsArr[i].type="\u0645\u0634\u062a\u0631\u064a\u0627\u062a"}this.getItemTswiasByItemIdBydate()},e=>{this.loading=!1,this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemTswiasByItemIdBydate(){this.perchDetailsArr=[],this.loading=!0,this.api.getItemTswiasByItemIdBydate(this.store_info.id,this.selectedItem.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.tswiaDetailsArr=e.data,this.tswiaDetailsArr=this.tswiaDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.perchDetailsArr.length;i++)this.perchDetailsArr[i].type="\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"}this.mixArrayAndOrderong(),this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1},e=>{this.loading=!1,this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemTswiasBydate(){this.perchDetailsArr=[],this.loading=!0,this.api.getItemTswiasBydate(this.store_info.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.tswiaDetailsArr=e.data,this.tswiaDetailsArr=this.tswiaDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.perchDetailsArr.length;i++)this.perchDetailsArr[i].type="\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"}this.mixArrayAndOrderongCaseDaily(),this.showEmpty=0==this.payArrayDaily.length,this.loading=!1},e=>{this.loading=!1,this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemPurchByItemId(){this.perchDetailsArr=[],this.loading=!0,this.api.getItemPurchByItemId(this.store_info.id,this.selectedItem.id,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.perchDetailsArr=e.data,this.perchDetailsArr=this.perchDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.perchDetailsArr.length;i++)this.perchDetailsArr[i].type="\u0645\u0634\u062a\u0631\u064a\u0627\u062a"}this.getItemTswiaByItemId()},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}getItemTswiaByItemId(){this.tswiaDetailsArr=[],this.loading=!0,this.api.getItemTswiaByItemId(this.store_info.id,this.selectedItem.id,this.year.id).subscribe(e=>{if("No record Found"!=e.message){this.tswiaDetailsArr=e.data,this.tswiaDetailsArr=this.tswiaDetailsArr.filter(i=>i.pay_date>="2023-01-01");for(let i=0;i<this.tswiaDetailsArr.length;i++)this.tswiaDetailsArr[i].type="\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"}this.mixArrayAndOrderong(),this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{this.loading=!1})}toPositive(e){return Math.abs(+e)}getItemPurchByItemIdBy2date(){this.loading=!0,this.api.getItemPurchByItemIdBy2date(this.store_info.id,this.selectedItem.id,this.startingDate,this.endDate,this.year.id).subscribe(e=>{"No record Found"!=e.message&&(this.perchDetailsArr=e.data,this.perchDetailsArr=this.perchDetailsArr.filter(i=>i.pay_date>="2023-01-01")),this.getItemTswiaByItemIdBy2date()},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger"),this.loading=!1},()=>{this.loading=!1})}getItemTswiaByItemIdBy2date(){this.loading=!0,this.api.getItemTswiaByItemIdBy2date(this.store_info.id,this.selectedItem.id,this.startingDate,this.endDate,this.year.id).subscribe(e=>{"No record Found"!=e.message&&(this.tswiaDetailsArr=e.data,this.tswiaDetailsArr=this.tswiaDetailsArr.filter(i=>i.pay_date>="2023-01-01")),this.mixArrayAndOrderong(),this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1},e=>{this.presentToast("  \u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger"),this.loading=!1},()=>{this.loading=!1})}mixArrayAndOrderong(){if(this.payArray=[],console.log("Starting mixArrayAndOrderong - clearing payArray"),console.log("Data arrays lengths - perch:",this.perchDetailsArr.length,"pay:",this.payDetailsArr.length,"tswia:",this.tswiaDetailsArr.length),this.perchDetailsArr.length>0)for(let e=0;e<this.perchDetailsArr.length;e++){const n=this.perchDetailsArr[e];+n.discount>0&&(n.perch_price=(n.perch_price-n.perch_price*(+n.discount/+n.tot_pr)).toFixed(2)),this.payArray.push(n)}if(this.payDetailsArr.length>0)for(let e=0;e<this.payDetailsArr.length;e++){const n=this.payDetailsArr[e];+n.discount>0&&(n.pay_price=(n.pay_price-n.pay_price*(+n.discount/+n.tot_pr)).toFixed(2)),this.payArray.push(n)}if(this.tswiaDetailsArr.length>0)for(let e=0;e<this.tswiaDetailsArr.length;e++){const n=this.tswiaDetailsArr[e];this.payArray.push({id:n.id,pay_ref:n.pay_ref,item_name:n.item_name,pay_date:n.pay_date,pay_price:n.pay_price,quantity:+n.availQty-+n.qtyReal,tot:+n.tot,store_id:+this.store_info.id,yearId:+this.year.id,item_id:+n.id,dateCreated:n.dateCreated,perch_price:n.perch_price,type:n.type})}this.payArray=this.payArray.sort((e,n)=>e.pay_date>n.pay_date?-1:1),this.applyTransactionsSorting(),console.log("Finished mixArrayAndOrderong - payArray length:",this.payArray.length)}mixArrayAndOrderongCaseDaily(){if(this.payArrayDaily=[],this.perchDetailsArr.length>0)for(let e=0;e<this.perchDetailsArr.length;e++){const n=this.perchDetailsArr[e];let i=this.items.findIndex(l=>l.item_id==n.item_id);n.currenQty=this.items[i].quantity;let o=this.payArrayDaily.findIndex(l=>l.item_id==n.item_id&&"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"==n.type);-1!=o?n.quantity=+n.quantity+ +this.payArrayDaily[o].quantity:this.payArrayDaily.push(n)}if(this.payDetailsArr.length>0)for(let e=0;e<this.payDetailsArr.length;e++){const n=this.payDetailsArr[e];let i=this.items.findIndex(l=>l.id==n.item_id);n.currenQty=this.items[i].quantity;let o=this.payArrayDaily.findIndex(l=>l.item_id==n.item_id&&"\u0645\u0628\u064a\u0639\u0627\u062a"==n.type);-1!=o?n.quantity=+n.quantity+ +this.payArrayDaily[o].quantity:this.payArrayDaily.push(n)}if(this.tswiaDetailsArr.length>0)for(let e=0;e<this.tswiaDetailsArr.length;e++){const n=this.tswiaDetailsArr[e];let i=+n.availQty-+n.qtyReal,o=this.items.findIndex(u=>u.item_id==n.item_id);n.currenQty=this.items[o].quantity;let l=this.payArrayDaily.findIndex(u=>u.item_id==n.item_id&&"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"==n.type);-1!=l?n.quantity=+n.quantity+ +this.payArrayDaily[l].quantity:this.payArrayDaily.push({id:n.id,pay_ref:n.pay_ref,item_name:n.item_name,pay_date:n.pay_date,pay_price:n.pay_price,quantity:i,tot:+n.tot,store_id:+this.store_info.id,yearId:+this.year.id,item_id:+n.id,dateCreated:n.dateCreated,perch_price:n.perch_price,type:n.type})}}getTotal(){if(this.currenQty=this.selectedItem.availQty,this.firstQty=this.selectedItem.firstQuantity,this.perchTotQty=this.perchDetailsArr.reduce((e,n)=>e+ +n.quantity,0),this.payTotQty=this.payDetailsArr.reduce((e,n)=>e+ +n.quantity,0),this.perchTot=this.perchDetailsArr.reduce((e,n)=>e+ +n.tot,0).toFixed(2),this.payTot=this.payDetailsArr.reduce((e,n)=>e+ +n.tot,0).toFixed(2),this.tswiaDetailsArr.length>0)for(let e=0;e<this.tswiaDetailsArr.length;e++){const n=this.tswiaDetailsArr[e];+n.availQty-+n.qtyReal<0?this.perchTotQty=+this.perchTotQty+Math.abs(+n.availQty-+n.qtyReal):+n.availQty-+n.qtyReal>0&&(this.payTotQty=+n.availQty-+n.qtyReal+ +this.payTotQty)}}onItemSelected(e){console.log("Item selected from enhanced component:",e),e&&e.id?(this.selectedItem={id:e.id,dateCreated:e.dateCreated||"",pay_ref:e.pay_ref||"",item_desc:e.item_desc||"",item_name:e.item_name||"",item_unit:e.item_unit||"",parcode:e.parcode||0,pay_price:e.pay_price||0,perch_price:e.perch_price||0,qty:e.qty||0,tot:e.tot||0,availQty:e.availQty||0,firstQuantity:e.firstQuantity||0,aliasEn:e.aliasEn||""},this.search()):this.clearItemSelection()}onRefreshRequested(){console.log("Refresh requested from enhanced component")}refresh(){this.presentToast("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a","success"),window.location.reload()}clearItemSelection(){this.selectedItem={id:void 0,dateCreated:"",pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qty:0,tot:0,availQty:0,firstQuantity:0,aliasEn:""},this.selectedItemNew={id:void 0,pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qtyReal:0,availQty:0,currenQty:0,firstQty:0,perchTotQty:0,payTotQty:0,totSales:0,totPurch:0},this.payArray=[],this.perchDetailsArr=[],this.payDetailsArr=[],this.showEmpty=!1}search(){var e;if(!(null===(e=this.selectedItem)||void 0===e?void 0:e.id))return void this.presentToast("\u064a\u0631\u062c\u0649 \u0627\u062e\u062a\u064a\u0627\u0631 \u0635\u0646\u0641 \u0623\u0648\u0644\u0627\u064b","warning");this.selectedItemNew={id:void 0,pay_ref:"",item_desc:"",item_name:"",item_unit:"",parcode:0,pay_price:0,perch_price:0,qtyReal:0,availQty:0,currenQty:0,firstQty:0,perchTotQty:0,payTotQty:0,totSales:0,totPurch:0},this.payArray=[],this.sortedPayArray=[],this.perchDetailsArr=[],this.payDetailsArr=[],this.tswiaDetailsArr=[],this.currentTransactionsSort=null,this.showEmpty=!1,this.loading=!0;let i=null,o=null;1==this.radioVal?i=this.startingDate:2==this.radioVal?(i=this.startingDate,o=this.endDate):3==this.radioVal&&(i=this.startingDate),this.api.getCompleteItemReport(this.store_info.id,this.selectedItem.id,this.year.id,this.radioVal,i,o).subscribe(l=>{if(console.log("Complete item report data:",l),l&&"success"===l.status&&l.data){const u=l.data;if(u.item_details){const a=u.item_details;this.selectedItemNew={id:a.id,pay_ref:"",item_desc:a.item_desc||"",item_name:a.item_name||"",item_unit:a.item_unit||"",parcode:a.item_parcode||0,pay_price:a.pay_price||0,perch_price:a.perch_price||0,qtyReal:a.qtyReal||0,availQty:a.availQty||0,currenQty:a.availQty||0,firstQty:a.firstQuantity||0,perchTotQty:a.perchQuantity||0,payTotQty:a.salesQuantity||0,totSales:a.sales28||0,totPurch:a.purch28||0},this.payTotQty=a.salesQuantity||0,this.availQty=a.availQty||0,this.qtyReal=a.qtyReal||0,this.perchTotQty=a.perchQuantity||0,this.firstQty=a.firstQuantity||0}u.sales_invoices&&u.sales_invoices.length>0?(this.payDetailsArr=u.sales_invoices.map(a=>Object.assign(Object.assign({},a),{type:"\u0645\u0628\u064a\u0639\u0627\u062a"})),console.log("Loaded sales invoices:",this.payDetailsArr.length)):(this.payDetailsArr=[],console.log("No sales invoices found")),u.purchase_invoices&&u.purchase_invoices.length>0?(this.perchDetailsArr=u.purchase_invoices.map(a=>Object.assign(Object.assign({},a),{type:"\u0645\u0634\u062a\u0631\u064a\u0627\u062a"})),console.log("Loaded purchase invoices:",this.perchDetailsArr.length)):(this.perchDetailsArr=[],console.log("No purchase invoices found")),u.adjustment_records&&u.adjustment_records.length>0?(this.tswiaDetailsArr=u.adjustment_records.map(a=>Object.assign(Object.assign({},a),{type:"\u062a\u0633\u0648\u064a\u0629 \u062c\u0631\u062f\u064a\u0629"})),console.log("Loaded adjustment records:",this.tswiaDetailsArr.length)):(this.tswiaDetailsArr=[],console.log("No adjustment records found")),3==this.radioVal?(this.mixArrayAndOrderongCaseDaily(),this.showEmpty=0==this.payArrayDaily.length):(this.mixArrayAndOrderong(),this.getTotal(),console.log("After processing - payArray length:",this.payArray.length),console.log("After processing - sortedPayArray length:",this.sortedPayArray.length),this.showEmpty=0==this.payArray.length),console.log("Report processed successfully")}else this.showEmpty=!0,this.presentToast("\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u0635\u0646\u0641 \u0627\u0644\u0645\u062d\u062f\u062f","warning")},l=>{console.error("Error fetching complete item report:",l),this.loading=!1,this.showEmpty=!0,this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649","danger")},()=>{this.loading=!1})}applyTransactionsSorting(){this.sortedPayArray=this.currentTransactionsSort?this.sortingService.sortData([...this.payArray],this.currentTransactionsSort.column,this.currentTransactionsSort.direction):[...this.payArray],console.log("Applied transaction sorting, sortedPayArray length:",this.sortedPayArray.length)}sortTransactionsBy(e){const n=this.sortingService.getNextSortDirection(e,this.currentTransactionsSort);this.currentTransactionsSort={column:e,direction:n},this.applyTransactionsSorting()}getTransactionsSortIcon(e){return this.sortingService.getSortIcon(e,this.currentTransactionsSort)}applySorting(){this.sortedItems=this.currentSort?this.sortingService.sortData(this.items,this.currentSort.column,this.currentSort.direction):[...this.items]}sortBy(e){const n=this.sortingService.getNextSortDirection(e,this.currentSort);this.currentSort={column:e,direction:n},this.applySorting()}getSortIcon(e){return this.sortingService.getSortIcon(e,this.currentSort)}trackByPaymentId(e,n){return n.pay_ref||n.id||e}get displayedPayArray(){return this.sortedPayArray&&this.sortedPayArray.length>0?this.sortedPayArray:this.payArray}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(y.gz),t.Y36(y.F0),t.Y36(t.Qsj),t.Y36(s.IN),t.Y36(s.Br),t.Y36(C.u),t.Y36(M.K),t.Y36(s.HT),t.Y36(_.uU),t.Y36(I.r),t.Y36(s.yF),t.Y36(w.$),t.Y36(t.sBO))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-items-report"]],viewQuery:function(e,n){if(1&e&&(t.Gf(k,5),t.Gf(E,5),t.Gf(N,5),t.Gf(R,5),t.Gf(U,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.nameField=i.first),t.iGM(i=t.CRH())&&(n.qtyId=i.first),t.iGM(i=t.CRH())&&(n.dstPop=i.first),t.iGM(i=t.CRH())&&(n.popInput=i.first),t.iGM(i=t.CRH())&&(n.popover=i.first)}},decls:14,vars:5,consts:[[1,"transparent-header"],[1,"transparent-toolbar"],["slot","start"],["defaultHref","/","class","glass-menu-button",4,"ngIf"],["class","glass-menu-button",4,"ngIf"],[1,"glass-title"],["slot","end"],["fill","clear",3,"click"],["name","refresh-outline"],[1,"modern-content"],["class","loading-container",4,"ngIf"],["class","main-container",4,"ngIf"],["class","totals-footer",4,"ngIf"],["defaultHref","/",1,"glass-menu-button"],[1,"glass-menu-button"],[1,"loading-container"],["name","crescent"],[1,"loading-text"],[1,"main-container"],[1,"form-container"],[1,"form-card","compact-card"],[1,"compact-content"],[1,"main-row"],[1,"item-section"],[3,"placeholder","searchLang","showQuantityDisplay","parentPage","itemSelected","refreshRequested"],[1,"search-type-section"],[1,"field-label"],[1,"compact-segment",3,"ngModel","ngModelChange","ionChange"],["value","0"],["value","1"],["value","2"],[1,"search-row"],["type","date","class","mini-input date-input",3,"ngModel","ngModelChange",4,"ngIf"],["type","date","placeholder","\u0645\u0646 \u062a\u0627\u0631\u064a\u062e","class","mini-input date-input",3,"ngModel","ngModelChange",4,"ngIf"],["type","date","placeholder","\u0625\u0644\u0649 \u062a\u0627\u0631\u064a\u062e","class","mini-input date-input",3,"ngModel","ngModelChange",4,"ngIf"],["fill","outline",1,"mini-btn","search-btn",3,"click"],["name","search-outline","slot","start"],["class","info-card",4,"ngIf"],["class","table-card","color","primary",4,"ngIf"],["type","date",1,"mini-input","date-input",3,"ngModel","ngModelChange"],["type","date","placeholder","\u0645\u0646 \u062a\u0627\u0631\u064a\u062e",1,"mini-input","date-input",3,"ngModel","ngModelChange"],["type","date","placeholder","\u0625\u0644\u0649 \u062a\u0627\u0631\u064a\u062e",1,"mini-input","date-input",3,"ngModel","ngModelChange"],[1,"info-card"],[1,"info-content"],[1,"info-grid"],[1,"info-column"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["color","primary",1,"table-card"],[1,"table-header"],[1,"table-title"],["name","list-outline","slot","start"],["class","transaction-count",4,"ngIf"],[1,"table-content"],[1,"table-container"],[1,"modern-table"],[1,"sortable-header",3,"click"],[1,"sort-icon",3,"name"],["class","table-row",4,"ngFor","ngForOf","ngForTrackBy"],["class","skeleton-row",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"transaction-count"],[1,"table-row"],[1,"serial"],[1,"type"],[1,"transaction-type",3,"ngClass"],[1,"date"],[1,"debit"],["class","amount",4,"ngIf"],[1,"credit"],[1,"details"],[4,"ngIf"],[1,"amount"],[1,"actions"],["fill","clear","size","small",3,"click"],["name","eye-outline","color","primary"],[1,"skeleton-row"],["animated","",2,"width","100%"],[1,"empty-state"],["name","archive-outline",1,"empty-icon"],["name","calendar-outline","slot","start"],["class","table-row",4,"ngFor","ngForOf"],[1,"totals-footer"],[1,"totals-container"],[1,"total-item"],[1,"total-label"],[1,"total-value","debit-total"],[1,"total-value","credit-total"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-buttons",2),t.YNc(3,F,1,0,"ion-back-button",3),t.YNc(4,B,1,0,"ion-menu-button",4),t.qZA(),t.TgZ(5,"ion-title",5),t._uU(6,"\u062a\u0642\u0631\u064a\u0631 \u062d\u0631\u0643\u0629 \u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.TgZ(7,"ion-buttons",6),t.TgZ(8,"ion-button",7),t.NdJ("click",function(){return n.refresh()}),t._UZ(9,"ion-icon",8),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"ion-content",9),t.YNc(11,J,4,0,"div",10),t.YNc(12,lt,30,11,"div",11),t.qZA(),t.YNc(13,dt,12,2,"ion-footer",12)),2&e&&(t.xp6(3),t.Q6J("ngIf",n.hasParameter),t.xp6(1),t.Q6J("ngIf",!n.hasParameter),t.xp6(7),t.Q6J("ngIf",!n.user_info||!n.store_info),t.xp6(1),t.Q6J("ngIf",n.user_info&&n.store_info),t.xp6(1),t.Q6J("ngIf",n.selectedItemNew&&n.selectedItemNew.id&&3!=n.radioVal))},directives:[s.Gu,s.sr,s.Sm,_.O5,s.wd,s.YG,s.gu,s.W2,s.oU,s.cs,s.fG,s.PQ,s.PM,s.FN,Q,s.Q$,s.cJ,s.QI,f.JJ,f.On,s.GO,s.pK,s.j9,s.Zi,s.Dq,_.sg,_.mk,s.CK,s.fr],pipes:[_.uU],styles:['.modern-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, rgba(255, 255, 255, .1), rgba(255, 255, 255, .05) );--color: var(--ion-color-dark);min-height:100vh;padding:8px 8px 100px;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);--overflow: visible}.modern-content[_ngcontent-%COMP%]:before{content:"";position:fixed;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,rgba(74,144,226,.1),rgba(80,227,194,.1),rgba(245,166,35,.1));animation:gradientShift 15s ease infinite;z-index:-1}@keyframes gradientShift{0%,to{background:linear-gradient(45deg,rgba(74,144,226,.1),rgba(80,227,194,.1),rgba(245,166,35,.1))}50%{background:linear-gradient(225deg,rgba(245,166,35,.1),rgba(74,144,226,.1),rgba(80,227,194,.1))}}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:16px}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:48px;height:48px;--color: var(--ion-color-primary)}.loading-container[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:14px;margin:0}.main-container[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto}.form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;padding-bottom:80px}.form-card[_ngcontent-%COMP%], .info-card[_ngcontent-%COMP%], .table-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:20px;box-shadow:0 8px 32px #0000001a,inset 0 1px #fff3;margin:0;overflow:visible;transition:all .3s cubic-bezier(.4,0,.2,1)}.form-card[_ngcontent-%COMP%]:hover, .info-card[_ngcontent-%COMP%]:hover, .table-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 48px #00000026,inset 0 1px #ffffff4d}.form-card.compact-card[_ngcontent-%COMP%], .info-card.compact-card[_ngcontent-%COMP%], .table-card.compact-card[_ngcontent-%COMP%]{border-radius:12px}.form-card.compact-card[_ngcontent-%COMP%]   .compact-content[_ngcontent-%COMP%], .info-card.compact-card[_ngcontent-%COMP%]   .compact-content[_ngcontent-%COMP%], .table-card.compact-card[_ngcontent-%COMP%]   .compact-content[_ngcontent-%COMP%]{padding:12px 16px}.form-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%], .info-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%], .table-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%]{position:relative;z-index:10000}.form-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%], .info-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%], .table-card.compact-card[_ngcontent-%COMP%]   app-enhanced-item-selector[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{z-index:999999!important;position:absolute!important}.table-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(74,144,226,.1),rgba(80,227,194,.1));border-bottom:1px solid rgba(255,255,255,.1);padding:20px}.table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--ion-color-dark);margin:0}.table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{font-size:14px;color:var(--ion-color-medium);font-weight:400}.compact-content[_ngcontent-%COMP%], .info-content[_ngcontent-%COMP%], .table-content[_ngcontent-%COMP%]{padding:20px}.table-content[_ngcontent-%COMP%]{padding-bottom:30px}.compact-content[_ngcontent-%COMP%]{padding:10px 16px}.main-row[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-end;margin-bottom:16px}.item-section[_ngcontent-%COMP%], .search-type-section[_ngcontent-%COMP%]{flex:1;width:50%}.field-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:var(--ion-color-dark);margin-bottom:6px}.compact-segment[_ngcontent-%COMP%]{border-radius:12px;background:rgba(255,255,255,.8);border:1px solid rgba(0,0,0,.1);overflow:hidden;min-height:48px;width:100%}.compact-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--background: transparent;--background-checked: var(--ion-color-primary);--color: var(--ion-color-dark);--color-checked: white;border-radius:8px;margin:4px;transition:all .3s ease;min-height:40px;flex:1}.compact-segment[_ngcontent-%COMP%]   ion-segment-button.segment-button-checked[_ngcontent-%COMP%]{box-shadow:0 4px 12px #4a90e24d;transform:translateY(-1px)}.compact-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]:hover:not(.segment-button-checked){background:rgba(74,144,226,.1)}.compact-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;padding:8px 12px;display:block}.search-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin-top:16px}.mini-input[_ngcontent-%COMP%], .mini-btn[_ngcontent-%COMP%]{height:40px;border-radius:12px;transition:all .3s ease}.mini-input[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .9);--border-color: rgba(0, 0, 0, .2);--border-width: 1px;--border-style: solid;border:1px solid rgba(0,0,0,.2)}.mini-input[_ngcontent-%COMP%]:hover, .mini-input[_ngcontent-%COMP%]:focus{--background: rgba(255, 255, 255, 1);border-color:var(--ion-color-primary);box-shadow:0 4px 16px #4a90e233}.search-btn[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: white;font-weight:500}.search-btn[_ngcontent-%COMP%]:hover{--background: var(--ion-color-primary-shade);transform:translateY(-1px);box-shadow:0 6px 20px #4a90e266}.info-card[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,.2);border-radius:12px;box-shadow:0 4px 16px #0000001a;margin:0;overflow:hidden}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{padding:12px 16px}.info-card[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;grid-gap:16px;gap:16px;align-items:start}.info-card[_ngcontent-%COMP%]   .info-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.info-card[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.info-card[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:13px;color:var(--ion-color-medium);font-weight:500;white-space:nowrap}.info-card[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:15px;color:var(--ion-color-dark);font-weight:600;word-wrap:break-word}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--ion-color-primary),var(--ion-color-primary-shade));color:#fff}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{color:#fff;display:flex;align-items:center;gap:8px}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.table-card[color=primary][_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]   .transaction-count[_ngcontent-%COMP%]{color:#fffc}.table-container[_ngcontent-%COMP%]{overflow-x:auto;border-radius:12px;background:rgba(255,255,255,.9);margin:0 -20px 20px}.modern-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border-spacing:0;font-size:14px}.modern-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,rgba(74,144,226,.1),rgba(80,227,194,.1))}.modern-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 12px;text-align:right;font-weight:600;color:var(--ion-color-dark);border-bottom:2px solid rgba(74,144,226,.2);white-space:nowrap}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{transition:all .2s ease;border-bottom:1px solid rgba(0,0,0,.05)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background:rgba(74,144,226,.05);transform:scale(1.001)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:right;vertical-align:middle;color:var(--ion-color-dark)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.serial[_ngcontent-%COMP%]{font-weight:600;color:var(--ion-color-medium);width:60px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.date[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:13px;width:100px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.type[_ngcontent-%COMP%]{width:120px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.details[_ngcontent-%COMP%]{max-width:200px;word-break:break-word}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.debit[_ngcontent-%COMP%], .modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.credit[_ngcontent-%COMP%]{font-weight:600;text-align:center;width:100px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td.actions[_ngcontent-%COMP%]{text-align:center;width:80px}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .transaction-type[_ngcontent-%COMP%]{padding:4px 8px;border-radius:6px;font-size:12px;font-weight:500}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .transaction-type.sales-type[_ngcontent-%COMP%]{background:rgba(16,220,96,.1);color:var(--ion-color-success);border:1px solid rgba(16,220,96,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .transaction-type.purchase-type[_ngcontent-%COMP%]{background:rgba(245,166,35,.1);color:var(--ion-color-warning);border:1px solid rgba(245,166,35,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .transaction-type.voucher-type[_ngcontent-%COMP%]{background:rgba(74,144,226,.1);color:var(--ion-color-primary);border:1px solid rgba(74,144,226,.2)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-family:Courier New,monospace}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount.debit-amount[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .amount.credit-amount[_ngcontent-%COMP%]{color:var(--ion-color-success)}.modern-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .skeleton-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;opacity:.8}.totals-footer[_ngcontent-%COMP%]{background:rgba(255,255,255,.95);backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid rgba(0,0,0,.1);padding:16px}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;max-width:600px;margin:0 auto;gap:20px}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{text-align:center}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin-bottom:4px}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600;font-family:Courier New,monospace}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-value.debit-total[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.totals-footer[_ngcontent-%COMP%]   .totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-value.credit-total[_ngcontent-%COMP%]{color:var(--ion-color-success)}@media (max-width: 768px){.modern-content[_ngcontent-%COMP%]{padding:6px 6px 120px}.form-container[_ngcontent-%COMP%]{padding-bottom:100px}.table-content[_ngcontent-%COMP%]{padding-bottom:40px}.main-row[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:stretch}.item-section[_ngcontent-%COMP%], .search-type-section[_ngcontent-%COMP%]{width:100%}.compact-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;padding:6px 8px}.info-card[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:12px}.info-card[_ngcontent-%COMP%]   .info-column[_ngcontent-%COMP%]{gap:8px}.info-card[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:12px}.info-card[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:13px}.totals-container[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;padding:8px 0;border-bottom:1px solid rgba(0,0,0,.05)}.totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.totals-container[_ngcontent-%COMP%]   .total-item[_ngcontent-%COMP%]   .total-label[_ngcontent-%COMP%]{margin-bottom:0;text-align:left}}@media (max-width: 480px){.modern-content[_ngcontent-%COMP%]{padding:4px 4px 140px}.table-header[_ngcontent-%COMP%]{padding:16px}.table-header[_ngcontent-%COMP%]   .table-title[_ngcontent-%COMP%]{font-size:16px}.compact-content[_ngcontent-%COMP%], .info-content[_ngcontent-%COMP%], .table-content[_ngcontent-%COMP%]{padding:16px}.table-content[_ngcontent-%COMP%]{padding-bottom:50px}.info-card[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr!important;gap:8px}}']}),r})()}];let ut=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[y.Bz.forChild(pt)],y.Bz]}),r})();var ht=h(62279);let gt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[_.ez,f.u5,s.Pc,ut,ht.m]]}),r})()},62279:(Z,x,h)=>{h.d(x,{m:()=>p});var _=h(69808),f=h(34182),s=h(23349),y=h(32090),d=h(29863);let p=(()=>{class t{}return t.\u0275fac=function(M){return new(M||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({providers:[_.uU],imports:[[_.ez,f.u5,f.UX,s.Pc,y.Fw]]}),t})()},52562:(Z,x,h)=>{h.d(x,{$:()=>f});var _=h(29863);let f=(()=>{class s{constructor(){}compareStrings(d,p){return d||p?d?p?d.localeCompare(p,"ar",{numeric:!0,sensitivity:"base",caseFirst:"lower"}):1:-1:0}compareNumbers(d,p){return(parseFloat(null==d?void 0:d.toString())||0)-(parseFloat(null==p?void 0:p.toString())||0)}compareDates(d,p){const t=new Date(d),C=new Date(p);return t.getTime()-C.getTime()}sortData(d,p,t){return d&&0!==d.length?[...d].sort((M,I)=>{let w=0;const P=M[p],b=I[p];return null==P&&null==b?0:null==P?"asc"===t?-1:1:null==b?"asc"===t?1:-1:(w=this.isDateColumn(p)||this.isDateValue(P)?this.compareDates(P,b):this.isNumericColumn(p)||this.isNumericValue(P)?this.compareNumbers(P,b):this.compareStrings(String(P),String(b)),"desc"===t?-w:w)}):d}isDateColumn(d){return["j_date","pay_date","date","created_at","updated_at"].includes(d)}isDateValue(d){return"string"==typeof d?/^\d{4}-\d{2}-\d{2}$|^\d{2}\/\d{2}\/\d{4}$/.test(d)||!isNaN(Date.parse(d)):d instanceof Date}isNumericColumn(d){return["amount","total","balance","price","quantity","qty","tot_pr","discount","pay","changee","sub_balance","current_balance","opening_balance","debit","credit","j_pay","perch_price","pay_price","id"].some(t=>d.toLowerCase().includes(t))}isNumericValue(d){return!isNaN(parseFloat(d))&&isFinite(d)}getSortIcon(d,p){return p&&p.column===d?"asc"===p.direction?"chevron-up-outline":"chevron-down-outline":"swap-vertical-outline"}getNextSortDirection(d,p){return p&&p.column===d&&"asc"===p.direction?"desc":"asc"}}return s.\u0275fac=function(d){return new(d||s)},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);