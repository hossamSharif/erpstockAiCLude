"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9755],{35845:(f,h,r)=>{r.d(h,{v:()=>D});var n=r(29863),d=r(34182),_=r(91472),l=r(23349),u=r(32724),g=r(69808);const a=["searchInput"],p=["inputWrapper"];function C(o,s){if(1&o){const t=n.EpF();n.TgZ(0,"ion-button",17),n.NdJ("click",function(){return n.CHM(t),n.oxw().onAddAccount()}),n._UZ(1,"ion-icon",18),n.qZA()}if(2&o){const t=n.oxw();n.Q6J("disabled",t.disabled)}}function M(o,s){1&o&&n._UZ(0,"ion-spinner",19)}function P(o,s){if(1&o&&(n.TgZ(0,"p",26),n._uU(1),n.qZA()),2&o){const t=n.oxw().$implicit;n.xp6(1),n.hij("\u0643\u0648\u062f: ",t.sub_code,"")}}function O(o,s){if(1&o&&(n.TgZ(0,"p",27),n._uU(1),n.qZA()),2&o){const t=n.oxw().$implicit,e=n.oxw(2);n.Udp("color","success"===e.getAccountBalanceColor(t)?"#10dc60":"#f04141"),n.xp6(1),n.hij(" \u0627\u0644\u0631\u0635\u064a\u062f: ",e.formatAccountBalance(t)," ")}}function b(o,s){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",23),n.NdJ("click",function(){const i=n.CHM(t).$implicit;return n.oxw(2).selectAccount(i)})("mousedown",function(c){return c.preventDefault()})("mouseenter",function(){const i=n.CHM(t).index;return n.oxw(2).highlightedIndex=i}),n.TgZ(1,"ion-label"),n.TgZ(2,"h3"),n._uU(3),n.qZA(),n.YNc(4,P,2,1,"p",24),n.YNc(5,O,2,3,"p",25),n.qZA(),n.qZA()}if(2&o){const t=s.$implicit,e=s.index,c=n.oxw(2);n.ekj("highlighted",e===c.highlightedIndex),n.xp6(3),n.Oqu(t.sub_name),n.xp6(1),n.Q6J("ngIf",t.sub_code),n.xp6(1),n.Q6J("ngIf",t.current_balance&&t.balance_status)}}function w(o,s){if(1&o&&(n.TgZ(0,"div",20),n.TgZ(1,"ion-list",21),n.YNc(2,b,6,5,"ion-item",22),n.qZA(),n.qZA()),2&o){const t=n.oxw();n.Udp("top",t.dropdownPosition.top)("left",t.dropdownPosition.left)("width",t.dropdownPosition.width),n.xp6(2),n.Q6J("ngForOf",t.filteredAccounts)}}function A(o,s){if(1&o&&(n.TgZ(0,"div",20),n.TgZ(1,"ion-list",21),n.TgZ(2,"ion-item",28),n.TgZ(3,"ion-label"),n.TgZ(4,"p"),n._uU(5,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0646\u062a\u0627\u0626\u062c \u0645\u0637\u0627\u0628\u0642\u0629"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&o){const t=n.oxw();n.Udp("top",t.dropdownPosition.top)("left",t.dropdownPosition.left)("width",t.dropdownPosition.width)}}function x(o,s){1&o&&(n.TgZ(0,"div",34),n._UZ(1,"ion-spinner",35),n.TgZ(2,"span"),n._uU(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),n.qZA(),n.qZA())}function v(o,s){if(1&o&&(n.TgZ(0,"div",36),n._uU(1),n.qZA()),2&o){const t=n.oxw(2);n.Udp("color","success"===t.getAccountBalanceColor(t.selectedAccount)?"#10dc60":"#f04141"),n.xp6(1),n.hij(" ",t.formatAccountBalance(t.selectedAccount)," ")}}function T(o,s){if(1&o&&(n.TgZ(0,"div",36),n._uU(1),n.qZA()),2&o){const t=n.oxw(2);n.Udp("color","success"===t.getBalanceColor(t.accountBalance)?"#10dc60":"#f04141"),n.xp6(1),n.hij(" ",t.formatBalance(t.accountBalance)," ")}}function I(o,s){1&o&&(n.TgZ(0,"div",37),n._uU(1," \u0644\u0627 \u064a\u0645\u0643\u0646 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0631\u0635\u064a\u062f "),n.qZA())}function S(o,s){if(1&o&&(n.TgZ(0,"div",29),n.TgZ(1,"div",30),n._uU(2,"\u0627\u0644\u0631\u0635\u064a\u062f:"),n.qZA(),n.YNc(3,x,4,0,"div",31),n.YNc(4,v,2,3,"div",32),n.YNc(5,T,2,3,"div",32),n.YNc(6,I,2,0,"div",33),n.qZA()),2&o){const t=n.oxw();n.xp6(3),n.Q6J("ngIf",t.loadingBalance&&t.selectedAccount),n.xp6(1),n.Q6J("ngIf",!t.loadingBalance&&t.selectedAccount.current_balance&&t.selectedAccount.balance_status),n.xp6(1),n.Q6J("ngIf",!t.loadingBalance&&t.accountBalance&&t.selectedAccount&&(!t.selectedAccount.current_balance||!t.selectedAccount.balance_status)),n.xp6(1),n.Q6J("ngIf",!t.loadingBalance&&!t.accountBalance&&t.selectedAccount&&t.selectedAccount.id&&(!t.selectedAccount.current_balance||!t.selectedAccount.balance_status))}}let D=(()=>{class o{constructor(t,e,c,i){this.api=t,this.navController=e,this.accountCommunicationService=c,this.cdr=i,this.accountType="customer",this.placeholder="\u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0633\u0627\u0628",this.label="\u0627\u0644\u062d\u0633\u0627\u0628",this.store_info=null,this.year=null,this.showAddButton=!0,this.disabled=!1,this.accountSelected=new n.vpe,this.balanceLoaded=new n.vpe,this.addAccountClicked=new n.vpe,this.accounts=[],this.filteredAccounts=[],this.selectedAccount=null,this.accountBalance=null,this.searchTerm="",this.showDropdown=!1,this.loadingAccounts=!1,this.loadingBalance=!1,this.highlightedIndex=-1,this.dropdownPosition={top:"0px",left:"0px",width:"250px"},this.onChange=m=>{},this.onTouched=()=>{}}ngOnInit(){this.selectedAccount=null,this.accountBalance=null,this.loadingBalance=!1,this.loadAccounts(),this.subscribeToNewAccount()}ngOnDestroy(){this.newAccountSubscription&&this.newAccountSubscription.unsubscribe()}subscribeToNewAccount(){this.newAccountSubscription=this.accountCommunicationService.newAccount$.subscribe(t=>{t&&(console.log("AccountSelector: Received new account:",t),this.accounts.push(t),this.filteredAccounts=[...this.accounts],this.selectAccount(t),this.accountCommunicationService.clearNewAccount(),console.log("AccountSelector: New account added and selected"))})}ngOnChanges(){this.store_info&&this.year&&this.loadAccounts()}loadAccounts(){this.store_info&&this.year?(this.loadingAccounts=!0,console.log("Loading accounts for store:",this.store_info.id,"year:",this.year.id),this.api.getAllCustomerSupplierAccounts(this.store_info.id,this.year.id).subscribe(t=>{this.loadingAccounts=!1,console.log("Accounts response:",t),t&&t.data?(this.accounts=t.data,this.filteredAccounts=[...this.accounts],console.log("Loaded",this.accounts.length,"accounts")):(console.warn("No accounts data in response"),this.accounts=[],this.filteredAccounts=[])},t=>{this.loadingAccounts=!1,console.error("Error loading accounts:",t),this.accounts=[],this.filteredAccounts=[]})):console.warn("Account Selector: store_info or year not provided")}onSearchInput(t){this.searchTerm=t.target.value,console.log("Search term:",this.searchTerm),console.log("Total accounts:",this.accounts.length),this.selectedAccount&&this.searchTerm!==this.selectedAccount.sub_name&&(console.log("Clearing selectedAccount because search term changed"),this.selectedAccount=null,this.accountBalance=null,this.loadingBalance=!1,this.cdr.detectChanges()),this.filterAccounts(),this.highlightedIndex=-1,this.searchTerm.length>0||this.accounts.length>0?(this.showDropdown||this.calculateDropdownPosition(),this.showDropdown=!0,console.log("Showing dropdown with",this.filteredAccounts.length,"filtered accounts")):(this.showDropdown=!1,this.filteredAccounts=[...this.accounts])}filterAccounts(){this.filteredAccounts=""===this.searchTerm.trim()?[...this.accounts]:this.accounts.filter(t=>t.sub_name.toLowerCase().includes(this.searchTerm.toLowerCase())||t.sub_code&&t.sub_code.toLowerCase().includes(this.searchTerm.toLowerCase()))}onInputFocus(){console.log("Input focused, accounts:",this.accounts.length),console.log("Current searchTerm:",this.searchTerm),console.log("Selected account:",this.selectedAccount),this.highlightedIndex=-1,this.accounts.length>0&&(setTimeout(()=>{this.calculateDropdownPosition(),this.showDropdown=!0},10),this.filteredAccounts=this.selectedAccount&&this.searchTerm===this.selectedAccount.sub_name||0===this.searchTerm.length?[...this.accounts]:this.accounts.filter(t=>t.sub_name.toLowerCase().includes(this.searchTerm.toLowerCase())||t.sub_code&&t.sub_code.toLowerCase().includes(this.searchTerm.toLowerCase())))}onInputBlur(){console.log("Input blur triggered"),setTimeout(()=>{console.log("Hiding dropdown after blur delay"),this.showDropdown=!1,this.highlightedIndex=-1},200)}onKeyDown(t){if(this.showDropdown&&0!==this.filteredAccounts.length)switch(t.key){case"ArrowDown":t.preventDefault(),this.highlightedIndex=Math.min(this.highlightedIndex+1,this.filteredAccounts.length-1),this.scrollHighlightedItemIntoView();break;case"ArrowUp":t.preventDefault(),this.highlightedIndex=Math.max(this.highlightedIndex-1,-1),this.scrollHighlightedItemIntoView();break;case"Enter":t.preventDefault(),this.highlightedIndex>=0&&this.highlightedIndex<this.filteredAccounts.length&&this.selectAccount(this.filteredAccounts[this.highlightedIndex]);break;case"Escape":t.preventDefault(),this.showDropdown=!1,this.highlightedIndex=-1;break;case"Tab":this.showDropdown=!1,this.highlightedIndex=-1}else"ArrowDown"===t.key&&this.filteredAccounts.length>0&&(t.preventDefault(),this.showDropdown=!0,this.highlightedIndex=0,this.calculateDropdownPosition())}scrollHighlightedItemIntoView(){this.highlightedIndex>=0&&setTimeout(()=>{const t=document.querySelector(".dropdown-container"),e=document.querySelector(".account-item.highlighted");if(t&&e){const c=t.getBoundingClientRect(),i=e.getBoundingClientRect();i.bottom>c.bottom?t.scrollTop+=i.bottom-c.bottom+10:i.top<c.top&&(t.scrollTop-=c.top-i.top+10)}},10)}calculateDropdownPosition(){var t,e;const c=(null===(t=this.inputWrapper)||void 0===t?void 0:t.nativeElement)||(null===(e=this.searchInput)||void 0===e?void 0:e.nativeElement);if(c){const i=c.getBoundingClientRect();console.log("Dropdown position calculation:"),console.log("Element used:",c.tagName,c.className),console.log("Element rect:",i),console.log("Viewport size:",window.innerWidth,window.innerHeight),this.dropdownPosition={top:i.bottom+2+"px",left:i.left+"px",width:i.width+"px"},console.log("Calculated dropdown position:",this.dropdownPosition)}else console.warn("Could not find element for dropdown positioning")}toggleDropdown(){console.log("Toggle dropdown clicked, accounts:",this.accounts.length),this.accounts.length>0?(this.showDropdown=!this.showDropdown,this.showDropdown&&(this.calculateDropdownPosition(),this.filteredAccounts=[...this.accounts],this.searchInput&&setTimeout(()=>{this.searchInput.nativeElement.focus()},100))):console.warn("No accounts loaded yet")}selectAccount(t){console.log("selectAccount called with:",t),console.log("Before - searchTerm:",this.searchTerm),this.selectedAccount=t,this.searchTerm=t.sub_name,this.showDropdown=!1,this.highlightedIndex=-1,console.log("After - searchTerm:",this.searchTerm),console.log("After - selectedAccount:",this.selectedAccount),this.cdr.detectChanges(),this.searchInput&&this.searchInput.nativeElement&&setTimeout(()=>{const e=this.searchInput.nativeElement;e.value=t.sub_name;const c=new Event("input",{bubbles:!0});e.dispatchEvent(c)},10),this.accountSelected.emit(t),this.onChange(t),this.onTouched(),t&&t.id&&this.accountCommunicationService.setCustomerSelected(t.id,t),this.loadAccountBalance(t.id),console.log("Account selection completed")}loadAccountBalance(t){!t||!this.store_info||!this.year||(this.loadingBalance=!0,this.accountBalance=null,this.api.getAccountBalance(t,this.store_info.id,this.year.id).subscribe(e=>{this.loadingBalance=!1,e.success&&(this.accountBalance=e.data,this.balanceLoaded.emit(this.accountBalance))},e=>{this.loadingBalance=!1,console.error("Error loading account balance:",e)}))}onAddAccount(){console.log("Add account button clicked"),this.addAccountClicked.emit(),this.navController.navigateForward("/account-modal",{queryParams:{mode:"create"}})}clearSelection(){console.log("Clearing all selection data"),this.selectedAccount=null,this.accountBalance=null,this.searchTerm="",this.showDropdown=!1,this.loadingBalance=!1,this.highlightedIndex=-1,this.filteredAccounts=[...this.accounts],this.onChange(null),this.onTouched(),this.accountSelected.emit(null)}formatBalance(t){return t?`${Math.abs(t.current_balance).toFixed(2)} (${"debit"===t.status?"\u0645\u062f\u064a\u0646":"\u062f\u0627\u0626\u0646"})`:""}formatAccountBalance(t){return t&&t.current_balance?`${Math.abs(t.current_balance).toFixed(2)} (${"debit"===t.balance_status?"\u0645\u062f\u064a\u0646":"\u062f\u0627\u0626\u0646"})`:""}getBalanceColor(t){return t?"debit"===t.status?"danger":"success":"medium"}getAccountBalanceColor(t){return t&&t.balance_status?"debit"===t.balance_status?"danger":"success":"medium"}refreshAccounts(){console.log("Manual refresh triggered by user"),this.accounts=[],this.filteredAccounts=[],this.showDropdown=!1,this.highlightedIndex=-1,this.selectedAccount&&(this.selectedAccount=null,this.accountBalance=null,this.searchTerm="",this.onChange(null),this.accountSelected.emit(null)),this.loadAccounts()}refresh(){console.log("Internal refresh triggered"),this.loadAccounts()}isReady(){return!this.loadingAccounts&&this.accounts.length>0}writeValue(t){t&&"object"==typeof t?(this.selectedAccount=t,this.searchTerm=t.sub_name||""):this.clearSelection()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(_.r),n.Y36(l.SH),n.Y36(u.n),n.Y36(n.sBO))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-account-selector"]],viewQuery:function(t,e){if(1&t&&(n.Gf(a,5),n.Gf(p,5)),2&t){let c;n.iGM(c=n.CRH())&&(e.searchInput=c.first),n.iGM(c=n.CRH())&&(e.inputWrapper=c.first)}},inputs:{accountType:"accountType",placeholder:"placeholder",label:"label",store_info:"store_info",year:"year",showAddButton:"showAddButton",disabled:"disabled"},outputs:{accountSelected:"accountSelected",balanceLoaded:"balanceLoaded",addAccountClicked:"addAccountClicked"},features:[n._Bn([{provide:d.JU,useExisting:(0,n.Gpc)(()=>o),multi:!0}]),n.TTD],decls:20,vars:13,consts:[[1,"account-selector-container"],[1,"header-container"],[1,"label-with-buttons-container"],[1,"action-buttons-left"],["fill","clear","size","small",1,"account-refresh-btn-left",3,"disabled","click"],["name","refresh","color","primary"],["size","small","fill","clear","class","add-account-btn-left",3,"disabled","click",4,"ngIf"],["name","dots","class","account-loading-spinner-left",4,"ngIf"],[2,"text-align","right"],[1,"input-container"],[1,"custInput","account-selector-wrapper"],[1,"input-container-wrapper"],["inputWrapper",""],[1,"account-input",3,"ngModel","placeholder","disabled","clearInput","ngModelChange","ionInput","ionFocus","ionBlur","click","keydown"],["searchInput",""],["class","dropdown-container",3,"top","left","width",4,"ngIf"],["class","balance-container",4,"ngIf"],["size","small","fill","clear",1,"add-account-btn-left",3,"disabled","click"],["name","add-circle-outline","color","primary","slot","icon-only"],["name","dots",1,"account-loading-spinner-left"],[1,"dropdown-container"],[1,"account-dropdown"],["button","","class","account-item",3,"highlighted","click","mousedown","mouseenter",4,"ngFor","ngForOf"],["button","",1,"account-item",3,"click","mousedown","mouseenter"],["class","account-code",4,"ngIf"],["class","account-balance",3,"color",4,"ngIf"],[1,"account-code"],[1,"account-balance"],[1,"no-results"],[1,"balance-container"],[1,"balance-label"],["class","balance-loading",4,"ngIf"],["class","balance-amount",3,"color",4,"ngIf"],["class","balance-error",4,"ngIf"],[1,"balance-loading"],["name","dots","color","primary"],[1,"balance-amount"],[1,"balance-error"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n.TgZ(3,"div",3),n.TgZ(4,"ion-button",4),n.NdJ("click",function(){return e.refreshAccounts()}),n._UZ(5,"ion-icon",5),n.qZA(),n.YNc(6,C,2,1,"ion-button",6),n.YNc(7,M,1,0,"ion-spinner",7),n.qZA(),n.TgZ(8,"ion-label",8),n.TgZ(9,"strong"),n._uU(10),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(11,"div",9),n.TgZ(12,"ion-item",10),n.TgZ(13,"div",11,12),n.TgZ(15,"ion-input",13,14),n.NdJ("ngModelChange",function(i){return e.searchTerm=i})("ionInput",function(i){return e.onSearchInput(i)})("ionFocus",function(){return e.onInputFocus()})("ionBlur",function(){return e.onInputBlur()})("click",function(){return e.onInputFocus()})("keydown",function(i){return e.onKeyDown(i)}),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.YNc(17,w,3,7,"div",15),n.YNc(18,A,6,6,"div",15),n.YNc(19,S,7,4,"div",16),n.qZA()),2&t&&(n.xp6(4),n.Q6J("disabled",e.loadingAccounts),n.xp6(1),n.ekj("spin",e.loadingAccounts),n.xp6(1),n.Q6J("ngIf",e.showAddButton),n.xp6(1),n.Q6J("ngIf",e.loadingAccounts),n.xp6(3),n.Oqu(e.label||"\u0627\u0644\u062d\u0633\u0627\u0628"),n.xp6(5),n.Q6J("ngModel",e.searchTerm)("placeholder",e.placeholder)("disabled",e.disabled)("clearInput",!0),n.xp6(2),n.Q6J("ngIf",e.showDropdown&&e.filteredAccounts.length>0),n.xp6(1),n.Q6J("ngIf",e.showDropdown&&0===e.filteredAccounts.length&&e.searchTerm.length>0),n.xp6(1),n.Q6J("ngIf",e.selectedAccount&&e.selectedAccount.id))},directives:[l.YG,l.gu,g.O5,l.Q$,l.Ie,l.pK,l.j9,d.JJ,d.On,l.PQ,l.q_,g.sg],styles:[".custInput[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px}.account-selector-container[_ngcontent-%COMP%]{position:relative;width:100%}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]{direction:ltr;display:flex;justify-content:space-between;align-items:center;position:relative;text-align:right}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .action-buttons-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;order:1}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{flex:1;text-align:right;order:2;font-size:14px;font-weight:600;color:var(--ion-color-dark)}.account-selector-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%]{--color: var(--ion-color-primary);--padding-start: 3px;--padding-end: 3px;height:32px;width:32px;margin:0}.account-selector-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px;transition:transform .3s ease}.account-selector-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%]   ion-icon.spin[_ngcontent-%COMP%]{animation:spin 1s linear infinite}.account-selector-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%]:hover{--color: var(--ion-color-primary-shade);--background: rgba(var(--ion-color-primary-rgb), .1)}.account-selector-container[_ngcontent-%COMP%]   .account-refresh-btn-left[disabled][_ngcontent-%COMP%]{--color: var(--ion-color-medium);opacity:.5}.account-selector-container[_ngcontent-%COMP%]   .add-account-btn-left[_ngcontent-%COMP%]{--color: var(--ion-color-primary);--padding-start: 3px;--padding-end: 3px;height:32px;width:32px;margin:0}.account-selector-container[_ngcontent-%COMP%]   .add-account-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.account-selector-container[_ngcontent-%COMP%]   .add-account-btn-left[_ngcontent-%COMP%]:hover{--color: var(--ion-color-primary-shade);--background: rgba(var(--ion-color-primary-rgb), .1)}.account-selector-container[_ngcontent-%COMP%]   .add-account-btn-left[disabled][_ngcontent-%COMP%]{--color: var(--ion-color-medium);opacity:.5}.account-selector-container[_ngcontent-%COMP%]   .account-loading-spinner-left[_ngcontent-%COMP%]{width:18px;height:18px;margin:0}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;position:relative}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .account-selector-wrapper[_ngcontent-%COMP%]{width:100%;border:1px solid #ccc;border-radius:4px}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .account-selector-wrapper[_ngcontent-%COMP%]   .input-container-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .account-selector-wrapper[_ngcontent-%COMP%]   .account-input[_ngcontent-%COMP%]{--background: transparent;--color: var(--ion-color-dark);--placeholder-color: var(--ion-color-medium);width:100%;direction:rtl;text-align:right;--padding-end: 45px}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .account-selector-wrapper[_ngcontent-%COMP%]   .account-input[disabled][_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-medium);cursor:not-allowed}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{position:fixed;z-index:10000;background:white;border:1px solid var(--ion-color-light);border-radius:8px;box-shadow:0 8px 24px #0003;max-height:200px;overflow-y:auto;margin-top:4px;min-width:250px}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]{margin:0;padding:0;background:transparent}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{--background: transparent;--border-color: transparent;--color: var(--ion-color-dark);--padding-start: 12px;--padding-end: 12px;--min-height: 48px;direction:rtl;text-align:right}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:hover{--background: var(--ion-color-light)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:active{--background: rgba(var(--ion-color-primary-rgb), .1)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item.highlighted[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-primary-rgb), .1);border-left:3px solid var(--ion-color-primary)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:var(--ion-color-dark);margin:0}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .account-code[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin:2px 0 0}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--padding-start: 12px;--padding-end: 12px;text-align:center;font-style:italic}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .no-results[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:var(--ion-color-light-tint);border-radius:6px;direction:rtl}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:var(--ion-color-dark)}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-loading[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-loading[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:14px;height:14px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-loading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-primary)}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-amount[_ngcontent-%COMP%]{font-size:13px;font-weight:600;flex:1}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-error[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-danger);font-style:italic}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .action-buttons-left[_ngcontent-%COMP%]{gap:2px}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:12px}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%], .account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .add-account-btn-left[_ngcontent-%COMP%]{height:28px;width:28px;--padding-start: 2px;--padding-end: 2px}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .account-refresh-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .add-account-btn-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.account-selector-container[_ngcontent-%COMP%]   .header-container[_ngcontent-%COMP%]   .label-with-buttons-container[_ngcontent-%COMP%]   .account-loading-spinner-left[_ngcontent-%COMP%]{width:16px;height:16px}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .account-selector-wrapper[_ngcontent-%COMP%]   .account-input[_ngcontent-%COMP%]{font-size:13px;--padding-start: 10px;--padding-end: 40px}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{max-height:160px}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{--min-height: 44px}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:13px}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .account-code[_ngcontent-%COMP%]{font-size:11px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]{padding:6px 10px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{font-size:11px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-amount[_ngcontent-%COMP%]{font-size:12px}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-loading[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-error[_ngcontent-%COMP%]{font-size:11px}}@media (prefers-color-scheme: dark){.account-selector-container[_ngcontent-%COMP%]   .field-label[_ngcontent-%COMP%]{color:var(--ion-color-dark-contrast)}.account-selector-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .account-input[_ngcontent-%COMP%]{--background: var(--ion-color-step-50);--color: var(--ion-color-dark-contrast);border-color:var(--ion-color-step-200)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]{background:var(--ion-color-step-50);border-color:var(--ion-color-step-200)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]{--color: var(--ion-color-dark-contrast)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]:hover{--background: var(--ion-color-step-100)}.account-selector-container[_ngcontent-%COMP%]   .dropdown-container[_ngcontent-%COMP%]   .account-dropdown[_ngcontent-%COMP%]   .account-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:var(--ion-color-dark-contrast)}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]{background:var(--ion-color-step-100)}.account-selector-container[_ngcontent-%COMP%]   .balance-container[_ngcontent-%COMP%]   .balance-label[_ngcontent-%COMP%]{color:var(--ion-color-dark-contrast)}}"]}),o})()},62279:(f,h,r)=>{r.d(h,{m:()=>g});var n=r(69808),d=r(34182),_=r(23349),l=r(32090),u=r(29863);let g=(()=>{class a{}return a.\u0275fac=function(C){return new(C||a)},a.\u0275mod=u.oAB({type:a}),a.\u0275inj=u.cJS({providers:[n.uU],imports:[[n.ez,d.u5,d.UX,_.Pc,l.Fw]]}),a})()},32724:(f,h,r)=>{r.d(h,{n:()=>l});var n=r(591),d=r(5529),_=r(29863);let l=(()=>{class u{constructor(){this.newAccountSubject=new n.X(null),this.newAccount$=this.newAccountSubject.asObservable(),this.customerSelectedSubject=new d.xQ,this.customerSelected$=this.customerSelectedSubject.asObservable()}setNewAccount(a){console.log("AccountCommunicationService: Setting new account:",a),this.newAccountSubject.next(a),a&&a.id&&this.customerSelectedSubject.next({id:a.id,account:a})}setCustomerSelected(a,p){console.log("AccountCommunicationService: Customer selected with ID:",a),this.customerSelectedSubject.next({id:a,account:p})}clearNewAccount(){this.newAccountSubject.next(null)}getCurrentAccount(){return this.newAccountSubject.value}}return u.\u0275fac=function(a){return new(a||u)},u.\u0275prov=_.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);