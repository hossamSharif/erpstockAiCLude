"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5506],{55506:(M,m,c)=>{c.d(m,{_:()=>E});var l=c(70655),t=c(29863),r=c(23349),f=c(94030),d=c(91472),v=c(90849),s=c(32724),g=c(34182),A=c(69808);function C(i,u){if(1&i&&(t.TgZ(0,"ion-select-option",27),t._uU(1),t.qZA()),2&i){const e=u.$implicit;t.Q6J("value",e.ac_name),t.xp6(1),t.hij(" ",e.ac_name," ")}}function y(i,u){1&i&&(t.TgZ(0,"div",28),t._uU(1," \u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629... "),t.qZA())}function x(i,u){if(1&i&&(t.TgZ(0,"ion-select-option",27),t._uU(1),t.qZA()),2&i){const e=u.$implicit;t.Q6J("value",e.cat_name),t.xp6(1),t.hij(" ",e.cat_name," ")}}function P(i,u){1&i&&(t.TgZ(0,"div",28),t._uU(1," \u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062a\u0635\u0646\u064a\u0641\u0627\u062a... "),t.qZA())}function O(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",10),t.TgZ(1,"ion-label",11),t._uU(2,"\u0627\u0644\u0647\u0627\u062a\u0641"),t.qZA(),t.TgZ(3,"ion-input",29),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw().payInvo.phone=o}),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngModel",e.payInvo.phone)}}function T(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"div",30),t.TgZ(1,"ion-label",11),t._uU(2,"\u0627\u0644\u0639\u0646\u0648\u0627\u0646"),t.qZA(),t.TgZ(3,"ion-textarea",31),t.NdJ("ngModelChange",function(o){return t.CHM(e),t.oxw().payInvo.address=o}),t.qZA(),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngModel",e.payInvo.address)}}function k(i,u){1&i&&t._UZ(0,"ion-icon",32)}function Z(i,u){1&i&&t._UZ(0,"ion-spinner",33)}function w(i,u){if(1&i){const e=t.EpF();t.TgZ(0,"ion-button",34),t.NdJ("click",function(){return t.CHM(e),t.oxw().deleteAccount()}),t._UZ(1,"ion-icon",35),t._uU(2," \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628 "),t.qZA()}}const I=function(){return{header:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0631\u0626\u064a\u0633\u064a"}},D=function(){return{header:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062a\u0635\u0646\u064a\u0641"}};let E=(()=>{class i{constructor(e,n,o,a,p,_,h,b,q){this.navController=e,this.route=n,this.loadingController=o,this.toastController=a,this.alertController=p,this.api=_,this.storage=h,this.accountCommunicationService=b,this.cdr=q,this.mode="create",this.account_category=[],this.main_account=[],this.loading=!1,this.saving=!1,this.initializeData()}ngOnInit(){console.log("Account modal ngOnInit"),this.getAppInfo(),this.initializeFromRoute()}initializeData(){this.payInvo={id:"",ac_id:"",sub_name:"",sub_type:"",sub_code:"",sub_balance:"",store_id:"",cat_id:"",cat_name:"",ac_behavior:"",phone:"",address:""},this.selectedMainAccount={ac_id:"",actype_id:"",ac_name:"",ac_code:"",eng_name:"",ac_type:""},this.selectedCategory={id:"",cat_name:""}}initializeFromRoute(){this.route.queryParams.subscribe(e=>{e.mode&&(this.mode=e.mode),e.account&&(this.account=JSON.parse(e.account),this.initializeForm())})}initializeForm(){"edit"===this.mode&&this.account&&(this.payInvo={id:this.account.id,ac_id:this.account.ac_id,sub_name:this.account.sub_name,sub_type:this.account.sub_type,sub_code:this.account.sub_code,sub_balance:this.account.sub_balance,store_id:this.account.store_id,cat_id:this.account.cat_id,cat_name:this.account.cat_name,ac_behavior:this.account.ac_behavior,phone:this.account.phone,address:this.account.address},this.setMainAccountForEdit())}setMainAccountForEdit(){if(this.main_account&&this.main_account.length>0&&this.account){const e=this.main_account.find(n=>n.ac_id==this.account.ac_id);e&&(this.selectedMainAccount={ac_id:e.ac_id,actype_id:e.actype_id,ac_name:e.ac_name,ac_code:e.ac_code,eng_name:e.eng_name,ac_type:e.ac_type})}}setCategoryForEdit(){if(this.account_category&&this.account_category.length>0&&this.account){const e=this.account_category.find(n=>n.id==this.account.cat_id);e?(this.selectedCategory={id:e.id,cat_name:e.cat_name},this.payInvo.cat_id=e.id,this.payInvo.cat_name=e.cat_name,this.cdr.detectChanges(),console.log("Category set for edit mode:",this.selectedCategory)):console.log("Category not found for id:",this.account.cat_id)}}getAppInfo(){this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e,console.log("User info loaded:",this.user_info))}),this.storage.get("year").then(e=>{e&&(this.year=e,console.log("Year loaded:",this.year))}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.payInvo.store_id=this.store_info.id,console.log("Store info loaded:",this.store_info),this.loadSupportingData())})}loadSupportingData(){console.log("Loading supporting data..."),this.getMainAccount(),this.getAccountCategory()}getMainAccount(){this.api.getMainAccounts().subscribe(e=>{this.main_account=e.data||[],console.log("Main accounts loaded:",this.main_account),"edit"===this.mode&&this.account&&this.setMainAccountForEdit()},e=>{console.log("Error loading main accounts:",e)})}getAccountCategory(){this.store_info&&this.store_info.id?(console.log("Loading categories for store:",this.store_info.id),this.api.getAccountCategory(this.store_info.id).subscribe(e=>{this.account_category=e.data||[],console.log("Account categories loaded:",this.account_category),"edit"===this.mode&&this.account&&setTimeout(()=>{this.setCategoryForEdit()},100)},e=>{console.log("Error loading categories:",e)})):console.log("Store info not available for loading categories")}pickMainAccount(e){const n=e.detail.value;console.log("Main account selected:",n);const o=this.main_account.find(a=>a.ac_name===n);o?(this.selectedMainAccount={ac_id:o.ac_id,ac_name:o.ac_name,actype_id:o.actype_id,ac_code:o.ac_code,eng_name:o.eng_name,ac_type:o.ac_type},this.payInvo.ac_id=this.selectedMainAccount.ac_id,this.payInvo.sub_type=this.selectedMainAccount.ac_type,this.payInvo.ac_behavior=this.selectedMainAccount.ac_type,console.log("Selected main account:",o),console.log("Auto-selected account type:",this.selectedMainAccount.ac_type)):this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628","danger")}pickAccountCategory(e){const n=e.detail.value;console.log("Category selected:",n);const o=this.account_category.find(a=>a.cat_name===n);o?(this.selectedCategory={id:o.id,cat_name:o.cat_name},this.payInvo.cat_id=this.selectedCategory.id,this.payInvo.cat_name=this.selectedCategory.cat_name,console.log("Selected category:",o),console.log("Show phone/address fields:",this.shouldShowPhoneAndAddress())):this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u0645 \u0627\u0644\u062a\u0635\u0646\u064a\u0641","danger")}shouldShowPhoneAndAddress(){if(this.selectedCategory&&this.selectedCategory.id){const e=parseInt(this.selectedCategory.id);return 1===e||2===e}return!1}save(){return(0,l.mG)(this,void 0,void 0,function*(){if(!this.validate())return;this.saving=!0;const e=yield this.loadingController.create({message:"\u062c\u0627\u0631\u064a \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a...",spinner:"crescent"});yield e.present();try{let n;if(n="create"===this.mode?yield this.createAccount():yield this.updateAccount(),yield e.dismiss(),this.saving=!1,"create"===this.mode&&n){console.log("Account created successfully, result:",n),console.log("payInvo data:",this.payInvo);const o=n.message,a={id:o,ac_id:this.payInvo.ac_id,sub_name:this.payInvo.sub_name,sub_type:this.payInvo.sub_type,sub_code:this.payInvo.sub_code,sub_balance:this.payInvo.sub_balance,store_id:this.payInvo.store_id,cat_id:this.payInvo.cat_id,cat_name:this.payInvo.cat_name,phone:this.payInvo.phone,address:this.payInvo.address};console.log("Sending account data with ID:",o,a),this.accountCommunicationService.setNewAccount(a)}this.navigateBack()}catch(n){yield e.dismiss(),this.saving=!1,this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u062d\u0641\u0638 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a","danger")}})}createAccount(){return new Promise((e,n)=>{this.api.createAccount(this.payInvo).subscribe(o=>{"Post Not Created"!==o.message?(this.presentToast("\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u062d\u0633\u0627\u0628 \u0628\u0646\u062c\u0627\u062d","success"),e(o)):(this.presentToast("\u0641\u0634\u0644 \u0641\u064a \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062d\u0633\u0627\u0628","danger"),n(o))},o=>{this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0627\u062a\u0635\u0627\u0644","danger"),n(o)})})}updateAccount(){return new Promise((e,n)=>{this.api.updateSubAccount(this.payInvo).subscribe(o=>{"Post Not Created"!==o.message?(this.presentToast("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0633\u0627\u0628 \u0628\u0646\u062c\u0627\u062d","success"),e(o)):(this.presentToast("\u0641\u0634\u0644 \u0641\u064a \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0633\u0627\u0628","danger"),n(o))},o=>{this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0627\u062a\u0635\u0627\u0644","danger"),n(o)})})}validate(){return this.payInvo.sub_name&&""!==this.payInvo.sub_name.trim()?this.payInvo.sub_type&&""!==this.payInvo.sub_type?!(!this.selectedMainAccount.ac_id||""===this.selectedMainAccount.ac_name)||(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0631\u0626\u064a\u0633\u064a","danger"),!1):(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0627\u062e\u062a\u064a\u0627\u0631 \u0637\u0628\u064a\u0639\u0629 \u0627\u0644\u062d\u0633\u0627\u0628","danger"),!1):(this.presentToast("\u0627\u0644\u0631\u062c\u0627\u0621 \u0625\u062f\u062e\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628","danger"),!1)}presentToast(e,n){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:e,duration:2e3,color:n,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}closeModal(){this.navigateBack()}navigateBack(){this.navController.back()}deleteAccount(){return(0,l.mG)(this,void 0,void 0,function*(){"edit"===this.mode&&this.payInvo.id?yield(yield this.alertController.create({header:"\u062a\u0623\u0643\u064a\u062f \u0627\u0644\u062d\u0630\u0641",message:`\u0647\u0644 \u062a\u0631\u064a\u062f \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628 "${this.payInvo.sub_name}"\u061f`,buttons:[{text:"\u0625\u0644\u063a\u0627\u0621",role:"cancel",cssClass:"secondary"},{text:"\u062d\u0630\u0641",cssClass:"danger",handler:()=>{this.checkAccountUsageAndDelete()}}]})).present():this.presentToast("\u0644\u0627 \u064a\u0645\u0643\u0646 \u062d\u0630\u0641 \u062d\u0633\u0627\u0628 \u063a\u064a\u0631 \u0645\u062d\u0641\u0648\u0638","danger")})}checkAccountUsageAndDelete(){return(0,l.mG)(this,void 0,void 0,function*(){const e=yield this.loadingController.create({message:"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0642\u0642 \u0645\u0646 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u062d\u0633\u0627\u0628...",spinner:"crescent"});yield e.present();try{(yield this.checkAccountCanBeDeleted())?(yield e.dismiss(),yield this.performDelete()):(yield e.dismiss(),this.presentToast("\u0644\u0627 \u064a\u0645\u0643\u0646 \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628 \u0644\u0623\u0646\u0647 \u0645\u0633\u062a\u062e\u062f\u0645 \u0641\u064a \u0645\u0639\u0627\u0645\u0644\u0627\u062a \u0623\u062e\u0631\u0649","danger"))}catch(n){yield e.dismiss(),this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062a\u062d\u0642\u0642 \u0645\u0646 \u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u0627\u0644\u062d\u0633\u0627\u0628","danger")}})}checkAccountCanBeDeleted(){return new Promise((e,n)=>{this.api.checkAccountUsage(this.payInvo.id).subscribe(o=>{if(console.log("Account usage check result:",o),o&&o.data){const a=o.data,p=(a.jdetails_from_count||0)>0||(a.jdetails_to_count||0)>0,_=(a.pay_count||0)>0,h=(a.perch_count||0)>0,b=!p&&!_&&!h;b||console.log("Account cannot be deleted. Usage:",{journalEntries:p,payments:_,purchases:h}),e(b)}else e(!0)},o=>{console.error("Error checking account usage:",o),n(o)})})}performDelete(){return(0,l.mG)(this,void 0,void 0,function*(){const e=yield this.loadingController.create({message:"\u062c\u0627\u0631\u064a \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628...",spinner:"crescent"});yield e.present();try{const n=yield this.deleteAccountFromServer();yield e.dismiss(),n?(this.presentToast("\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628 \u0628\u0646\u062c\u0627\u062d","success"),this.navigateBack()):this.presentToast("\u0641\u0634\u0644 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628","danger")}catch(n){yield e.dismiss(),this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u062d\u0633\u0627\u0628","danger")}})}deleteAccountFromServer(){return new Promise((e,n)=>{this.api.deleteSubAccont(this.payInvo.id).subscribe(o=>{e("Post Not Deleted"!==o.message)},o=>{n(o)})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.SH),t.Y36(f.gz),t.Y36(r.HT),t.Y36(r.yF),t.Y36(r.Br),t.Y36(d.r),t.Y36(v.K),t.Y36(s.n),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-account-modal"]],decls:48,vars:21,consts:[[1,"transparent-header"],[1,"transparent-toolbar"],["slot","start"],["fill","clear",3,"click"],["name","arrow-back-outline"],[1,"glass-title"],[1,"modern-content"],[1,"form-container"],[1,"account-card"],[1,"form-grid"],[1,"form-group"],["position","stacked",1,"form-label"],["placeholder","\u0623\u062f\u062e\u0644 \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628","type","text","required","",1,"form-input",3,"ngModel","ngModelChange"],["placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0631\u0626\u064a\u0633\u064a","interface","alert",1,"form-select",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["class","loading-text",4,"ngIf"],["placeholder","\u0623\u062f\u062e\u0644 \u0643\u0648\u062f \u0627\u0644\u062d\u0633\u0627\u0628","type","text",1,"form-input",3,"ngModel","ngModelChange"],["placeholder","0.00","type","number","step","0.01",1,"form-input",3,"ngModel","ngModelChange"],["placeholder","\u0627\u062e\u062a\u0631 \u0627\u0644\u062a\u0635\u0646\u064a\u0641","interface","alert",1,"form-select",3,"value","interfaceOptions","ionChange"],["class","form-group",4,"ngIf"],["class","form-group full-width",4,"ngIf"],[1,"action-buttons-container"],[1,"buttons-row"],["fill","solid","color","primary",1,"action-btn","save-btn",3,"disabled","click"],["name","checkmark-outline","slot","start",4,"ngIf"],["name","crescent","slot","start",4,"ngIf"],["fill","solid","color","danger","class","action-btn delete-btn",3,"click",4,"ngIf"],[3,"value"],[1,"loading-text"],["placeholder","\u0623\u062f\u062e\u0644 \u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062a\u0641","type","tel",1,"form-input",3,"ngModel","ngModelChange"],[1,"form-group","full-width"],["placeholder","\u0623\u062f\u062e\u0644 \u0627\u0644\u0639\u0646\u0648\u0627\u0646","rows","3","maxlength","500",1,"form-textarea",3,"ngModel","ngModelChange"],["name","checkmark-outline","slot","start"],["name","crescent","slot","start"],["fill","solid","color","danger",1,"action-btn","delete-btn",3,"click"],["name","trash-outline","slot","start"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-buttons",2),t.TgZ(3,"ion-button",3),t.NdJ("click",function(){return n.navigateBack()}),t._UZ(4,"ion-icon",4),t.qZA(),t.qZA(),t.TgZ(5,"ion-title",5),t._uU(6),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"ion-content",6),t.TgZ(8,"div",7),t.TgZ(9,"ion-card",8),t.TgZ(10,"ion-card-header"),t.TgZ(11,"ion-card-title"),t._uU(12,"\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062d\u0633\u0627\u0628"),t.qZA(),t.qZA(),t.TgZ(13,"ion-card-content"),t.TgZ(14,"div",9),t.TgZ(15,"div",10),t.TgZ(16,"ion-label",11),t._uU(17,"\u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628 *"),t.qZA(),t.TgZ(18,"ion-input",12),t.NdJ("ngModelChange",function(a){return n.payInvo.sub_name=a}),t.qZA(),t.qZA(),t.TgZ(19,"div",10),t.TgZ(20,"ion-label",11),t._uU(21,"\u0627\u0644\u062d\u0633\u0627\u0628 \u0627\u0644\u0631\u0626\u064a\u0633\u064a *"),t.qZA(),t.TgZ(22,"ion-select",13),t.NdJ("ngModelChange",function(a){return n.selectedMainAccount.ac_name=a})("ionChange",function(a){return n.pickMainAccount(a)}),t.YNc(23,C,2,2,"ion-select-option",14),t.qZA(),t.YNc(24,y,2,0,"div",15),t.qZA(),t.TgZ(25,"div",10),t.TgZ(26,"ion-label",11),t._uU(27,"\u0643\u0648\u062f \u0627\u0644\u062d\u0633\u0627\u0628"),t.qZA(),t.TgZ(28,"ion-input",16),t.NdJ("ngModelChange",function(a){return n.payInvo.sub_code=a}),t.qZA(),t.qZA(),t.TgZ(29,"div",10),t.TgZ(30,"ion-label",11),t._uU(31,"\u0627\u0644\u0631\u0635\u064a\u062f \u0627\u0644\u0627\u0641\u062a\u062a\u0627\u062d\u064a"),t.qZA(),t.TgZ(32,"ion-input",17),t.NdJ("ngModelChange",function(a){return n.payInvo.sub_balance=a}),t.qZA(),t.qZA(),t.TgZ(33,"div",10),t.TgZ(34,"ion-label",11),t._uU(35,"\u062a\u0635\u0646\u064a\u0641 \u0627\u0644\u062d\u0633\u0627\u0628"),t.qZA(),t.TgZ(36,"ion-select",18),t.NdJ("ionChange",function(a){return n.pickAccountCategory(a)}),t.YNc(37,x,2,2,"ion-select-option",14),t.qZA(),t.YNc(38,P,2,0,"div",15),t.qZA(),t.YNc(39,O,4,1,"div",19),t.YNc(40,T,4,1,"div",20),t.qZA(),t.TgZ(41,"div",21),t.TgZ(42,"div",22),t.TgZ(43,"ion-button",23),t.NdJ("click",function(){return n.save()}),t.YNc(44,k,1,0,"ion-icon",24),t.YNc(45,Z,1,0,"ion-spinner",25),t._uU(46),t.qZA(),t.YNc(47,w,3,0,"ion-button",26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij(" ","create"===n.mode?"\u0625\u0646\u0634\u0627\u0621 \u062d\u0633\u0627\u0628 \u062c\u062f\u064a\u062f":"\u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u062d\u0633\u0627\u0628"," "),t.xp6(12),t.Q6J("ngModel",n.payInvo.sub_name),t.xp6(4),t.Q6J("ngModel",n.selectedMainAccount.ac_name)("interfaceOptions",t.DdM(19,I)),t.xp6(1),t.Q6J("ngForOf",n.main_account),t.xp6(1),t.Q6J("ngIf",0===n.main_account.length),t.xp6(4),t.Q6J("ngModel",n.payInvo.sub_code),t.xp6(4),t.Q6J("ngModel",n.payInvo.sub_balance),t.xp6(4),t.Q6J("value",n.selectedCategory.cat_name)("interfaceOptions",t.DdM(20,D)),t.xp6(1),t.Q6J("ngForOf",n.account_category),t.xp6(1),t.Q6J("ngIf",0===n.account_category.length),t.xp6(1),t.Q6J("ngIf",n.shouldShowPhoneAndAddress()),t.xp6(1),t.Q6J("ngIf",n.shouldShowPhoneAndAddress()),t.xp6(3),t.Q6J("disabled",n.saving),t.xp6(1),t.Q6J("ngIf",!n.saving),t.xp6(1),t.Q6J("ngIf",n.saving),t.xp6(1),t.hij(" ","create"===n.mode?"\u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062d\u0633\u0627\u0628":"\u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062d\u0633\u0627\u0628"," "),t.xp6(1),t.Q6J("ngIf","edit"===n.mode))},directives:[r.Gu,r.sr,r.Sm,r.YG,r.gu,r.wd,r.W2,r.PM,r.Zi,r.Dq,r.FN,r.Q$,r.pK,r.j9,g.Q7,g.JJ,g.On,r.t9,r.QI,A.sg,A.O5,r.as,r.n0,r.g2,g.nD,r.PQ],styles:['[_ngcontent-%COMP%]:root{--liquid-glass-bg: rgba(255, 255, 255, .15);--liquid-glass-bg-light: rgba(255, 255, 255, .25);--liquid-glass-bg-dark: rgba(0, 0, 0, .15);--liquid-glass-border: rgba(255, 255, 255, .2);--liquid-glass-shadow: 0 8px 32px rgba(0, 0, 0, .15);--liquid-glass-highlight: rgba(255, 255, 255, .4);--glass-blur: 20px;--glass-border-radius: 20px;--glass-border-radius-small: 12px;--glass-accent-primary: rgba(0, 122, 255, .8);--glass-accent-success: rgba(52, 199, 89, .8);--glass-accent-danger: rgba(255, 59, 48, .8);--glass-transition: all .3s cubic-bezier(.4, 0, .2, 1)}@media (prefers-color-scheme: dark){[_ngcontent-%COMP%]:root{--liquid-glass-bg: rgba(0, 0, 0, .25);--liquid-glass-bg-light: rgba(255, 255, 255, .1);--liquid-glass-bg-dark: rgba(0, 0, 0, .4);--liquid-glass-border: rgba(255, 255, 255, .1);--liquid-glass-shadow: 0 8px 32px rgba(0, 0, 0, .3);--liquid-glass-highlight: rgba(255, 255, 255, .2)}}.transparent-header[_ngcontent-%COMP%]{background:transparent;box-shadow:none;border:none}.transparent-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--border-width: 0;--border-color: transparent;--color: rgba(0, 0, 0, .8);--min-height: 60px;backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);background:linear-gradient(180deg,rgba(255,255,255,.25) 0%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.05) 100%);border-bottom:1px solid rgba(255,255,255,.1)}.transparent-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:50%;background:linear-gradient(180deg,rgba(255,255,255,.3) 0%,transparent 100%);opacity:.6;pointer-events:none}.transparent-toolbar[_ngcontent-%COMP%]   .glass-title[_ngcontent-%COMP%]{color:#000c;font-weight:700;font-size:1.1rem;text-shadow:0 1px 2px rgba(255,255,255,.5)}.transparent-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .15);--color: rgba(0, 0, 0, .8);--border-radius: var(--glass-border-radius-small);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2);transition:var(--glass-transition)}.transparent-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--background: rgba(255, 255, 255, .25);transform:translateY(-2px)}.transparent-toolbar[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]{--background: var(--glass-accent-primary);--color: white;border-color:var(--glass-accent-primary)}.transparent-toolbar[_ngcontent-%COMP%]   ion-button[color=primary][_ngcontent-%COMP%]:hover{--background: rgba(0, 122, 255, .9);transform:translateY(-2px);box-shadow:0 4px 12px #007aff4d}.modern-content[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 50%,#667eea 100%);background-size:400% 400%;animation:gradientShift 15s ease infinite;min-height:100vh;direction:rtl;--color: rgba(0, 0, 0, .8);padding:0}@keyframes gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.form-container[_ngcontent-%COMP%]{padding:1.5rem;max-width:800px;margin:0 auto;display:flex;flex-direction:column;gap:1.5rem;min-height:100vh}.account-card[_ngcontent-%COMP%]{margin:0;border-radius:var(--glass-border-radius);background:var(--liquid-glass-bg);backdrop-filter:blur(var(--glass-blur));-webkit-backdrop-filter:blur(var(--glass-blur));border:.5px solid rgba(128,128,128,.3);box-shadow:0 10px 30px #00000026,0 4px 8px #0000001a,var(--liquid-glass-shadow),0 0 0 1px var(--liquid-glass-highlight) inset,0 1px 0 var(--liquid-glass-highlight) inset;overflow:hidden;position:relative;transition:var(--glass-transition);transform-style:preserve-3d;perspective:1000px}.account-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:40%;background:linear-gradient(180deg,var(--liquid-glass-highlight) 0%,transparent 100%);opacity:.3;pointer-events:none;border-radius:var(--glass-border-radius) var(--glass-border-radius) 0 0;z-index:1}.account-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:var(--ion-color-primary, #3880ff);color:#fff;padding:1.5rem;position:relative;z-index:2}.account-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem;font-weight:700;margin:0;text-shadow:0 1px 2px rgba(0,0,0,.2)}.account-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:2rem;position:relative;z-index:2;background:transparent}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));grid-gap:1.5rem;gap:1.5rem;align-items:start}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1/-1}.form-label[_ngcontent-%COMP%]{color:#000c;font-weight:600;font-size:.9rem;margin-bottom:.5rem;text-shadow:0 1px 2px rgba(255,255,255,.5)}.form-input[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .3);--color: rgba(0, 0, 0, .8);--placeholder-color: rgba(0, 0, 0, .5);--border-radius: var(--glass-border-radius-small);--padding: .75rem 1rem;border:1px solid rgba(255,255,255,.3);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);transition:var(--glass-transition);font-size:.9rem;box-shadow:0 2px 8px #0000001a}.form-input[_ngcontent-%COMP%]:focus-within{--background: rgba(255, 255, 255, .4);border-color:var(--glass-accent-primary);box-shadow:0 0 0 3px #007aff33;transform:translateY(-2px)}.form-select[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .3);--color: rgba(0, 0, 0, .8);--placeholder-color: rgba(0, 0, 0, .5);--border-radius: var(--glass-border-radius-small);--padding: .75rem 1rem;border:1px solid rgba(255,255,255,.3);backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);transition:var(--glass-transition);font-size:.9rem;box-shadow:0 2px 8px #0000001a;position:relative;z-index:1;cursor:pointer}.form-select[_ngcontent-%COMP%]:focus-within{--background: rgba(255, 255, 255, .4);border-color:var(--glass-accent-primary);box-shadow:0 0 0 3px #007aff33;transform:translateY(-2px);z-index:10}.form-select.select-expanded[_ngcontent-%COMP%]{z-index:100;transform:translateY(-2px)}.form-textarea[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .3);--color: rgba(0, 0, 0, .8);--placeholder-color: rgba(0, 0, 0, .5);--border-radius: var(--glass-border-radius-small);--padding: .75rem 1rem;border:1px solid rgba(255,255,255,.3);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);transition:var(--glass-transition);font-size:.9rem;box-shadow:0 2px 8px #0000001a;resize:vertical}.form-textarea[_ngcontent-%COMP%]:focus-within{--background: rgba(255, 255, 255, .4);border-color:var(--glass-accent-primary);box-shadow:0 0 0 3px #007aff33;transform:translateY(-2px)}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:.5rem}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .2);--color: rgba(0, 0, 0, .8);--border-radius: var(--glass-border-radius-small);--padding: .5rem 1rem;border:1px solid rgba(255,255,255,.3);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);transition:var(--glass-transition);margin:0}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]:hover{--background: rgba(255, 255, 255, .3);transform:translateY(-1px)}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%]{--color: var(--glass-accent-primary);--color-checked: var(--glass-accent-primary)}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#000c;font-weight:500;font-size:.9rem;margin-left:.5rem}.action-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-gap:1rem;gap:1rem;margin-top:auto;padding-top:1rem}.action-buttons-container[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,.2)}.buttons-row[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;align-items:center}.action-btn[_ngcontent-%COMP%]{--border-radius: var(--glass-border-radius-small);--padding: .75rem 1.5rem;font-weight:600;font-size:.9rem;transition:var(--glass-transition);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:0 2px 8px #0000001a;width:200px;max-width:100%}.action-btn[_ngcontent-%COMP%]:hover:not([disabled]){transform:translateY(-2px)}.action-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1rem}.cancel-btn[_ngcontent-%COMP%]{--background: transparent;--color: rgba(0, 0, 0, .6);--border-color: rgba(255, 255, 255, .5);--border-radius: var(--glass-border-radius-small);--padding: .75rem 1.5rem;font-weight:600;font-size:.9rem;transition:var(--glass-transition);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.5);box-shadow:0 2px 8px #0000001a}.cancel-btn[_ngcontent-%COMP%]:hover{--background: rgba(255, 255, 255, .2);--color: rgba(0, 0, 0, .8);transform:translateY(-2px);box-shadow:0 4px 12px #ffffff4d}.save-btn[_ngcontent-%COMP%]{--background: var(--glass-accent-primary);--color: white;border:1px solid var(--glass-accent-primary);box-shadow:0 2px 8px #007aff33}.save-btn[_ngcontent-%COMP%]:hover:not([disabled]){--background: rgba(0, 122, 255, .9);box-shadow:0 4px 12px #007aff4d}.save-btn[disabled][_ngcontent-%COMP%]{--background: rgba(0, 122, 255, .5);--color: rgba(255, 255, 255, .7);opacity:.6}.delete-btn[_ngcontent-%COMP%]{--background: var(--glass-accent-danger);--color: white;border:1px solid var(--glass-accent-danger);box-shadow:0 2px 8px #ff3b3033}.delete-btn[_ngcontent-%COMP%]:hover:not([disabled]){--background: rgba(255, 59, 48, .9);box-shadow:0 4px 12px #ff3b304d}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:1rem}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.action-buttons[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.75rem}.action-buttons-container[_ngcontent-%COMP%]{margin-top:1rem;padding-top:.75rem}.buttons-row[_ngcontent-%COMP%]{flex-direction:column;gap:.75rem}.action-btn[_ngcontent-%COMP%]{width:100%;max-width:250px}.account-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{padding:1rem}.account-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:1rem}}@media (max-width: 480px){.form-container[_ngcontent-%COMP%]{padding:.5rem}.radio-group[_ngcontent-%COMP%]   .radio-options[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}']}),i})()},32724:(M,m,c)=>{c.d(m,{n:()=>f});var l=c(591),t=c(5529),r=c(29863);let f=(()=>{class d{constructor(){this.newAccountSubject=new l.X(null),this.newAccount$=this.newAccountSubject.asObservable(),this.customerSelectedSubject=new t.xQ,this.customerSelected$=this.customerSelectedSubject.asObservable()}setNewAccount(s){console.log("AccountCommunicationService: Setting new account:",s),this.newAccountSubject.next(s),s&&s.id&&this.customerSelectedSubject.next({id:s.id,account:s})}setCustomerSelected(s,g){console.log("AccountCommunicationService: Customer selected with ID:",s),this.customerSelectedSubject.next({id:s,account:g})}clearNewAccount(){this.newAccountSubject.next(null)}getCurrentAccount(){return this.newAccountSubject.value}}return d.\u0275fac=function(s){return new(s||d)},d.\u0275prov=r.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);