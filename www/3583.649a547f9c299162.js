"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3583],{13583:(R,f,h)=>{h.r(f),h.d(f,{PrchOrderRecordPageModule:()=>D});var l=h(69808),u=h(34182),o=h(23349),d=h(94030),p=h(70655),y=h(4441),t=h(29863),A=h(90849),Z=h(91472);function m(s,a){1&s&&(t.TgZ(0,"ion-text",6),t._uU(1,"\u0645\u062a\u0635\u0644"),t.qZA())}function T(s,a){1&s&&(t.TgZ(0,"ion-text",6),t._uU(1,"\u063a\u064a\u0631 \u0645\u062a\u0635\u0644"),t.qZA())}function b(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"ion-item",20),t.TgZ(1,"input",21),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw(2).startingDate=r}),t.qZA(),t.qZA()}if(2&s){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.startingDate)}}function x(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"ion-col",13),t.TgZ(1,"ion-item",20),t.TgZ(2,"input",22),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw(2).endDate=r}),t.qZA(),t.qZA(),t.qZA()}if(2&s){const e=t.oxw(2);t.xp6(2),t.Q6J("ngModel",e.endDate)}}function P(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"ion-grid"),t.TgZ(1,"ion-row",7),t.TgZ(2,"ion-col",8),t.TgZ(3,"ion-card",9),t.TgZ(4,"ion-grid",9),t.TgZ(5,"ion-row"),t.TgZ(6,"ion-col",8),t.TgZ(7,"ion-grid",9),t.TgZ(8,"ion-row",7),t.TgZ(9,"ion-radio-group",10),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().radioVal=r})("ionChange",function(r){return t.CHM(e),t.oxw().radioChange(r)}),t.TgZ(10,"ion-grid",9),t.TgZ(11,"ion-row"),t.TgZ(12,"ion-col",9),t.TgZ(13,"ion-item",11),t._UZ(14,"ion-radio",12),t.TgZ(15,"ion-label"),t._uU(16,"\u0637\u0644\u0628\u0627\u062a \u0634\u0631\u0627\u0621 \u062d\u062f\u064a\u062b\u0629"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"ion-row",7),t.TgZ(18,"ion-col",13),t.YNc(19,b,2,1,"ion-item",14),t.qZA(),t.YNc(20,x,3,1,"ion-col",15),t.TgZ(21,"ion-col",16),t.TgZ(22,"ion-item",11),t.TgZ(23,"ion-buttons",17),t.TgZ(24,"ion-button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().search()}),t._UZ(25,"ion-icon",19),t.TgZ(26,"ion-label"),t.TgZ(27,"ion-text",6),t._uU(28,"\u0628\u062d\u0640\u0640\u062b"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&s){const e=t.oxw();t.xp6(9),t.Q6J("ngModel",e.radioVal),t.xp6(5),t.Q6J("value",0),t.xp6(5),t.Q6J("ngIf",0!=e.radioVal),t.xp6(1),t.Q6J("ngIf",2==e.radioVal)}}function O(s,a){if(1&s){const e=t.EpF();t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t.TgZ(12,"ion-button",28),t.NdJ("click",function(){const n=t.CHM(e).$implicit;return t.oxw(2).getPayInvoDetail(n,n.sub_name,"edit")}),t._UZ(13,"ion-icon",29),t.qZA(),t.qZA(),t.TgZ(14,"td"),t.TgZ(15,"ion-button",28),t.NdJ("click",function(){const n=t.CHM(e).$implicit;return t.oxw(2).printInvo("printarea",n)}),t._UZ(16,"ion-icon",30),t.qZA(),t.qZA(),t.TgZ(17,"td"),t.TgZ(18,"ion-button",28),t.NdJ("click",function(){const n=t.CHM(e).$implicit;return t.oxw(2).printInvoEn("printarea",n)}),t._UZ(19,"ion-icon",30),t.qZA(),t.qZA(),t.qZA()}if(2&s){const e=a.$implicit,i=a.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.sub_name),t.xp6(2),t.hij(" ",e.pay_date,""),t.xp6(2),t.Oqu(e.tot_pr),t.xp6(2),t.Oqu(e.payComment)}}function q(s,a){1&s&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",31),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",31),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",31),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",31),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",31),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",31),t.qZA(),t.qZA())}function v(s,a){1&s&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",31),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",31),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",31),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",31),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",31),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",31),t.qZA(),t.qZA())}function I(s,a){1&s&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._UZ(2,"ion-skeleton-text",31),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"ion-skeleton-text",31),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"ion-skeleton-text",31),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"ion-skeleton-text",31),t.qZA(),t.TgZ(9,"td"),t._UZ(10,"ion-skeleton-text",31),t.qZA(),t.TgZ(11,"td"),t._UZ(12,"ion-skeleton-text",31),t.qZA(),t.TgZ(13,"td"),t._UZ(14,"ion-skeleton-text",31),t.qZA(),t.qZA())}function L(s,a){1&s&&(t.TgZ(0,"ion-row",32),t.TgZ(1,"ion-col",33),t.TgZ(2,"ion-label"),t._UZ(3,"ion-icon",34),t.qZA(),t.TgZ(4,"h4"),t._uU(5," \u0644\u0627 \u062a\u0648\u062c\u062f \u0633\u062c\u0644\u0627\u062a "),t.qZA(),t.qZA(),t.qZA())}function M(s,a){if(1&s&&(t.TgZ(0,"ion-grid",23),t.TgZ(1,"ion-row",7),t.TgZ(2,"ion-col",24),t.TgZ(3,"ion-grid"),t.TgZ(4,"ion-row"),t.TgZ(5,"ion-col",8),t.TgZ(6,"ion-card"),t.TgZ(7,"table",25),t.TgZ(8,"tr"),t.TgZ(9,"th"),t._uU(10,"\u0627\u0644\u062a\u0633\u0644\u0633\u0644"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"\u0627\u0644\u0639\u0645\u064a\u0644"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"\u0627\u0644\u062a\u0627\u0631\u064a\u062e"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"\u0627\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u0628\u0644\u063a"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"\u062a\u0639\u0644\u064a\u0642"),t.qZA(),t.TgZ(19,"th"),t.TgZ(20,"strong"),t._uU(21,"\u062a\u0639\u062f\u064a\u0644"),t.qZA(),t.qZA(),t.TgZ(22,"th"),t.TgZ(23,"strong"),t._uU(24,"\u0637\u0628\u0627\u0639\u0629 \u0628\u0627\u0644\u063a\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629"),t.qZA(),t.qZA(),t.TgZ(25,"th"),t.TgZ(26,"strong"),t._uU(27,"\u0637\u0628\u0627\u0639\u0629 \u0628\u0627\u0644\u063a\u0629 \u0627\u0644\u0625\u0646\u062c\u0644\u064a\u0632\u064a\u0629"),t.qZA(),t.qZA(),t.qZA(),t.YNc(28,O,20,5,"tr",26),t.YNc(29,q,13,0,"tr",4),t.YNc(30,v,13,0,"tr",4),t.YNc(31,I,15,0,"tr",4),t.qZA(),t.YNc(32,L,6,0,"ion-row",27),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&s){const e=t.oxw();t.xp6(28),t.Q6J("ngForOf",e.payArray),t.xp6(1),t.Q6J("ngIf",1==e.loading),t.xp6(1),t.Q6J("ngIf",1==e.loading),t.xp6(1),t.Q6J("ngIf",1==e.loading),t.xp6(1),t.Q6J("ngIf",1==e.showEmpty)}}function w(s,a){if(1&s&&(t.TgZ(0,"ion-footer"),t.TgZ(1,"ion-grid",7),t.TgZ(2,"ion-row"),t.TgZ(3,"ion-col"),t.TgZ(4,"ion-label"),t.TgZ(5,"ion-text"),t._uU(6,"\u0625\u062c\u0645\u0627\u0644\u064a : "),t.qZA(),t._UZ(7,"br"),t.TgZ(8,"strong"),t._uU(9),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&s){const e=t.oxw();t.xp6(9),t.Oqu(e.sums.tot.toFixed(2))}}const C=[{path:"",component:(()=>{class s{constructor(e,i,r,n,c,g,N){this.rout=e,this.storage=i,this.modalController=r,this.loadingController=n,this.datePipe=c,this.api=g,this.toast=N,this.payArray=[],this.printArr=[],this.sub_account=[],this.sub_accountLocalPurch=[],this.sub_accountPurch=[],this.printMode=!1,this.itemList=[],this.radioVal=0,this.loading=!1,this.showEmpty=!1,this.offline=!1,this.purchLocal=[],this.purchase=[],this.purchOffline=[],this.color="dark",this.selectedAccount={id:"",ac_id:"",sub_name:"",sub_type:"",sub_code:"",sub_balance:"",store_id:"",cat_name:"",cat_id:""},this.sums={pay:0,change:0,discount:0,tot:0,totAfterDiscout:0},this.getAppInfo(),this.prepareOffline();let _=new Date;this.startingDate=this.datePipe.transform(_,"yyyy-MM-dd"),this.endDate=this.datePipe.transform(_,"yyyy-MM-dd")}ngOnInit(){this.payArray=[],this.getAppInfo(),this.prepareOffline()}ionViewDidEnter(){this.payArray=[],this.purchLocal=[],this.purchOffline=[],this.purchase=[]}clear(){this.selectedAccount={id:"",ac_id:"",sub_name:"",sub_type:"",sub_code:"",sub_balance:"",store_id:"",cat_name:"",cat_id:""},this.payArray=[],this.purchLocal=[],this.showEmpty=!1,this.loading=!1}changeMode(){1==this.offline?(this.offline=!1,this.color="primary"):0==this.offline&&(this.offline=!0,this.color="dark"),this.storage.set("offline",this.offline).then(e=>{})}getOffliemode(){this.storage.get("offline").then(e=>{this.offline=e,this.color=1==this.offline?"dark":"primary"})}getAppInfo(){this.getOffliemode(),this.storage.get("USER_INFO").then(e=>{e&&(this.user_info=e)}),this.storage.get("year").then(e=>{e&&(this.year=e)}),this.storage.get("STORE_INFO").then(e=>{e&&(this.store_info=e,this.getSalesAccount())}),this.storage.get("purchase").then(e=>{e&&(this.purchase=e)})}prepareOffline(){this.storage.get("sub_accountLocalPurch").then(e=>{e&&(this.sub_accountLocalPurch=e)}),this.storage.get("sub_accountPurch").then(e=>{e&&(this.sub_accountPurch=e)})}getSalesAccount(){0==this.offline?this.api.getPerchAccounts(this.store_info.id,this.year.id).subscribe(e=>{this.sub_account=e.data,this.addSubaccountLocal()},e=>{}):this.MixSubaccountSalesOffline()}MixSubaccountSalesOffline(){if(this.sub_account=[],this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account.push(this.sub_accountLocalPurch[e]);if(this.sub_accountPurch)for(let e=0;e<this.sub_accountPurch.length;e++)this.sub_account.push(this.sub_accountPurch[e])}addSubaccountLocal(){if(this.sub_account){if(this.sub_accountLocalPurch)for(let e=0;e<this.sub_accountLocalPurch.length;e++)this.sub_account.push(this.sub_accountLocalPurch[e])}else this.sub_accountLocalPurch&&(this.sub_account=this.sub_accountLocalPurch)}printInvo(e,i){if(0==this.offline&&null!=i.pay_id)this.paInvo=i,this.api.getPerchOrderInvoDetail(this.store_info.id,i.pay_ref).subscribe(r=>{this.itemList=r.data,this.printArr=[],this.printArr.push({payInvo:this.paInvo,itemList:this.itemList,selectedAccount:this.paInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderAr-record")},r=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{});else if(0==this.offline&&null==i.pay_id){console.log(i,i);let r=[];r=this.purchLocal.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderAr-record")}else if(1==this.offline&&null!=i.pay_id){let r=[];r=this.purchase.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderAr-record")}else if(1==this.offline&&null==i.pay_id){let r=[];r=this.purchLocal.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderAr-record")}}printInvoEn(e,i){if(0==this.offline&&null!=i.pay_id)this.paInvo=i,this.api.getPerchOrderInvoDetail(this.store_info.id,i.pay_ref).subscribe(r=>{this.itemList=r.data,this.printArr=[],this.printArr.push({payInvo:this.paInvo,itemList:this.itemList,selectedAccount:this.paInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderEn-record")},r=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")},()=>{});else if(0==this.offline&&null==i.pay_id){console.log(i,i);let r=[];r=this.purchLocal.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderEn-record")}else if(1==this.offline&&null!=i.pay_id){let r=[];r=this.purchase.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderEn-record")}else if(1==this.offline&&null==i.pay_id){let r=[];r=this.purchLocal.filter(n=>n.payInvo.pay_ref==i.pay_ref),this.printArr=[],this.printArr.push({payInvo:r[0].payInvo,itemList:r[0].itemList,selectedAccount:r[0].payInvo.sub_name,sub_nameNew:""}),this.presentModal(this.printArr,"perchOrderEn-record")}}presentModal(e,i){return(0,p.mG)(this,void 0,void 0,function*(){const r=yield this.modalController.create({component:y.n,componentProps:{printArr:this.printArr,page:i}});return r.onDidDismiss().then(n=>{}),yield r.present()})}preparedPrin(e,i,r){e&&i&&r&&(this.printMode=!0,this.Print(e,this.paInvo,this.itemList))}pickAccount(e){let i=this.sub_account.filter(r=>r.sub_name==e.target.value);i.length>0?(this.selectedAccount={id:i[0].id,ac_id:i[0].ac_id,sub_name:i[0].sub_name,sub_type:i[0].sub_type,sub_code:i[0].sub_code,store_id:i[0].store_id,sub_balance:i[0].sub_balance,cat_id:i[0].cat_id,cat_name:i[0].cat_name},this.payArray=[],this.purchLocal=[],this.showEmpty=!1,this.loading=!1):(this.presentToast("\u062e\u0637\u0623 \u0641\u064a \u0627\u0633\u0645 \u0627\u0644\u062d\u0633\u0627\u0628 ","danger"),this.selectedAccount.sub_name="")}Print(e,i,r){if(e&&i&&r){var n=window.open("","PRINT","height=400,width=600");return n.document.write("<html><head>"),n.document.write('<style type="text/css">'),n.document.write(".flr{ display: block; float: right; } .show{ } .hide{width:0px;height:0px} .w45 {width:45%} .w50 {width:50%} .w100 {width:100%} td, th {border: 1px solid #dddddd;text-align: center;padding: 8px;} tr:nth-child(even) {background-color: #dddddd;} .table{text-align: center;width: 100%; margin: 12px;}.ion-margin{ margin: 10px; } .ion-margin-top{ margin-top: 10px; } .rtl {  direction: rtl; } .ion-text-center{ text-align: center; } .ion-text-end{ text-align: left; } .ion-text-start{ text-align: right; }"),n.document.write("</style></head><body>"),n.document.write(document.getElementById(e).innerHTML),n.document.write("</body></html>"),n.document.close(),n.focus(),n.print(),n.close(),this.printMode=!1,!0}}getSalesfromLocal(){this.purchLocal=[],this.storage.get("purchLocal").then(e=>{e&&(this.purchLocal=e)})}getSalesOffline(){this.purchOffline=[],this.storage.get("sales").then(e=>{e&&(this.purchOffline=e)})}getTotal(){this.sums.tot=this.payArray.reduce((e,i)=>e+ +i.tot_pr,0),this.sums.change=this.payArray.reduce((e,i)=>e+ +i.changee,0),this.sums.pay=this.payArray.reduce((e,i)=>e+ +i.pay,0),this.sums.discount=this.payArray.reduce((e,i)=>e+ +i.discount,0),this.sums.totAfterDiscout=+this.sums.tot-this.sums.discount}search(){this.showEmpty=!1,0==this.radioVal&&(1==this.offline?this.presentToast("\u0644\u0627 \u064a\u0648\u062c\u062f \u0627\u062a\u0635\u0627\u0644 \u0628\u0627\u0644\u0625\u0646\u062a\u0631\u0646\u062a","danger"):this.getTopSales())}getTopSales(){this.loading=!0,this.api.getTopOrderPerch(this.store_info.id).subscribe(e=>{"No record Found"!=e.message&&(this.payArray=e.data),this.showEmpty=0==this.payArray.length,""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(r=>+r.cust_id==+this.selectedAccount.id)),this.getTotal()},e=>{},()=>{this.loading=!1})}getTopSalesOffline(){this.payArray=[],this.purchLocal=[],this.purchOffline=[],this.purchase=[],this.storage.get("purchLocal").then(e=>{if(e){let i=[];if(i=e,this.purchLocal=i,i.length>0)for(let r=0;r<i.length;r++)this.payArray.push(i[r].payInvo)}this.storage.get("purchase").then(i=>{if(i){let r=[];if(r=i,this.purchOffline=r,this.purchase=this.purchOffline,r.length>0)for(let n=0;n<r.length;n++)this.payArray.push(r[n].payInvo)}this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1}),""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(i=>+i.cust_id==+this.selectedAccount.id)),this.getTotal()})}getSalesByDate(){this.payArray=[],this.purchLocal=[],this.purchOffline=[],this.purchase=[],this.getSalesfromLocal(),this.loading=!0,this.api.getPerchByDate(this.store_info.id,this.startingDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message&&(this.payArray=e.data),this.purchLocal.length>0){this.purchLocal=this.purchLocal.filter(r=>null==r.payInvo.pay_id&&r.payInvo.pay_date==this.startingDate);for(let r=0;r<this.purchLocal.length;r++)this.payArray.push(this.purchLocal[r].payInvo);this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1}""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(r=>+r.cust_id==+this.selectedAccount.id)),this.getTotal()},e=>{},()=>{this.loading=!1})}getSalesByDateOffline(){this.payArray=[],this.purchLocal=[],this.purchOffline=[],this.purchase=[],this.loading=!0,this.storage.get("purchLocal").then(e=>{if(e){this.purchLocal=e;let i=[];if(i=this.purchLocal.filter(r=>r.payInvo.pay_date==this.startingDate),i.length>0)for(let r=0;r<i.length;r++)this.payArray.push(i[r].payInvo)}this.storage.get("purchase").then(i=>{if(i){this.purchOffline=i,this.purchase=this.purchOffline;let r=[];if(r=this.purchOffline.filter(n=>n.payInvo.pay_date==this.startingDate),r.length>0)for(let n=0;n<r.length;n++)this.payArray.push(r[n].payInvo)}this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1}),""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(i=>+i.cust_id==+this.selectedAccount.id)),""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(i=>+i.cust_id==+this.selectedAccount.id)),this.getTotal()})}getSales2Date(){this.payArray=[],this.purchLocal=[],this.purchOffline=[],this.purchase=[],this.getSalesfromLocal(),this.loading=!0,this.api.getPerch2Date(this.store_info.id,this.startingDate,this.endDate,this.year.id).subscribe(e=>{if("No record Found"!=e.message&&(this.payArray=e.data),this.purchLocal.length>0){this.purchLocal=this.purchLocal.filter(r=>r.payInvo.pay_date>=this.startingDate&&r.payInvo.pay_date<=this.endDate);for(let r=0;r<this.purchLocal.length;r++)this.payArray.push(this.purchLocal[r].payInvo);this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1}""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(r=>+r.cust_id==+this.selectedAccount.id)),this.getTotal()},e=>{},()=>{this.loading=!1})}getSales2DateOffline(){this.payArray=[],this.purchLocal=[],this.purchase=[],this.purchOffline=[],this.loading=!0,this.storage.get("purchLocal").then(e=>{if(e){this.purchLocal=e;let i=[];if(i=this.purchLocal.filter(r=>r.payInvo.pay_date>=this.startingDate&&r.payInvo.pay_date<=this.endDate),i.length>0)for(let r=0;r<i.length;r++)this.payArray.push(i[r].payInvo)}this.storage.get("purchase").then(i=>{if(i){this.purchOffline=i,this.purchase=this.purchOffline;let r=[];if(r=this.purchOffline.filter(n=>n.payInvo.pay_date>=this.startingDate&&n.payInvo.pay_date<=this.endDate),r.length>0)for(let n=0;n<r.length;n++)this.payArray.push(r[n].payInvo)}this.getTotal(),this.showEmpty=0==this.payArray.length,this.loading=!1}),""!=this.selectedAccount.sub_name&&this.payArray.length>0&&(this.payArray=this.payArray.filter(i=>+i.cust_id==+this.selectedAccount.id)),this.getTotal()})}radioChange(e){this.payArray=[],this.purchLocal=[],this.showEmpty=!1,this.loading=!1}getPayInvoDetail(e,i,r){console.log(e,i,r),this.presentLoadingWithOptions("\u062c\u0627\u0631\u064a \u062c\u0644\u0628 \u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644 ..."),0==this.offline&&null!=e.pay_id&&this.api.getPerchOrderInvoDetail(this.store_info.id,e.pay_ref).subscribe(n=>{let c=n,g={queryParams:{payInvo:JSON.stringify(e),sub_name:JSON.stringify(i),user_info:JSON.stringify(this.user_info),store_info:JSON.stringify(this.store_info),itemList:JSON.stringify(c.data)}};this.rout.navigate(["folder/edit-prch-order"],g)},n=>{this.presentToast("\u062e\u0637\u0627 \u0641\u064a \u0627\u0644\u0625\u062a\u0635\u0627\u0644 \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0627\u062e\u0631\u064a","danger")})}presentToast(e,i){return(0,p.mG)(this,void 0,void 0,function*(){(yield this.toast.create({message:e,duration:2e3,color:i,cssClass:"cust_Toast",mode:"ios",position:"top"})).present()})}presentLoadingWithOptions(e){return(0,p.mG)(this,void 0,void 0,function*(){const i=yield this.loadingController.create({spinner:"bubbles",mode:"ios",duration:3e3,message:e,translucent:!0,backdropDismiss:!1});yield i.present(),yield i.onDidDismiss()})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(d.F0),t.Y36(A.K),t.Y36(o.IN),t.Y36(o.HT),t.Y36(l.uU),t.Y36(Z.r),t.Y36(o.yF))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-prch-order-record"]],decls:17,vars:6,consts:[["slot","start"],["fill","clear","slot","end",1,"ion-margin",3,"click"],["name","wifi-outline",2,"font-size","20px",3,"color"],["color","dark",4,"ngIf"],[4,"ngIf"],["class","ion-margin-top",4,"ngIf"],["color","dark"],["dir","rtl"],["size","12"],[1,"ion-no-padding","ion-no-margin"],[3,"ngModel","ngModelChange","ionChange"],["lines","none"],[1,"ion-margin-end",3,"value"],["size","4"],["class","custInput",4,"ngIf"],["size","4",4,"ngIf"],["size","4",1,"ion-text-end"],["slot","end"],["fill","outline","color","success",3,"click"],["name","search-outline","color","success"],[1,"custInput"],["type","date","id","startingDate","name","startingDate",2,"width","100%",3,"ngModel","ngModelChange"],["type","date","id","endDate","name","endDate",2,"width","100%",3,"ngModel","ngModelChange"],[1,"ion-margin-top"],["size","12",1,"ion-no-padding"],[1,"table"],[4,"ngFor","ngForOf"],["class","ion-justify-content-center ion-margin-top",4,"ngIf"],["fill","clear","size","small",3,"click"],["name","create-outline","color","success"],["name","print","color","brimary"],["animated","",2,"width","100%"],[1,"ion-justify-content-center","ion-margin-top"],["size","4",1,"ion-text-center"],["name","archive-outline",2,"font-size","30px"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header"),t.TgZ(1,"ion-toolbar"),t.TgZ(2,"ion-buttons",0),t._UZ(3,"ion-menu-button"),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"\u0633\u062c\u0644 \u0627\u0648\u0627\u0645\u0631 \u0627\u0644\u0634\u0631\u0627\u0621"),t.qZA(),t.TgZ(6,"ion-button",1),t.NdJ("click",function(){return i.changeMode()}),t.TgZ(7,"ion-label"),t._UZ(8,"ion-icon",2),t.qZA(),t.TgZ(9,"ion-label"),t.YNc(10,m,2,0,"ion-text",3),t.qZA(),t.TgZ(11,"ion-label"),t.YNc(12,T,2,0,"ion-text",3),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"ion-content"),t.YNc(14,P,29,4,"ion-grid",4),t.YNc(15,M,33,5,"ion-grid",5),t.qZA(),t.YNc(16,w,10,1,"ion-footer",4)),2&e&&(t.xp6(8),t.Q6J("color",i.color),t.xp6(2),t.Q6J("ngIf","primary"==i.color),t.xp6(2),t.Q6J("ngIf","dark"==i.color),t.xp6(2),t.Q6J("ngIf",i.user_info&&i.store_info),t.xp6(1),t.Q6J("ngIf",i.user_info&&i.store_info),t.xp6(1),t.Q6J("ngIf",i.payArray))},directives:[o.Gu,o.sr,o.Sm,o.fG,o.wd,o.YG,o.Q$,o.gu,l.O5,o.W2,o.yW,o.jY,o.Nd,o.wI,o.PM,o.se,o.QI,u.JJ,u.On,o.Ie,o.B7,o.U5,u.Fj,l.sg,o.CK,o.fr],styles:[".custInput[_ngcontent-%COMP%]{border-style:solid;border-color:var(--ion-color-light);border-radius:5px}.show[_ngcontent-%COMP%]{visibility:visible}.hide[_ngcontent-%COMP%]{visibility:hidden}.cust-card[_ngcontent-%COMP%]{border-radius:5px}.custRow[_ngcontent-%COMP%]{margin-top:5rem}.table[_ngcontent-%COMP%]{text-align:center;width:100%;margin:12px}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#ddd}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:1px solid #dddddd;text-align:center;padding:8px;font-size:16px;font-weight:700;color:#000}"]}),s})()}];let U=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[d.Bz.forChild(C)],d.Bz]}),s})(),D=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[l.ez,u.u5,o.Pc,U]]}),s})()}}]);