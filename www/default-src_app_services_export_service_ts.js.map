{"version":3,"file":"default-src_app_services_export_service_ts.js","mappings":"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","sources":["./src/app/services/export.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { jsPDF } from 'jspdf';\r\nimport * as XLSX from 'xlsx';\r\nimport { DatePipe } from '@angular/common';\r\nimport { ToastController, LoadingController, AlertController } from '@ionic/angular';\r\n\r\nexport interface ExportConfig {\r\n  title: string;\r\n  subtitle?: string;\r\n  fileName: string;\r\n  data: any[];\r\n  columns: ExportColumn[];\r\n  userName: string;\r\n  pageType: 'sales-record' | 'purchase-record' | 'item-stock' | 'cash2' | 'statement2' | 'spend-record2' | 'balance-sheet2' | 'sub-account2';\r\n  currentDate?: string;\r\n  maxRows?: number;\r\n}\r\n\r\nexport interface ExportColumn {\r\n  key: string;\r\n  title: string;\r\n  width?: number;\r\n  type?: 'text' | 'number' | 'date' | 'currency';\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ExportService {\r\n  private readonly MAX_ROWS_WARNING = 1000;\r\n  private readonly MAX_ROWS_LIMIT = 5000;\r\n\r\n  constructor(\r\n    private datePipe: DatePipe,\r\n    private toastController: ToastController,\r\n    private loadingController: LoadingController,\r\n    private alertController: AlertController\r\n  ) {}\r\n\r\n  async exportToPDF(config: ExportConfig): Promise<void> {\r\n    // Check data size\r\n    if (!await this.checkDataSize(config.data.length)) {\r\n      return;\r\n    }\r\n\r\n    const loading = await this.loadingController.create({\r\n      message: 'جاري تصدير ملف PDF...',\r\n      spinner: 'crescent'\r\n    });\r\n    await loading.present();\r\n\r\n    try {\r\n      const doc = new jsPDF({\r\n        orientation: 'landscape',\r\n        unit: 'mm',\r\n        format: 'a4'\r\n      });\r\n\r\n      // Set up Arabic font (using default for now)\r\n      doc.setFont('helvetica');\r\n      \r\n      // Add header\r\n      this.addPDFHeader(doc, config);\r\n      \r\n      // Add table\r\n      this.addPDFTable(doc, config);\r\n      \r\n      // Add footer\r\n      this.addPDFFooter(doc, config);\r\n\r\n      // Save the PDF\r\n      doc.save(`${config.fileName}.pdf`);\r\n      \r\n      await this.showSuccessToast('تم تصدير ملف PDF بنجاح');\r\n      \r\n    } catch (error) {\r\n      console.error('PDF Export Error:', error);\r\n      await this.showErrorToast('فشل في تصدير ملف PDF');\r\n    } finally {\r\n      await loading.dismiss();\r\n    }\r\n  }\r\n\r\n  async exportToExcel(config: ExportConfig): Promise<void> {\r\n    // Check data size\r\n    if (!await this.checkDataSize(config.data.length)) {\r\n      return;\r\n    }\r\n\r\n    const loading = await this.loadingController.create({\r\n      message: 'جاري تصدير ملف Excel...',\r\n      spinner: 'crescent'\r\n    });\r\n    await loading.present();\r\n\r\n    try {\r\n      // Create workbook\r\n      const wb = XLSX.utils.book_new();\r\n      \r\n      // Prepare data\r\n      const worksheetData = this.prepareExcelData(config);\r\n      \r\n      // Create worksheet\r\n      const ws = XLSX.utils.aoa_to_sheet(worksheetData);\r\n      \r\n      // Set column widths\r\n      const colWidths = config.columns.map(col => ({ wch: col.width || 15 }));\r\n      ws['!cols'] = colWidths;\r\n      \r\n      // Add worksheet to workbook\r\n      XLSX.utils.book_append_sheet(wb, ws, 'البيانات');\r\n      \r\n      // Write file\r\n      XLSX.writeFile(wb, `${config.fileName}.xlsx`);\r\n      \r\n      await this.showSuccessToast('تم تصدير ملف Excel بنجاح');\r\n      \r\n    } catch (error) {\r\n      console.error('Excel Export Error:', error);\r\n      await this.showErrorToast('فشل في تصدير ملف Excel');\r\n    } finally {\r\n      await loading.dismiss();\r\n    }\r\n  }\r\n\r\n  private async checkDataSize(rowCount: number): Promise<boolean> {\r\n    if (rowCount === 0) {\r\n      await this.showErrorToast('لا توجد بيانات للتصدير');\r\n      return false;\r\n    }\r\n\r\n    if (rowCount > this.MAX_ROWS_LIMIT) {\r\n      await this.showErrorToast(`البيانات كثيرة جداً (${rowCount} صف). الحد الأقصى هو ${this.MAX_ROWS_LIMIT} صف`);\r\n      return false;\r\n    }\r\n\r\n    if (rowCount > this.MAX_ROWS_WARNING) {\r\n      return await this.showConfirmationAlert(\r\n        'تحذير',\r\n        `البيانات كثيرة (${rowCount} صف). قد يستغرق التصدير وقتاً طويلاً. هل تريد المتابعة؟`\r\n      );\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  private addPDFHeader(doc: jsPDF, config: ExportConfig): void {\r\n    const pageWidth = doc.internal.pageSize.getWidth();\r\n    \r\n    // Current date\r\n    doc.setFontSize(10);\r\n    doc.text(config.currentDate || this.datePipe.transform(new Date(), 'yyyy-MM-dd') || '', 10, 10);\r\n    \r\n    // Title\r\n    doc.setFontSize(16);\r\n    const titleWidth = doc.getTextWidth(config.title);\r\n    doc.text(config.title, (pageWidth - titleWidth) / 2, 20);\r\n    \r\n    // Subtitle\r\n    if (config.subtitle) {\r\n      doc.setFontSize(12);\r\n      const subtitleWidth = doc.getTextWidth(config.subtitle);\r\n      doc.text(config.subtitle, (pageWidth - subtitleWidth) / 2, 30);\r\n    }\r\n  }\r\n\r\n  private addPDFTable(doc: jsPDF, config: ExportConfig): void {\r\n    const startY = config.subtitle ? 40 : 30;\r\n    const pageWidth = doc.internal.pageSize.getWidth();\r\n    const margin = 10;\r\n    const tableWidth = pageWidth - (margin * 2);\r\n    const columnWidth = tableWidth / config.columns.length;\r\n    \r\n    // Table headers\r\n    doc.setFontSize(10);\r\n    let currentY = startY;\r\n    \r\n    // Header background\r\n    doc.setFillColor(240, 240, 240);\r\n    doc.rect(margin, currentY, tableWidth, 10, 'F');\r\n    \r\n    // Header text\r\n    doc.setTextColor(0, 0, 0);\r\n    config.columns.forEach((col, index) => {\r\n      const x = margin + (index * columnWidth) + 2;\r\n      doc.text(col.title, x, currentY + 7);\r\n    });\r\n    \r\n    currentY += 10;\r\n    \r\n    // Table data\r\n    config.data.forEach((row, rowIndex) => {\r\n      if (currentY > doc.internal.pageSize.getHeight() - 30) {\r\n        doc.addPage();\r\n        currentY = 20;\r\n      }\r\n      \r\n      // Alternating row colors\r\n      if (rowIndex % 2 === 1) {\r\n        doc.setFillColor(250, 250, 250);\r\n        doc.rect(margin, currentY, tableWidth, 8, 'F');\r\n      }\r\n      \r\n      config.columns.forEach((col, colIndex) => {\r\n        const x = margin + (colIndex * columnWidth) + 2;\r\n        let value = this.getCellValue(row, col);\r\n        doc.text(value, x, currentY + 6);\r\n      });\r\n      \r\n      currentY += 8;\r\n    });\r\n  }\r\n\r\n  private addPDFFooter(doc: jsPDF, config: ExportConfig): void {\r\n    const pageHeight = doc.internal.pageSize.getHeight();\r\n    const pageWidth = doc.internal.pageSize.getWidth();\r\n    \r\n    doc.setFontSize(8);\r\n    doc.text(`المستخدم: ${config.userName}`, 10, pageHeight - 10);\r\n    doc.text(`تاريخ التصدير: ${this.datePipe.transform(new Date(), 'yyyy-MM-dd HH:mm')}`, pageWidth - 60, pageHeight - 10);\r\n  }\r\n\r\n  private prepareExcelData(config: ExportConfig): any[][] {\r\n    const data: any[][] = [];\r\n    \r\n    // Add header rows\r\n    data.push([config.title]);\r\n    if (config.subtitle) {\r\n      data.push([config.subtitle]);\r\n    }\r\n    data.push([config.currentDate || this.datePipe.transform(new Date(), 'yyyy-MM-dd')]);\r\n    data.push([]); // Empty row\r\n    \r\n    // Add column headers\r\n    data.push(config.columns.map(col => col.title));\r\n    \r\n    // Add data rows\r\n    config.data.forEach(row => {\r\n      const rowData = config.columns.map(col => this.getCellValue(row, col));\r\n      data.push(rowData);\r\n    });\r\n    \r\n    // Add footer\r\n    data.push([]); // Empty row\r\n    data.push([`المستخدم: ${config.userName}`]);\r\n    data.push([`تاريخ التصدير: ${this.datePipe.transform(new Date(), 'yyyy-MM-dd HH:mm')}`]);\r\n    \r\n    return data;\r\n  }\r\n\r\n  private getCellValue(row: any, column: ExportColumn): string {\r\n    let value: any;\r\n    \r\n    // Handle calculated fields\r\n    if (column.key === 'finalAmount') {\r\n      const total = parseFloat(row.tot_pr) || 0;\r\n      const discount = parseFloat(row.discount) || 0;\r\n      value = total - discount;\r\n    } else if (column.key === 'stockValue') {\r\n      const quantity = parseFloat(row.quantity) || 0;\r\n      const payPrice = parseFloat(row.pay_price) || 0;\r\n      value = quantity * payPrice;\r\n    } else {\r\n      value = this.getNestedValue(row, column.key);\r\n    }\r\n    \r\n    if (value === null || value === undefined) {\r\n      return '';\r\n    }\r\n    \r\n    switch (column.type) {\r\n      case 'currency':\r\n        return this.formatCurrency(value);\r\n      case 'date':\r\n        return this.datePipe.transform(value, 'yyyy-MM-dd') || value.toString();\r\n      case 'number':\r\n        return this.formatNumber(value);\r\n      default:\r\n        return value.toString();\r\n    }\r\n  }\r\n\r\n  private getNestedValue(obj: any, path: string): any {\r\n    return path.split('.').reduce((current, prop) => current && current[prop], obj);\r\n  }\r\n\r\n  private formatCurrency(value: any): string {\r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return '0.00';\r\n    \r\n    return new Intl.NumberFormat('en-US', {\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2\r\n    }).format(numValue);\r\n  }\r\n\r\n  private formatNumber(value: any): string {\r\n    const numValue = parseFloat(value);\r\n    if (isNaN(numValue)) return '0';\r\n    \r\n    return new Intl.NumberFormat('en-US').format(numValue);\r\n  }\r\n\r\n  generateDynamicTitle(pageType: string): string {\r\n    const titles: { [key: string]: string } = {\r\n      'sales-record': 'تقرير المبيعات',\r\n      'purchase-record': 'تقرير المشتريات',\r\n      'item-stock': 'تقرير المخزون',\r\n      'cash2': 'تقرير الخزينة',\r\n      'statement2': 'كشف الحساب',\r\n      'spend-record2': 'تقرير المصروفات',\r\n      'balance-sheet2': 'الميزانية العمومية',\r\n      'sub-account2': 'تقرير الحسابات الفرعية'\r\n    };\r\n    \r\n    return titles[pageType] || 'تقرير';\r\n  }\r\n\r\n  generateDynamicSubtitle(pageType: string, filters: any): string {\r\n    let subtitle = '';\r\n    \r\n    if (filters.selectedAccount && filters.selectedAccount.sub_name) {\r\n      if (pageType === 'sales-record') {\r\n        subtitle += `العميل: ${filters.selectedAccount.sub_name}`;\r\n      } else if (pageType === 'purchase-record') {\r\n        subtitle += `المورد: ${filters.selectedAccount.sub_name}`;\r\n      } else {\r\n        subtitle += `الحساب: ${filters.selectedAccount.sub_name}`;\r\n      }\r\n    }\r\n    \r\n    if (filters.dateFilter) {\r\n      if (subtitle) subtitle += ' - ';\r\n      \r\n      if (filters.dateFilter.type === 'single' && filters.dateFilter.date) {\r\n        subtitle += `في تاريخ ${this.formatDateArabic(filters.dateFilter.date)}`;\r\n      } else if (filters.dateFilter.type === 'range' && filters.dateFilter.startDate && filters.dateFilter.endDate) {\r\n        subtitle += `في الفترة من ${this.formatDateArabic(filters.dateFilter.startDate)} إلى ${this.formatDateArabic(filters.dateFilter.endDate)}`;\r\n      }\r\n    }\r\n    \r\n    if (filters.searchTerm) {\r\n      if (subtitle) subtitle += ' - ';\r\n      subtitle += `البحث: ${filters.searchTerm}`;\r\n    }\r\n    \r\n    return subtitle;\r\n  }\r\n\r\n  private formatDateArabic(date: string): string {\r\n    if (!date) return '';\r\n    \r\n    const arabicMonths = [\r\n      'يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو',\r\n      'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'\r\n    ];\r\n    \r\n    const dateObj = new Date(date);\r\n    const day = dateObj.getDate();\r\n    const month = arabicMonths[dateObj.getMonth()];\r\n    \r\n    return `${day} ${month}`;\r\n  }\r\n\r\n  private async showSuccessToast(message: string): Promise<void> {\r\n    const toast = await this.toastController.create({\r\n      message,\r\n      duration: 3000,\r\n      color: 'success',\r\n      position: 'top',\r\n      mode: 'ios'\r\n    });\r\n    await toast.present();\r\n  }\r\n\r\n  private async showErrorToast(message: string): Promise<void> {\r\n    const toast = await this.toastController.create({\r\n      message,\r\n      duration: 3000,\r\n      color: 'danger',\r\n      position: 'top',\r\n      mode: 'ios'\r\n    });\r\n    await toast.present();\r\n  }\r\n\r\n  private async showConfirmationAlert(header: string, message: string): Promise<boolean> {\r\n    return new Promise(async (resolve) => {\r\n      const alert = await this.alertController.create({\r\n        header,\r\n        message,\r\n        buttons: [\r\n          {\r\n            text: 'إلغاء',\r\n            role: 'cancel',\r\n            handler: () => resolve(false)\r\n          },\r\n          {\r\n            text: 'متابعة',\r\n            handler: () => resolve(true)\r\n          }\r\n        ]\r\n      });\r\n      await alert.present();\r\n    });\r\n  }\r\n}"],"names":[],"sourceRoot":"webpack:///"}