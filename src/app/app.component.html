<ion-app>
  <ion-split-pane contentId="main-content" when="lg" *ngIf="isAuth == true">
    <!-- Main Content Area -->
    <ion-content id="main-content">
      <div class="main-content-wrapper" dir="rtl">
        <ion-router-outlet></ion-router-outlet>
      </div>
    </ion-content>

    <!-- Main Menu - Positioned on the right side -->
    <ion-menu 
      contentId="main-content" 
      type="overlay" 
      side="start" 
      swipeGesture="true"
      [class.collapsed]="isSidebarCollapsed"
      [class.expanded]="isSidebarExpanded()"
      (mouseenter)="onSidebarMouseEnter()"
      (mouseleave)="onSidebarMouseLeave()">
      
      <ion-content>
        <div class="menu-container">
          <!-- Logo Section -->
          <div class="logo-section" [class.collapsed]="isSidebarCollapsed" [class.expanded]="isSidebarExpanded()">
            <div class="logo-container">
              <img src="assets/imgs/logo.png" alt="Logo" class="sidebar-logo">
            </div>
            <h1 class="app-title">نظام إدارة المخازن</h1>
          </div>
          
          <!-- Toggle Button -->
          <div class="sidebar-toggle" (click)="toggleSidebar()">
            <ion-icon 
              [name]="isSidebarCollapsed ? 'chevron-forward-outline' : 'chevron-back-outline'"
              class="toggle-icon">
            </ion-icon>
          </div>
          
          <!-- Header Section -->
          <div class="menu-header" [class.collapsed]="isSidebarCollapsed" [class.expanded]="isSidebarExpanded()">
            <ion-label>{{getSelectedEndpointName()}}</ion-label>
          </div>
          
          <!-- User Profile Section -->
          <div class="user-profile" [class.collapsed]="isSidebarCollapsed" [class.expanded]="isSidebarExpanded()">
            <div class="user-info-container">
              <div class="user-avatar">
                <ion-icon name="person-circle"></ion-icon>
              </div>
              <div class="user-details">
                <h2>{{USER_INFO.full_name}}</h2> 
              </div>

              <!-- Three dots button for popover -->
              <ion-button (click)="presentUserPopover($event)" fill="clear" class="user-actions-button">
                <ion-icon name="ellipsis-vertical"></ion-icon>
              </ion-button>
            </div> 
          </div>
          
          <!-- Navigation Menu -->
          <div class="navigation-menu">
            <!-- Dashboard -->
            <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('analytics-dashboard')" data-router-link="analytics-dashboard">
              <div class="menu-item-content">
                <ion-icon name="home"></ion-icon>
                <span>الرئيسية</span>
              </div>
            </div>
            
            <!-- Sales Section -->
            <div class="menu-section">
              <div class="section-header">
                <ion-icon name="basket"></ion-icon>
                <span>المبيعات</span>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/sales')" data-router-link="folder/sales">
                <div class="menu-item-content">
                  <ion-icon name="receipt"></ion-icon>
                  <span>فاتورة مبيعات</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'mobile'" (click)="onMenuItemClick('folder/sales-mob')" data-router-link="folder/sales-mob">
                <div class="menu-item-content">
                  <ion-icon name="receipt"></ion-icon>
                  <span>فاتورة مبيعات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/sales-record')" data-router-link="folder/sales-record">
                <div class="menu-item-content">
                  <ion-icon name="document-text"></ion-icon>
                  <span>سجل المبيعات</span>
                </div>
              </div>
            </div>
            
            <!-- Purchases Section -->
            <div class="menu-section">
              <div class="section-header">
                <ion-icon name="bag-remove"></ion-icon>
                <span>المشتريات</span>
              </div>
              
              <div class="menu-item" *ngIf="device == 'mobile'" (click)="onMenuItemClick('folder/purchase-mob')" data-router-link="folder/purchase-mob">
                <div class="menu-item-content">
                  <ion-icon name="cart"></ion-icon>
                  <span>فاتورة مشتريات</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/purchase')" data-router-link="folder/purchase">
                <div class="menu-item-content">
                  <ion-icon name="cart"></ion-icon>
                  <span>فاتورة مشتريات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/purchase-record')" data-router-link="folder/purchase-record">
                <div class="menu-item-content">
                  <ion-icon name="document-text"></ion-icon>
                  <span>سجل المشتريات</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/prch-order')" data-router-link="folder/prch-order">
                <div class="menu-item-content">
                  <ion-icon name="clipboard"></ion-icon>
                  <span>طلبات الشراء</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/prch-order-record')" data-router-link="folder/prch-order-record">
                <div class="menu-item-content">
                  <ion-icon name="document-text"></ion-icon>
                  <span>سجل طلبات الشراء</span>
                </div>
              </div>
            </div>
            
            <!-- Inventory Section -->
            <div class="menu-section">
              <div class="section-header">
                <ion-icon name="file-tray-full"></ion-icon>
                <span>المخزن</span>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('item-stock')" data-router-link="item-stock">
                <div class="menu-item-content">
                  <ion-icon name="cube"></ion-icon>
                  <span>المخزن</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/items-report')" data-router-link="folder/items-report">
                <div class="menu-item-content">
                  <ion-icon name="swap-vertical"></ion-icon>
                  <span>حركة الأصناف</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/tswia')" data-router-link="folder/tswia">
                <div class="menu-item-content">
                  <ion-icon name="sync"></ion-icon>
                  <span>التسوية الجردية</span>
                </div>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/tswia-record')" data-router-link="folder/tswia-record">
                <div class="menu-item-content">
                  <ion-icon name="document-text"></ion-icon>
                  <span>سجل التسويات الجردية</span>
                </div>
              </div>
            </div>
            
            <!-- Accounts Section -->
            <div class="menu-section">
              <div class="section-header">
                <ion-icon name="cash"></ion-icon>
                <span>الحسابات</span>
              </div>
              
              <div class="menu-item" *ngIf="device == 'desktop'" (click)="onMenuItemClick('folder/sub-account2')" data-router-link="folder/sub-account2">
                <div class="menu-item-content">
                  <ion-icon name="people"></ion-icon>
                  <span>إدارة الحسابات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/cash2')" data-router-link="folder/cash2">
                <div class="menu-item-content">
                  <ion-icon name="card"></ion-icon>
                  <span>السندات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/spend-record2')" data-router-link="folder/spend-record2">
                <div class="menu-item-content">
                  <ion-icon name="document-text"></ion-icon>
                  <span>سجل السندات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/statement2')" data-router-link="folder/statement2">
                <div class="menu-item-content">
                  <ion-icon name="reader"></ion-icon>
                  <span>كشف حساب</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/balance-sheet2')" data-router-link="folder/balance-sheet2">
                <div class="menu-item-content">
                  <ion-icon name="bar-chart"></ion-icon>
                  <span>الأرصدة</span>
                </div>
              </div>
            </div>
            
            <!-- Settings Section -->
            <div class="menu-section">
              <div class="section-header">
                <ion-icon name="cog"></ion-icon>
                <span>الإعدادات والضبط</span>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/categories')" data-router-link="folder/categories">
                <div class="menu-item-content">
                  <ion-icon name="grid"></ion-icon>
                  <span>التصنيفات</span>
                </div>
              </div>
              
              <div class="menu-item" (click)="onMenuItemClick('folder/settings')" data-router-link="folder/settings">
                <div class="menu-item-content">
                  <ion-icon name="sync"></ion-icon>
                  <span>المزامنة والإتصال</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ion-content>
    </ion-menu>
  </ion-split-pane>
  
  <!-- Login View -->
  <ion-router-outlet *ngIf="isAuth == false"></ion-router-outlet>
</ion-app>