"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2598],{12598:(y,C,u)=>{u.r(C),u.d(C,{ItemStockPrintPageModule:()=>n});var s=u(69808),t=u(34182),d=u(23349),l=u(94030),f=u(20683),_=u(29863);const x=[{path:"",component:f.e}];let p=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=_.oAB({type:e}),e.\u0275inj=_.cJS({imports:[[l.Bz.forChild(x)],l.Bz]}),e})();var P=u(62279);let n=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=_.oAB({type:e}),e.\u0275inj=_.cJS({imports:[[s.ez,t.u5,d.Pc,p,P.m]]}),e})()},20683:(y,C,u)=>{u.d(C,{e:()=>i});var s=u(70655),t=u(29863),d=u(23349),l=u(6612),f=u(69808),_=u(1212);function x(o,g){if(1&o&&(t.TgZ(0,"div",25),t.TgZ(1,"p",26),t._uU(2),t.qZA(),t.qZA()),2&o){const r=t.oxw();t.xp6(2),t.hij("\u0627\u0644\u0639\u0645\u0644\u0629: ",r.currentCurrency," - \u062c\u0645\u064a\u0639 \u0627\u0644\u0642\u064a\u0645 \u0645\u062d\u0648\u0644\u0629 \u0645\u0646 \u0627\u0644\u062c\u0646\u064a\u0647 \u0627\u0644\u0633\u0648\u062f\u0627\u0646\u064a")}}function p(o,g){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"currencyDisplay"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"currencyDisplay"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"currencyDisplay"),t.qZA(),t.qZA()),2&o){const r=g.$implicit,a=g.index,c=t.oxw(2);t.xp6(2),t.Oqu(a+1),t.xp6(2),t.Oqu(r.item_code||"-"),t.xp6(2),t.Oqu(r.item_name||"-"),t.xp6(2),t.Oqu(r.item_unit||"-"),t.xp6(2),t.Oqu(r.item_cat||"-"),t.xp6(1),t.Udp("color",r.currentQuantity>0?"#28a745":"#dc3545"),t.xp6(1),t.hij(" ",c.formatBalance(r.currentQuantity||0)," "),t.xp6(2),t.Oqu(t.Dn7(15,11,r.item_parcode||0,"SDG",!1)),t.xp6(3),t.Oqu(t.Dn7(18,15,r.item_Sell_price||0,"SDG",!1)),t.xp6(3),t.Oqu(t.Dn7(21,19,(r.quantity||0)*(r.unit_price||r.pay_price||0),"SDG",!1))}}function P(o,g){if(1&o&&(t.TgZ(0,"div",27),t.TgZ(1,"table"),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t.TgZ(4,"th"),t._uU(5,"\u0627\u0644\u062a\u0633\u0644\u0633\u0644"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"\u0643\u0648\u062f \u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"\u0627\u0633\u0645 \u0627\u0644\u0635\u0646\u0641"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"\u0627\u0644\u0648\u062d\u062f\u0629"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"\u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"\u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u062d\u0627\u0644\u064a\u0629"),t.qZA(),t.TgZ(16,"th"),t._uU(17),t.qZA(),t.TgZ(18,"th"),t._uU(19),t.qZA(),t.TgZ(20,"th"),t._uU(21),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"tbody"),t.YNc(23,p,22,23,"tr",28),t.qZA(),t.TgZ(24,"tfoot"),t.TgZ(25,"tr",29),t.TgZ(26,"td",30),t._uU(27,"\u0627\u0644\u0625\u062c\u0645\u0627\u0644\u064a"),t.qZA(),t._UZ(28,"td",31),t.TgZ(29,"td"),t._uU(30),t.ALo(31,"currencyDisplay"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const r=t.oxw();t.xp6(17),t.hij("\u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621 (",r.getCurrencySymbol(),")"),t.xp6(2),t.hij("\u0633\u0639\u0631 \u0627\u0644\u0628\u064a\u0639 (",r.getCurrencySymbol(),")"),t.xp6(2),t.hij("\u0642\u064a\u0645\u0629 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 (",r.getCurrencySymbol(),")"),t.xp6(2),t.Q6J("ngForOf",r.printData),t.xp6(7),t.Oqu(t.Dn7(31,5,r.getTotalValueRaw(),"SDG",!1))}}function n(o,g){1&o&&(t.TgZ(0,"div",32),t.TgZ(1,"p",33),t._uU(2,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u0639\u0631\u0636"),t.qZA(),t.qZA())}function e(o,g){if(1&o&&(t.TgZ(0,"div",34),t.TgZ(1,"h3",35),t._uU(2,"\u0645\u0644\u062e\u0635 \u0625\u062d\u0635\u0627\u0626\u064a\u0627\u062a \u0627\u0644\u0645\u062e\u0632\u0648\u0646"),t.qZA(),t.TgZ(3,"div",36),t.TgZ(4,"div",37),t.TgZ(5,"strong",38),t._uU(6),t.qZA(),t.TgZ(7,"p",39),t._uU(8,"\u0623\u0635\u0646\u0627\u0641 \u0645\u062a\u0648\u0641\u0631\u0629"),t.qZA(),t.qZA(),t.TgZ(9,"div",37),t.TgZ(10,"strong",40),t._uU(11),t.qZA(),t.TgZ(12,"p",39),t._uU(13,"\u0623\u0635\u0646\u0627\u0641 \u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631\u0629"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const r=t.oxw();t.xp6(6),t.Oqu(r.getItemsInStock()),t.xp6(5),t.Oqu(r.getItemsOutOfStock())}}let i=(()=>{class o{constructor(r,a,c,h){this.modalController=r,this.toast=a,this.currencyService=c,this.cdr=h,this.exportMode="all",this.logoBase64="",this.vehicleBase64="",this.currentCurrency="SDG"}ngOnInit(){return(0,s.mG)(this,void 0,void 0,function*(){console.log("Print data:",this.printData),yield this.loadImages(),yield this.initializeCurrency()})}ngOnDestroy(){this.currencySubscription&&this.currencySubscription.unsubscribe()}initializeCurrency(){return(0,s.mG)(this,void 0,void 0,function*(){yield this.currencyService.initializeCurrency(),this.currentCurrency=this.currencyService.getCurrentCurrencyValue(),this.currencySubscription=this.currencyService.getCurrentCurrency().subscribe(r=>{this.currentCurrency=r,this.cdr.detectChanges()})})}formatStockValue(r){const c=this.currencyService.convertFromSDG((r.quantity||0)*(r.unit_price||r.pay_price||0),this.currentCurrency);return this.currencyService.formatCurrency(c,this.currentCurrency)}loadImages(){return(0,s.mG)(this,void 0,void 0,function*(){try{this.logoBase64=yield this.convertImageToBase64("assets/imgs/logo.png")}catch(r){console.log("Failed to load logo image:",r)}try{this.vehicleBase64=yield this.convertImageToBase64("assets/imgs/tuk.jpg")}catch(r){console.log("Failed to load vehicle image:",r)}})}convertImageToBase64(r){return new Promise((a,c)=>{const h=new Image;h.crossOrigin="anonymous",h.onload=()=>{try{const m=document.createElement("canvas"),O=m.getContext("2d");m.width=h.width,m.height=h.height,O.drawImage(h,0,0);const M=m.toDataURL("image/png");a(M)}catch(m){console.error("Error converting image to base64:",m),c(m)}},h.onerror=m=>{console.error("Failed to load image:",r,m),c("Failed to load image: "+r)},h.src=r})}ionViewDidEnter(){return(0,s.mG)(this,void 0,void 0,function*(){yield this.Print("printarea1")})}Print(r){return(0,s.mG)(this,void 0,void 0,function*(){let a=document.getElementById(r).innerHTML;this.logoBase64&&(a=a.replace(/src="assets\/imgs\/logo\.png"/g,`src="${this.logoBase64}"`),a=a.replace(/\[src\]="logoBase64 \|\| 'assets\/imgs\/logo\.png'"/g,`src="${this.logoBase64}"`)),this.vehicleBase64&&(a=a.replace(/src="assets\/imgs\/tuk\.jpg"/g,`src="${this.vehicleBase64}"`),a=a.replace(/\[src\]="vehicleBase64 \|\| 'assets\/imgs\/tuk\.jpg'"/g,`src="${this.vehicleBase64}"`));var c=window.open("","PRINT","height=600,width=800");c.document.write("<html><head>"),c.document.write('<style type="text/css">'),c.document.write("\n      @page { \n        size: A4 landscape; \n        margin: 0.5in; \n      }\n      * { \n        box-sizing: border-box; \n      }\n      body { \n        font-family: Arial, sans-serif; \n        font-size: 10px; \n        line-height: 1.2; \n        margin: 0; \n        padding: 0; \n        direction: rtl;\n      }\n      .flr { display: block; float: right; } \n      .show { } \n      .hide { width:0px; height:0px; } \n      .w45 { width:45%; } \n      .w35 { width:35%; } \n      .w50 { width:50%; } \n      .w100 { width:100%; }\n      table { \n        width: 100%; \n        border-collapse: collapse; \n        font-size: 8px;\n        table-layout: fixed;\n        margin: 0;\n      }\n      th, td { \n        border: 1px solid #333; \n        text-align: center; \n        padding: 3px; \n        word-wrap: break-word;\n        vertical-align: middle;\n      }\n      th {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        font-weight: bold;\n        font-size: 9px;\n      }\n      .hd { \n        background-color: #b9b8b8; \n      }\n      .ion-margin { \n        margin: 5px; \n      } \n      .ion-margin-top { \n        margin-top: 5px; \n      } \n      .rtl { \n        direction: rtl; \n      } \n      .ion-text-center { \n        text-align: center; \n      } \n      .ion-text-end { \n        text-align: left; \n      } \n      .ion-text-start { \n        text-align: right; \n      }\n      /* Column specific widths */\n      th:nth-child(1), td:nth-child(1) { width: 5%; } /* \u0627\u0644\u062a\u0633\u0644\u0633\u0644 */\n      th:nth-child(2), td:nth-child(2) { width: 8%; } /* \u0643\u0648\u062f \u0627\u0644\u0635\u0646\u0641 */\n      th:nth-child(3), td:nth-child(3) { width: 25%; } /* \u0627\u0633\u0645 \u0627\u0644\u0635\u0646\u0641 */\n      th:nth-child(4), td:nth-child(4) { width: 8%; } /* \u0627\u0644\u0648\u062d\u062f\u0629 */\n      th:nth-child(5), td:nth-child(5) { width: 12%; } /* \u0627\u0644\u0645\u062c\u0645\u0648\u0639\u0629 */\n      th:nth-child(6), td:nth-child(6) { width: 10%; } /* \u0627\u0644\u0643\u0645\u064a\u0629 \u0627\u0644\u062d\u0627\u0644\u064a\u0629 */\n      th:nth-child(7), td:nth-child(7) { width: 10%; } /* \u0633\u0639\u0631 \u0627\u0644\u0634\u0631\u0627\u0621 */\n      th:nth-child(8), td:nth-child(8) { width: 10%; } /* \u0633\u0639\u0631 \u0627\u0644\u0628\u064a\u0639 */\n      th:nth-child(9), td:nth-child(9) { width: 12%; } /* \u0642\u064a\u0645\u0629 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 */\n      \n      /* Header styling */\n      h1, h2 { \n        margin: 5px 0; \n        font-size: 14px;\n      }\n      img { \n        max-width: 60px; \n        max-height: 40px; \n        object-fit: contain; \n      }\n      /* Summary sections */\n      .summary-section {\n        font-size: 8px;\n        margin: 10px 0;\n      }\n      .grid-container {\n        display: flex;\n        justify-content: space-between;\n        font-size: 8px;\n      }\n      .grid-item {\n        flex: 1;\n        text-align: center;\n        padding: 5px;\n      }\n    "),c.document.write("</style></head><body>"),c.document.write(a),c.document.write("</body></html>"),c.document.close(),c.focus(),c.window.print(),c.window.close(),this.modalController.dismiss()})}generateTitle(){switch(this.exportMode){case"filtered":return"\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 - \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0641\u0644\u062a\u0631\u0629";case"search":return"\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 - \u0646\u062a\u0627\u0626\u062c \u0627\u0644\u0628\u062d\u062b";default:return"\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 - \u062c\u0645\u064a\u0639 \u0627\u0644\u0623\u0635\u0646\u0627\u0641"}}formatBalance(r){return r||0===r?new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.abs(r)):"0.00"}getTotalQuantity(){if(!this.printData||0===this.printData.length)return"0.00";const r=this.printData.reduce((a,c)=>a+(c.currentQuantity||0),0);return this.formatBalance(r)}getTotalValue(){if(!this.printData||0===this.printData.length)return"0.00";const r=this.printData.reduce((a,c)=>a+(c.currentQuantity||0)*(c.item_parcode||0),0);return this.formatBalance(r)}getTotalValueRaw(){return this.printData&&0!==this.printData.length?this.printData.reduce((r,a)=>r+(a.currentQuantity||0)*(a.item_parcode||0),0):0}getItemsInStock(){return this.printData&&0!==this.printData.length?this.printData.filter(r=>(r.currentQuantity||0)>0).length:0}getItemsOutOfStock(){return this.printData&&0!==this.printData.length?this.printData.filter(r=>0===(r.currentQuantity||0)).length:0}getAverageStockValue(){return this.printData&&0!==this.printData.length?this.printData.reduce((a,c)=>a+(c.currentQuantity||0)*(c.item_parcode||0),0)/this.printData.length:0}getCurrentDate(){return(new Date).toLocaleDateString("en-US")}getCurrentTime(){return(new Date).toLocaleTimeString("en-US")}getCurrencySymbol(){return this.currencyService.getCurrentCurrencySymbol()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(d.IN),t.Y36(d.yF),t.Y36(l.i),t.Y36(t.sBO))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-item-stock-print"]],inputs:{printData:"printData",exportMode:"exportMode",userName:"userName"},decls:59,vars:12,consts:[[2,"padding","20px"],["id","printarea1"],["printarea1",""],["class","currency-info","style","font-size: 0.8em; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 8px; text-align: center; direction: rtl;",4,"ngIf"],[2,"display","table","width","100%","margin-bottom","30px"],[2,"display","table-cell","width","150px","text-align","left","vertical-align","middle"],["alt","Vehicle",2,"width","120px","height","80px","object-fit","contain",3,"src"],[2,"display","table-cell","text-align","center","vertical-align","middle"],[2,"margin","5px 0 0 0","font-size","32px","font-weight","bold"],[2,"margin","10px 0","padding","15px 25px","background-color","#f0f0f0","display","inline-block","font-size","28px","border-radius","8px","direction","rtl"],[2,"display","table-cell","width","150px","text-align","right","vertical-align","middle"],["alt","Logo",2,"width","120px","height","80px","object-fit","contain",3,"src"],[2,"margin-bottom","25px","border","2px solid #333","padding","15px","direction","rtl","border-radius","8px","background-color","#f9f9f9"],[2,"font-size","14px","margin-right","10px"],[2,"margin-bottom","12px","border-bottom","2px dotted #666","padding-bottom","8px"],[2,"display","inline-block","width","48%","text-align","right"],[2,"color","#333"],[2,"color","#555"],[2,"margin-bottom","8px"],["class","table-responsive","style","margin-bottom: 20px; direction: rtl; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 8px; overflow: hidden;",4,"ngIf"],["style","text-align: center; padding: 40px; background-color: #f8f9fa; border-radius: 8px; margin: 20px 0;",4,"ngIf"],["style","margin-top: 30px; border: 2px solid #333; padding: 20px; direction: rtl; border-radius: 8px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);",4,"ngIf"],[2,"margin-top","40px","text-align","center","border-top","2px solid #333","padding-top","20px","direction","rtl"],[2,"display","grid","grid-template-columns","1fr 1fr 1fr","gap","20px","font-size","14px","color","#666"],[2,"margin","5px 0 0 0","color","#333","font-weight","bold"],[1,"currency-info",2,"font-size","0.8em","margin-bottom","15px","border-bottom","1px solid #ccc","padding-bottom","8px","text-align","center","direction","rtl"],[2,"margin","5px 0","color","#333"],[1,"table-responsive",2,"margin-bottom","20px","direction","rtl","box-shadow","0 4px 8px rgba(0,0,0,0.1)","border-radius","8px","overflow","hidden"],[4,"ngFor","ngForOf"],[1,"total-row"],["colspan","5"],["colspan","2"],[2,"text-align","center","padding","40px","background-color","#f8f9fa","border-radius","8px","margin","20px 0"],[2,"font-size","18px","color","#666","direction","rtl"],[2,"margin-top","30px","border","2px solid #333","padding","20px","direction","rtl","border-radius","8px","background","linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)"],[2,"text-align","center","margin-bottom","20px","color","#333","font-size","20px"],[2,"display","grid","grid-template-columns","1fr 1fr 1fr","gap","20px","text-align","center"],[2,"background-color","white","padding","15px","border-radius","8px","box-shadow","0 2px 4px rgba(0,0,0,0.1)"],[2,"color","#28a745","font-size","18px"],[2,"margin","5px 0 0 0","color","#666"],[2,"color","#dc3545","font-size","18px"]],template:function(r,a){1&r&&(t.TgZ(0,"ion-content"),t.TgZ(1,"div",0),t.TgZ(2,"div",1,2),t.YNc(4,x,3,1,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t._UZ(7,"img",6),t.qZA(),t.TgZ(8,"div",7),t.TgZ(9,"h2",8),t._uU(10,"GVS"),t.qZA(),t.TgZ(11,"h1",9),t._uU(12),t.qZA(),t.qZA(),t.TgZ(13,"div",10),t._UZ(14,"img",11),t.qZA(),t.qZA(),t.TgZ(15,"div",12),t.TgZ(16,"div",13),t.TgZ(17,"div",14),t.TgZ(18,"span",15),t.TgZ(19,"strong",16),t._uU(20,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0642\u0631\u064a\u0631: "),t.qZA(),t.TgZ(21,"span",17),t._uU(22),t.qZA(),t.qZA(),t.TgZ(23,"span",15),t.TgZ(24,"strong",16),t._uU(25,"\u0648\u0642\u062a \u0627\u0644\u062a\u0642\u0631\u064a\u0631: "),t.qZA(),t.TgZ(26,"span",17),t._uU(27),t.qZA(),t.qZA(),t.qZA(),t.TgZ(28,"div",18),t.TgZ(29,"span",15),t.TgZ(30,"strong",16),t._uU(31,"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0623\u0635\u0646\u0627\u0641: "),t.qZA(),t.TgZ(32,"span",17),t._uU(33),t.qZA(),t.qZA(),t.TgZ(34,"span",15),t.TgZ(35,"strong",16),t._uU(36,"\u0646\u0648\u0639 \u0627\u0644\u062a\u0642\u0631\u064a\u0631: "),t.qZA(),t.TgZ(37,"span",17),t._uU(38),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(39,P,32,9,"div",19),t.YNc(40,n,3,0,"div",20),t.YNc(41,e,14,2,"div",21),t.TgZ(42,"div",22),t.TgZ(43,"div",23),t.TgZ(44,"div"),t.TgZ(45,"strong"),t._uU(46,"\u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0628\u0648\u0627\u0633\u0637\u0629:"),t.qZA(),t.TgZ(47,"p",24),t._uU(48),t.qZA(),t.qZA(),t.TgZ(49,"div"),t.TgZ(50,"strong"),t._uU(51,"\u0627\u0644\u0646\u0638\u0627\u0645:"),t.qZA(),t.TgZ(52,"p",24),t._uU(53,"\u0646\u0638\u0627\u0645 \u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u062e\u0632\u0648\u0646 - GVS"),t.qZA(),t.qZA(),t.TgZ(54,"div"),t.TgZ(55,"strong"),t._uU(56,"\u0631\u0642\u0645 \u0627\u0644\u0635\u0641\u062d\u0629:"),t.qZA(),t.TgZ(57,"p",24),t._uU(58,"1 \u0645\u0646 1"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r&&(t.xp6(4),t.Q6J("ngIf","SDG"!==a.currentCurrency),t.xp6(3),t.Q6J("src",a.vehicleBase64||"assets/imgs/tuk.jpg",t.LSH),t.xp6(5),t.hij(" ",a.generateTitle()," "),t.xp6(2),t.Q6J("src",a.logoBase64||"assets/imgs/logo.png",t.LSH),t.xp6(8),t.Oqu(a.getCurrentDate()),t.xp6(5),t.Oqu(a.getCurrentTime()),t.xp6(6),t.Oqu((null==a.printData?null:a.printData.length)||0),t.xp6(5),t.hij(" ","filtered"===a.exportMode?"\u0645\u0641\u0644\u062a\u0631":"search"===a.exportMode?"\u0628\u062d\u062b":"\u0634\u0627\u0645\u0644"," "),t.xp6(1),t.Q6J("ngIf",a.printData&&a.printData.length>0),t.xp6(1),t.Q6J("ngIf",!a.printData||0===a.printData.length),t.xp6(1),t.Q6J("ngIf",a.printData&&a.printData.length>0),t.xp6(7),t.Oqu(a.userName||"\u0645\u0633\u062a\u062e\u062f\u0645 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641"))},directives:[d.W2,f.O5,f.sg],pipes:[_.v],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}#printarea1[_ngcontent-%COMP%]{width:100%;padding:20px;background:white;font-family:Arial,sans-serif;direction:rtl}@media print{@page{size:A4 landscape;margin:.5in}body[_ngcontent-%COMP%], ion-app[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]{background:white!important;color:#000!important}#printarea1[_ngcontent-%COMP%]{padding:0!important;margin:0!important;width:100%!important;max-width:none!important}table[_ngcontent-%COMP%]{width:100%!important;border-collapse:collapse!important;font-size:8px!important;table-layout:fixed!important;margin:0!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #333!important;text-align:center!important;padding:3px!important;word-wrap:break-word!important;vertical-align:middle!important;font-size:8px!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#667eea!important;color:#fff!important;font-weight:700!important;-webkit-print-color-adjust:exact!important;color-adjust:exact!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){width:5%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){width:8%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){width:25%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){width:8%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(5){width:12%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(6){width:10%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(7), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(7){width:10%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(8), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(8){width:10%!important}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(9), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(9){width:12%!important}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{margin:5px 0!important;font-size:14px!important}img[_ngcontent-%COMP%]{max-width:60px!important;max-height:40px!important;object-fit:contain!important}.summary-section[_ngcontent-%COMP%]{font-size:8px!important;margin:10px 0!important}.grid-container[_ngcontent-%COMP%]{display:flex!important;justify-content:space-between!important;font-size:8px!important}.grid-item[_ngcontent-%COMP%]{flex:1!important;text-align:center!important;padding:5px!important}ion-header[_ngcontent-%COMP%], .print-controls[_ngcontent-%COMP%]{display:none!important}}@media screen{table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:12px;margin:0}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;text-align:center;padding:10px;word-wrap:break-word;vertical-align:middle}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:700}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f8f9fa}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#fff}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}.header-layout[_ngcontent-%COMP%]{display:table;width:100%;margin-bottom:30px}.header-layout[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.header-layout[_ngcontent-%COMP%]   .header-cell.left[_ngcontent-%COMP%]{width:150px;text-align:left}.header-layout[_ngcontent-%COMP%]   .header-cell.center[_ngcontent-%COMP%]{text-align:center}.header-layout[_ngcontent-%COMP%]   .header-cell.right[_ngcontent-%COMP%]{width:150px;text-align:right}.info-section[_ngcontent-%COMP%]{margin-bottom:25px;border:2px solid #333;padding:15px;direction:rtl;border-radius:8px;background-color:#f9f9f9}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{font-size:14px;margin-right:10px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{margin-bottom:12px;border-bottom:2px dotted #666;padding-bottom:8px}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:inline-block;width:48%;text-align:right}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#555}.summary-stats[_ngcontent-%COMP%]{margin-top:30px;border:2px solid #333;padding:20px;direction:rtl;border-radius:8px;background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%)}.summary-stats[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px;color:#333;font-size:20px}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-gap:20px;gap:20px;text-align:center}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{background-color:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:18px}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   strong.success[_ngcontent-%COMP%]{color:#28a745}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   strong.danger[_ngcontent-%COMP%]{color:#dc3545}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   strong.primary[_ngcontent-%COMP%]{color:#007bff}.summary-stats[_ngcontent-%COMP%]   .stats-grid[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#666}.footer-section[_ngcontent-%COMP%]{margin-top:40px;text-align:center;border-top:2px solid #333;padding-top:20px;direction:rtl}.footer-section[_ngcontent-%COMP%]   .footer-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-gap:20px;gap:20px;font-size:14px;color:#666}.footer-section[_ngcontent-%COMP%]   .footer-grid[_ngcontent-%COMP%]   .footer-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:5px}.footer-section[_ngcontent-%COMP%]   .footer-grid[_ngcontent-%COMP%]   .footer-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#333;font-weight:700}.footer-section[_ngcontent-%COMP%]   .company-footer[_ngcontent-%COMP%]{margin-top:20px;padding-top:15px;border-top:1px dotted #ccc}.footer-section[_ngcontent-%COMP%]   .company-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;font-size:12px;color:#888}.total-row[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)!important;color:#fff!important;font-weight:700!important;-webkit-print-color-adjust:exact!important;color-adjust:exact!important}.total-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px!important;padding:12px!important}@media print{.total-row[_ngcontent-%COMP%]{background:#667eea!important;color:#fff!important}}"]}),o})()},6612:(y,C,u)=>{u.d(C,{i:()=>x});var s=u(70655),t=u(40520),d=u(591),l=u(29863),f=u(90849),_=u(91472);let x=(()=>{class p{constructor(n,e,i){this.http=n,this.storage=e,this.servicesService=i,this.currentCurrency=new d.X("SDG"),this.currentYear=new d.X(null),this.exchangeRates=new d.X({}),this.supportedCurrencies=new d.X([]),this.ratesCache=new Map,this.api=this.servicesService.api}getCurrentCurrency(){return this.currentCurrency.asObservable()}getCurrentCurrencyValue(){return this.currentCurrency.value}setCurrency(n){this.currentCurrency.next(n),this.storage.set("selectedCurrency",n)}setCurrentYear(n){this.currentYear.next(n)}loadRatesByYear(n,e){return(0,s.mG)(this,void 0,void 0,function*(){try{const i=(new t.LE).set("store_id",n).set("year_id",e),o=yield this.http.get(this.api+"currency_rates/latest.php",{params:i}).toPromise();return o&&o.data&&(this.cacheRates(o.data,e),this.exchangeRates.next(o.data)),o}catch(i){return console.error("Error loading currency rates:",i),null}})}getExchangeRate(n){if("SDG"===n)return 1;const e=this.exchangeRates.value;if(Array.isArray(e)){const i=e.find(o=>o.target_currency===n);return i?parseFloat(i.exchange_rate):1}return 1}createCurrencyRate(n){const e={headers:new t.WM({"Content-Type":"application/json"})};return this.http.post(this.api+"currency_rates/create.php",n,e)}getCurrencyRates(n){let e=new t.LE;return Object.keys(n).forEach(i=>{n[i]&&(e=e.set(i,n[i]))}),this.http.get(this.api+"currency_rates/read.php",{params:e})}updateCurrencyRate(n,e){const i=Object.assign({id:n},e),o={headers:new t.WM({"Content-Type":"application/json"})};return this.http.put(this.api+"currency_rates/update.php",i,o)}deleteCurrencyRate(n){const e=(new t.LE).set("id",n);return this.http.delete(this.api+"currency_rates/delete.php",{params:e})}getNearestRate(n,e,i,o){const g=(new t.LE).set("currency",n).set("date",e).set("store_id",i).set("year_id",o);return this.http.get(this.api+"currency_rates/nearestDate.php",{params:g})}convertFromSDG(n,e){return"SDG"!==e&&n?n/this.getExchangeRate(e):n}convertToSDG(n,e){return"SDG"!==e&&n?n*this.getExchangeRate(e):n}formatCurrency(n,e){return`${n.toLocaleString("en-US",{minimumFractionDigits:2})} ${{SDG:"\u062c.\u0633",USD:"$",AED:"\u062f.\u0625",SAR:"\u0631.\u0633"}[e]||e}`}getSupportedCurrencies(){return this.http.get(this.api+"currencies/read.php")}getActiveCurrencies(){const n=(new t.LE).set("active_only","true");return this.http.get(this.api+"currencies/read.php",{params:n})}addSupportedCurrency(n){return this.http.post(this.api+"currencies/create.php",n)}updateSupportedCurrency(n,e){return this.http.put(this.api+"currencies/update.php",Object.assign({id:n},e))}deleteSupportedCurrency(n){const e=(new t.LE).set("id",n);return this.http.delete(this.api+"currencies/delete.php",{params:e})}cacheKey(n,e,i){return`${n}_${e}_${i}`}cacheRates(n,e){Array.isArray(n)&&n.forEach(i=>{const o=this.cacheKey(i.target_currency,i.rate_date,e);this.ratesCache.set(o,i)})}getCachedRate(n,e,i){const o=this.cacheKey(n,e,i);return this.ratesCache.get(o)}clearCache(){this.ratesCache.clear()}initializeCurrency(){return(0,s.mG)(this,void 0,void 0,function*(){try{yield this.storage.create();const n=yield this.storage.get("selectedCurrency");n&&this.currentCurrency.next(n)}catch(n){console.error("Error initializing currency:",n)}})}getCurrentExchangeRates(){return this.exchangeRates.asObservable()}getSupportedCurrenciesObservable(){return this.supportedCurrencies.asObservable()}loadSupportedCurrencies(){return(0,s.mG)(this,void 0,void 0,function*(){try{const n=yield this.getSupportedCurrencies().toPromise();n&&n.data&&this.supportedCurrencies.next(n.data)}catch(n){console.error("Error loading supported currencies:",n)}})}formatAmount(n,e){const i=e||this.getCurrentCurrencyValue();let o=n;return"SDG"!==i&&(o=this.convertFromSDG(n,i)),this.formatCurrency(o,i)}convertToCurrentCurrency(n,e="SDG"){const i=this.getCurrentCurrencyValue();if(e===i)return n;if("SDG"===e)return this.convertFromSDG(n,i);if("SDG"===i)return this.convertToSDG(n,e);{const o=this.convertToSDG(n,e);return this.convertFromSDG(o,i)}}getCurrentCurrencySymbol(){const n=this.getCurrentCurrencyValue();return{SDG:"\u062c.\u0633",USD:"$",AED:"\u062f.\u0625",SAR:"\u0631.\u0633"}[n]||n}getCurrentCurrencySymbolForHeader(n){return`${n} (${this.getCurrentCurrencySymbol()})`}formatAmountWithoutSymbol(n,e){const i=e||this.getCurrentCurrencyValue();let o=n;return"SDG"!==i&&(o=this.convertFromSDG(n,i)),o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}}return p.\u0275fac=function(n){return new(n||p)(l.LFG(t.eN),l.LFG(f.K),l.LFG(_.r))},p.\u0275prov=l.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);