{"version":3,"file":"src_app_sales_sales_module_ts.js","mappings":"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","sources":["./src/app/component/insufficient-stock-dialog/insufficient-stock-dialog.component.ts","./src/app/sales/sales-routing.module.ts","./src/app/sales/sales.module.ts","./src/app/sales/sales.page.ts"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { ModalController, AlertController } from '@ionic/angular';\nimport { Router, NavigationExtras } from '@angular/router';\n\n@Component({\n  selector: 'app-insufficient-stock-dialog',\n  templateUrl: './insufficient-stock-dialog.component.html',\n  styleUrls: ['./insufficient-stock-dialog.component.scss'] \n})\nexport class InsufficientStockDialogComponent implements OnInit {\n  @Input() insufficientItems: any[] = [];\n  @Input() store_info: any;\n  @Input() user_info: any;\n  @Input() year: any;\n\n  constructor(\n    private modalController: ModalController,\n    private alertController: AlertController,\n    private router: Router\n  ) { }\n\n  ngOnInit() {\n    console.log('Insufficient items:', this.insufficientItems);\n    console.log('First item structure:', this.insufficientItems[0]);\n    // Log all properties of first item to debug\n    if (this.insufficientItems.length > 0) {\n      const firstItem = this.insufficientItems[0];\n      console.log('pay_price:', firstItem.pay_price);\n      console.log('perch_price:', firstItem.perch_price);\n      console.log('All properties:', Object.keys(firstItem));\n    }\n  }\n\n  async dismissModal() {\n    await this.modalController.dismiss();\n  }\n\n  async createPurchaseInvoice() {\n    // Create alert to confirm\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'تأكيد إنشاء فاتورة شراء',\n      mode: 'ios',\n      message: 'هل تريد إنشاء فاتورة شراء تتضمن الأصناف الناقصة؟',\n      buttons: [\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          cssClass: 'secondary'\n        },\n        {\n          text: 'موافق',\n          handler: () => {\n            this.navigateToInvoicePage(this.insufficientItems, 'purchase');\n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  private navigateToInvoicePage(itemList: any[], type: 'purchase') {\n    // Transform insufficient items to purchase items format\n    const purchaseItems = itemList.map(item => ({\n      id: item.item_id,\n      item_name: item.item_name,\n      item_desc: item.item_desc,\n      part_no: item.part_no || '',\n      brand: item.brand || '',\n      model: item.model || '',\n      item_unit: item.item_unit || '',\n      realPerchPrice:item.perch_price ,\n      perch_price: item.pay_price || 0,// Use sales price for purchase price initially\n      pay_price: item.pay_price || 0, \n      qty: item.shortage, // Use shortage as the quantity to purchase\n      tot: (item.pay_price * item.shortage).toFixed(2) || 0,\n      availQty: item.shortage,\n      aliasEn: item.aliasEn || ''\n    }));\n\n    // Navigate to purchase page with items\n    let navigationExtras: NavigationExtras = {\n      queryParams: {\n        status: 'newInvoFromItemsPage',\n        selectedItemsList: JSON.stringify(purchaseItems)\n      }\n    };\n\n    // Dismiss modal first\n    this.modalController.dismiss();\n    \n    // Navigate to purchase page\n    this.router.navigate(['folder/purchase'], navigationExtras);\n  }\n\n  getTotalShortage(): number {\n    return this.insufficientItems.reduce((total, item) => total + item.shortage, 0);\n  }\n\n  getTotalValue(): number {\n    return this.insufficientItems.reduce((total, item) => \n      total + (item.pay_price * item.shortage), 0\n    );\n  }\n\n  // Debug method - remove after testing\n  getItemKeys(item: any): string {\n    return Object.keys(item).join(', ');\n  }\n}","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SalesPage } from './sales.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SalesPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SalesPageRoutingModule {}\n","import { Component, NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { FilterPipe } from \"./pipe\";\nimport { FilterPipe2 } from \"./pipe2\";\nimport { FilterPipe3 } from \"./pipe3\";\nimport { SalesPageRoutingModule } from './sales-routing.module';\nimport { ShareModule } from \"../shareModule/share-module/share-module.module\";\nimport { SalesPage } from './sales.page'; \nimport { SharedModule } from '../module/shared/shared.module';\nimport { InsufficientStockDialogComponent } from '../component/insufficient-stock-dialog/insufficient-stock-dialog.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ShareModule,\n    IonicModule,\n    SharedModule,\n    SalesPageRoutingModule \n  ],\n  declarations: \n  [\n    SalesPage,\n    FilterPipe,\n    FilterPipe2,\n    FilterPipe3,\n    InsufficientStockDialogComponent\n  ] ,\nexports: [\n  FilterPipe,\n  FilterPipe2,\n  FilterPipe3 \n]\n})\nexport class SalesPageModule {}\n","import { Component, OnInit, ViewChild, ElementRef ,Renderer2,Input, OnDestroy} from '@angular/core';\nimport { ServicesService } from \"../stockService/services.service\";\nimport { Observable, Subscription } from 'rxjs';\nimport { AlertController, Platform ,IonInput, LoadingController, ModalController, ToastController } from '@ionic/angular';\nimport { DatePipe ,Location} from '@angular/common';\nimport { Storage } from '@ionic/storage';\nimport { AuthServiceService } from '../auth/auth-service.service';\nimport { PrintModalPage } from '../print-modal/print-modal.page';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FilterPipe } from './pipe';\nimport { FilterPipe2 } from './pipe2';\nimport { FilterPipe3  } from './pipe3';\nimport { element } from 'protractor';\nimport { StockServiceService } from '../syncService/stock-service.service';\nimport { AccountCommunicationService } from '../services/account-communication.service';\nimport { PriceAdjustmentDialogComponent } from '../component/price-adjustment-dialog/price-adjustment-dialog.component';\nimport * as momentObj from 'moment';\n \n@Component({\n  selector: 'app-sales',\n  templateUrl: './sales.page.html',\n  styleUrls: ['./sales.page.scss'],\n})\n \n  \n \nexport class SalesPage implements OnInit, OnDestroy { \n  @ViewChild(\"dst\") nameField: ElementRef;\n  @ViewChild('dstPop') dstPop;\n  @ViewChild('qtyId') qtyId; \n  @ViewChild('popInput') popInput; \n  @ViewChild('popover') popover;\n  @ViewChild('popoverNotif') popoverNotif;\n\n discountType: string = 'percentage'; // 'percentage' or 'amount'\n  discountAmount: number = 0;\n  calculatedDiscountPerc: number = 0;\n  calculatedDiscountAmount: number = 0;\n\n  isOpen = false; \n  isOpenNotif = false ;\n  newNotif = false ; \n  sub_account:Array<any> =[]\n  sub_accountLocalSales:Array<any> =[]\n  sub_accountSales:Array<any> =[]\n  initialInvoices:Array<any> =[]\n  items:Array<any> =[]\n  itemsLocal:Array<any> =[]\n  itemList:Array<any> =[]\n  sortedItemList:Array<any> =[]\n  isItemListSorted:boolean = false\n  searchTerm:string = ''\n  highlightedIndex:number = -1\n  searchMatches:number[] = []\n  salesLocal:Array<any> =[]\n  sales:Array<any> =[]\n  notifArr:Array<any> =[]\n  LogHistoryLocalArr:Array<any> =[]\n  purchLocal:Array<any> =[] \n  purchase:Array<any> =[]\n  randomsNumber:Array<any> =[]\n  store_info : {id:any , location :any ,store_name:any , store_ref:any }\n  user_info : {id:any ,user_name:any ,store_id :any,full_name:any,password:any}\n  sub_nameNew :any = \"\"\n  discountPerc : any = 0\n  selectedItem : {id:any ,pay_ref:any,item_name:any,pay_price:any,perch_price:any,item_unit:any,item_desc:any,parcode:any,qty:any,tot:any ,dateCreated:any,availQty:any,aliasEn:any,tax:any,imageUrl:any};\n  selectedAccount : {id:any ,ac_id:any,sub_name:any,sub_type:any,sub_code:any,sub_balance:any,store_id:any ,cat_id:any,cat_name:any,phone:any,address:any,currentCustumerStatus:any};\n  payInvo : {pay_id:any ,pay_ref:any ,store_id:any,tot_pr:any,pay:any,pay_date:any,pay_time:any,user_id:any,cust_id:any,pay_method:any,discount:any ,changee:any,sub_name:any,payComment:any,nextPay:any, yearId:any};\n  radioVal2 : any = 0  // Keep this for initial/final invoice type\n  \n  \n  // Account communication subscription\n  private customerSubscription: Subscription;\n  printMode :boolean = false\n  printArr:Array<any> =[]\n  offline: boolean = false;\n  color :any ='dark'\n  showMe = null\n  status:any = 'new'\n  searchLang :any = 0\n  currentCustumerStatus :any\n  aliasTerm :any =\"\"\n  searchResult :Array<any> =[]\n  aliasResult :Array<any> =[]\n  finalResult :Array<any> =[]\n  year : {id:any ,yearDesc:any ,yearStart :any,yearEnd:any}\n  loadingItems:boolean = false\n  logHistoryArr:Array<any>=[];\n  subiscribtionItem:Subscription\n  subiscribtionNotif:Subscription\n  showNotif = false\n  device :any = \"\"\n  currenQty:any = 0\n  firstQty:any = 0\n  perchTotQty:any = 0\n  payTotQty:any = 0\n  perchTot :any = 0\n  qtyReal:any = 0\n  availQty :any = 0\n\n  pendingItemsFromStock: Array<any> = [];\n  \n  // Default category from localStorage\n  defaultCategoryId: any = null;\n  statusFromRoute: string = '';\n  showBackButton: boolean = false;\n  constructor(private rout : Router ,private platform:Platform,private behavApi:StockServiceService ,private _location: Location, private route: ActivatedRoute,private renderer : Renderer2,private modalController: ModalController,private alertController: AlertController, private authenticationService: AuthServiceService,private storage: Storage,private loadingController:LoadingController, private datePipe:DatePipe,private api:ServicesService,private toast :ToastController, private accountCommunicationService: AccountCommunicationService) {\n  this.selectedAccount = {id:\"\",ac_id:\"\",sub_name:\"\",sub_type:\"\",sub_code:\"\",sub_balance:\"\",store_id:\"\",cat_name:\"\",cat_id:\"\",phone:\"\",address:\"\",currentCustumerStatus:0};\n    this.route.queryParams.subscribe(params => {\n      \n      if (params && params.payInvo) {\n        this.status = 'initial'\n        this.payInvo = JSON.parse(params.payInvo);\n      //  this.payInvo.yearId = this.year.id\n        console.log('params && params.payInvo' , this.payInvo)\n        \n        if(this.payInvo.cust_id == null){\n          // Account will be set via account-selector\n          this.sub_nameNew = JSON.parse(params.sub_name)\n        }else{\n          this.selectedAccount.sub_name = JSON.parse(params.sub_name);\n        }\n        this.user_info = JSON.parse(params.user_info);\n        this.store_info = JSON.parse(params.store_info);\n        this.itemList = JSON.parse(params.itemList);\n        //console.log('lksjda',this.payInvo, this.store_info,  this.user_info ,this.itemList ,this.selectedAccount.sub_name )\n        this.discountPerc = ((+this.payInvo.discount /+this.payInvo.tot_pr) * 100 ).toFixed(2)\n       \n        this.getAppInfoCase2()\n       } else if (params['status'] === 'newInvoFromItemsPage' && params['selectedItemsList']) {\n         console.log('New invoice from items page');\n          this.statusFromRoute = params['status'];\n          this.pendingItemsFromStock = JSON.parse(params['selectedItemsList']);\n          this.showBackButton = true; // Show back button when coming from items page\n          console.log('Received items from stock page:', this.pendingItemsFromStock);\n      }  \n    });\n    \n    this.printArr.push({\n      'payInvo': \"\",\n      'itemList':\"\",\n       'selectedAccount' :\"\",\n        'sub_nameNew' : \"\",\n         \"userInfo\" : \"\" ,\n         \"sub_balanse\": 0,\n         \"balanceStatus\": \"\"\n    })\n    this.selectedItem = {\n      id:undefined,\n      dateCreated:\"\",\n      pay_ref:\"\",\n      item_desc:\"\",\n      item_name:\"\",\n      item_unit:\"\",\n      parcode:0,\n      pay_price:0,\n      perch_price:0,\n      qty:0,\n      tot:0,\n      availQty:0,\n      aliasEn:\"\",\n      tax:0,\n      imageUrl:\"\"\n    }\n  }\n\n  \n    ngOnInit() {  \n     // Check category visibility setting\n     \n     // Subscribe to customer selection from account-selector\n     this.customerSubscription = this.accountCommunicationService.customerSelected$.subscribe(\n       ({id, account}) => {\n         if (id && this.payInvo) {\n           console.log('Customer selected in sales, setting cust_id:', id);\n           this.payInvo.cust_id = id;\n           this.payInvo.sub_name = account.sub_name;\n           this.selectedAccount = account;\n           console.log('Sales payInvo updated:', this.payInvo);\n         }\n       }\n     );\n     \n     if(this.status == 'new'){\n      this.getAppInfo()  \n    // this.newLogic()\n     }else if(this.status == 'initial'){\n      this.getAppInfoCase2() \n      this.radioVal2 = 0  \n     }\n    // this.getStockItems()\n    \n    }\n\n  ngOnDestroy() {\n    if (this.customerSubscription) {\n      this.customerSubscription.unsubscribe();\n    }\n  }\n\n    presentPopover(e?: Event) {\n     //console.log('preent me', e)\n      this.popover.event = e;\n      this.isOpen = true;\n      this.clear()\n      this.searchResult = this.items\n      setTimeout(() => {\n      this.setFocusOnInput('popInput')\n      }, 2000);\n    }\n\n    presentPopoverNotif(e?: Event) {\n      //console.log('preent me', e)\n       this.notifArr = []\n       this.showNotif = false\n       this.popoverNotif.event = e;\n       this.isOpenNotif = true;  \n     }\n\n    didDissmis(){\n      this.isOpen = false\n      //console.log('dismissOver')\n       \n      \n      this.setFocusOnInput('qtyId')\n    }\n\n    didDissmisNotif(){\n      this.isOpenNotif = false\n      //console.log('dismissOver') \n    }\n\n    \n\n    searchItem(ev){\n      this.searchResult = []\n      this.aliasTerm = ev.target.value \n      const filterPipe = new FilterPipe;   \n      let  fiteredArr :any = filterPipe.transform(this.items,ev.target.value); \n      if(fiteredArr.length>0){\n        fiteredArr.forEach(element => {\n          this.searchResult.push( element)\n        });\n      }    //console.log('search',this.searchResult)\n    }\n\n    clear(item_name?){\n     if(item_name){\n      this.selectedItem = {\n        id: undefined,\n        dateCreated: \"\", \n        pay_ref:this.payInvo.pay_ref,\n        item_desc: \"\",\n        item_name: \"\",\n        item_unit: \"\",\n        parcode: 0,\n        pay_price: 0,\n        perch_price: 0,\n        qty: 0,\n        tot: 0,\n        availQty:0,\n        aliasEn:\"\",\n        tax:0,\n        imageUrl:\"\"\n      }\n     }else{\n      this.searchTerm = \"\" \n     }\n    }\n\n    \n\n\n\n    getAllStockItemsWithouteCounts() {\n      console.log('getAllStockItemsWithouteCounts')\n      this.storage.get('year').then((response) => {\n       if (response) {\n        this.year = response\n         console.log('getAllStockItemsWithouteCounts',this.year.id)\n        if (this.offline == false) {\n          this.loadingItems = true\n          this.api.getAllStockItemsWithouteCounts(1,this.year.id).subscribe(data => {\n            //console.log(data)\n            let res = data\n            this.items = res['data'] \n            this.loadingItems = false \n            this.storage.set('itemsLocal' , this.items).then((response) => {\n             \n            });\n          }, (err) => {\n            this.loadingItems = false\n            //console.log(err);\n          },\n            () => {\n              this.loadingItems = false\n            }\n          )\n        } \n        } \n      }); \n    }\n\n///\n  onItemSelected(selectedItem: any) {\n    console.log('Item selected:', selectedItem);\n    // You can perform any additional logic when an item is selected\n    // For example, update availability or perform validations\n  }\n\n  onItemAdded(selectedItem: any) {\n    console.log('Item to be added:', selectedItem);\n   \n    // Check if item already exists in the list\n    let existingItem = this.itemList.find(item => \n      item.item_name === selectedItem.item_name && \n      item.pay_price === selectedItem.pay_price\n    );\n\n    if (existingItem) {\n      // Update existing item quantity\n      let newQty = +existingItem.quantity + +selectedItem.qty;\n      \n      // Check if new quantity exceeds available stock\n      if (newQty > selectedItem.availQty) {\n        this.presentToast('الصنف موجود بالقائمة، مجموع الكمية الجديد أكبر من المتوفر في المخزن', 'warning');\n \n      }\n      \n      existingItem.quantity = newQty;\n      existingItem.tot = (newQty * +existingItem.pay_price).toFixed(2);\n    } else {\n      // Add new item to list\n      let d = new Date();\n      let r = this.datePipe.transform(d, 'dd-MM-YYYY');\n\n      this.itemList.push({\n        \"id\": 'NULL',\n        \"pay_ref\": this.payInvo.pay_ref,\n        \"item_name\": selectedItem.item_name,\n        \"pay_price\": selectedItem.pay_price,\n        \"quantity\": +selectedItem.qty,\n        \"tot\": (selectedItem.qty * +selectedItem.pay_price).toFixed(2),\n        \"store_id\": +this.store_info.id,\n        \"yearId\": +this.year.id,\n        \"item_id\": +selectedItem.id,\n        \"dateCreated\": r,\n        \"perch_price\": selectedItem.perch_price,\n        \"tax\": selectedItem.tax,\n        \"imageUrl\": selectedItem.imageUrl\n      });\n    }\n\n    // Reset discount and recalculate totals\n    this.discountPerc = 0;\n    this.payInvo.discount = 0;\n    this.getTotal();\n    this.updateSortedList();\n    \n    // this.presentToast('تم إضافة الصنف بنجاح', 'success');\n  }\n\n\n\n \n \n\n  async presentAlertConfirm(initial?) {\n    let msg:string = 'هل تريد طباعة فاتورة ؟ '\n    if(initial){\n       msg   = 'هل تريد حذف السجل ؟ '\n    }\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'تأكيد!',\n      mode:'ios' ,\n      message: msg,\n      buttons: [\n        {\n          text: 'إلغاء',\n          role: 'cancel',\n          cssClass: 'secondary',\n          id: 'cancel-button',\n          handler: (blah) => {\n          //console.log('Confirm Cancel: blah'); \n           // Do not reset invoice data when user cancels deletion\n          }\n        }, {\n          text: 'موافق',\n          id: 'confirm-button',\n          handler: () => {\n            if(initial){\n            this.deleteSalesInvoInit()\n            }else{\n              this.presentModal(this.printArr , 'sales')\n            } \n          }\n        }\n      ]\n    });\n  \n    await alert.present();\n  }\n\n  Print(elem){ \n      this.printMode = true \n      var mywindow = window.open('', 'PRINT', 'height=400,width=600'); \n      mywindow.document.write('<html><head>'); \n      mywindow.document.write('<style type=\"text/css\">')\n      mywindow.document.write('.sumsDiv{border-style: solid;border-color: gray;border-width: .5px;} .flr{ display: block; float: right; } .show{ } .hide{width:0px;height:0px} .w45 {width:45%} .w50 {width:50%} .w100 {width:100%} td, th {border: 1px solid #dddddd;text-align: center;padding: 8px;} tr:nth-child(even) {background-color: #dddddd;} .table{text-align: center;width: 100%; margin: 12px;}.ion-margin{ margin: 10px; } .ion-margin-top{ margin-top: 10px; } .rtl {  direction: rtl; } .ion-text-center{ text-align: center; } .ion-text-end{ text-align: left; } .ion-text-start{ text-align: right; }')\n      mywindow.document.write('</style></head><body>');\n     \n      mywindow.document.write(document.getElementById(elem).innerHTML);\n      mywindow.document.write('</body></html>');\n  \n      mywindow.document.close(); // necessary for IE >= 10\n      mywindow.focus(); // necessary for IE >= 10*/ \n      mywindow.print();\n      mywindow.close();\n      this.printMode = false  \n      return true;  \n  }\n\n  \n\n  \n   \n  getAppInfo(){ \n   \n     this.storage.get('USER_INFO').then((response) => {\n      if (response) {\n        this.user_info = response\n        //console.log(this.user_info) \n      }\n    });\n    this.storage.get('year').then((response) => {\n      if (response) {\n        this.year = response \n      } \n    });\n\n    this.storage.get('itemsLocal').then((response) => {\n      if (response) {\n         this.items = response \n         if (this.items.length == 0 || !this.items) {\n           this.getAllStockItemsWithouteCounts()\n         } else {\n         }\n      }\n    });\n    this.storage.get('STORE_INFO').then((response) => {\n      if (response) {\n        this.store_info = response\n        \n        \n        this.prepareInvo()\n      }\n    }); \n    \n  \n\n    \n  }\n  \n  getAppInfoCase2(){  \n    \n     this.storage.get('USER_INFO').then((response) => {\n      if (response) {\n        this.user_info = response\n        //console.log(this.user_info) \n      }\n    });\n    this.storage.get('year').then((response) => {\n      if (response) {\n        this.year = response \n      } \n    });\n    this.storage.get('STORE_INFO').then((response) => {\n      if (response) {\n        this.store_info = response\n        \n      }\n    });\n    \n    this.storage.get('STORE_INFO').then((response) => {\n      if (response) {\n        this.store_info = response\n         \n      }  \n    }); \n\n    this.storage.get('itemsLocal').then((response) => {\n      if (response) {\n         this.items = response \n        \n        \n\n      }\n    });\n    \n    \n  }\n\n \n\n // ne logic \n async  newLogic(){\n  //console.log('new logic')\n    await this.getAppInfo() \n    await this.prepareInvo()\n }\n \n  \n\n  \n \n\n   radioChange2(ev ,form?){\n    console.log(ev.target.value)  \n    console.log(this.status)\n    if(form == 'from'){  \n      if(ev.target.value == 1 && this.status == 'initial'){  \n        console.log(this.status) \n        this.status = 'toFinal'\n        this.payInvo.yearId = this.year.id\n        if(this.itemList.length>0){\n          this.itemList.forEach(element =>{\n            element.yearId =this.year.id\n          })\n        }\n        console.log('convert invo to final',this.status)\n      }else if(ev.target.value == 0 && this.status == 'toFinal'){ \n        this.status = 'initial'\n        console.log('from final to initial',this.status)\n      }\n    } \n   }\n\n  prepareInvo(){  \n        this.selectedAccount = {id:\"\",ac_id:\"\",sub_name:\"\",sub_type:\"\",sub_code:\"\",sub_balance:\"\",store_id:\"\",cat_name:\"\",cat_id:\"\",phone:\"\",address:\"\",currentCustumerStatus:0};\n        this.sub_nameNew = \"\"\n        // radioVal removed - using only account-selector\n        this.radioVal2 = 0\n        this.payInvo ={pay_id:undefined ,pay_ref:0 ,store_id:\"\",tot_pr:0,pay:0,pay_date:\"\",pay_time:\"\",user_id:\"\",cust_id:null,pay_method:\"\",discount:0 ,changee:0,sub_name:\"\",payComment:\"\",nextPay:null, yearId:this.year.id};\n        this.discountPerc = 0\n        let d = new Date\n      // this.payInvo.pay_date  = d.getMonth().toString() + \"/\" + d.getDay().toString()+ \"/\" + d.getFullYear().toString() \n       this.payInvo.pay_date = this.datePipe.transform(d, 'yyyy-MM-dd')\n       this.payInvo.pay_time = this.datePipe.transform(d, 'HH:mm:ss') \n       this.generateRandom()  \n       this.payInvo.store_id =this.store_info.id\n       this.payInvo.user_id = this.user_info.id\n       this.payInvo.yearId = this.year.id\n       //console.log(this.payInvo) \n       this.itemList = []\n       \n        \n    if (this.statusFromRoute === 'newInvoFromItemsPage' && this.pendingItemsFromStock.length > 0) {\n      //console.log('Pending items from stock page:', this.pendingItemsFromStock);\n      this.pendingItemsFromStock.forEach(item => {\n       \n        this.itemList.push({\n      \"id\" : 'NULL',\n      \"pay_ref\" :this.payInvo.pay_ref,\n      \"item_name\" :item.item_name,\n      \"pay_price\" :item.pay_price,\n      \"quantity\" : +item.qty,\n      \"tot\" :(+item.qty * +item.pay_price).toFixed(2),\n      \"store_id\" :+this.store_info.id, \n      \"yearId\" :+this.year.id, \n      \"item_id\" : +item.id,\n      \"dateCreated\" : this.datePipe.transform(d, 'dd-MM-YYYY'),\n      \"perch_price\":item.perch_price,\n      \"tax\":item.tax,\n      \"imageUrl\":item.imageUrl\n          \n        });\n      });\n      this.statusFromRoute = '';\n       this.pendingItemsFromStock = []; // Reset status after processing\n       this.getTotal()\n    }\n    \n\n \n  }\n \n   setFocusOnInput(Input) {\n     //console.log('setFocusOnInput')\n     if (Input == 'dst') { \n      this.nameField.nativeElement.focus(); \n     } else if(Input == 'dstPop') {\n      this.dstPop.setFocus();\n      this.isOpen = true;\n      this.clear()\n      this.searchResult = this.items\n      setTimeout(() => {\n          this.popInput.setFocus(); \n      }, 1500);\n    \n     }else if(Input == 'qtyId') {\n      this.qtyId.setFocus();  \n     }else if(Input == 'popInput'){\n      this.popInput.setFocus();  \n     }\n   }\n\n\n   isFocused(event){\n    //console.log('dsdfsdf',event)\n  }\n\n   \n \ngenerateRandom():any{\n  let da = new Date \n  //console.log(da)\n  let randomsNumber = da.getMonth().toString() + da.getDay().toString() + da.getHours().toString()+ da.getMinutes().toString()+da.getSeconds().toString()+da.getMilliseconds().toString()\n  this.payInvo.pay_ref = this.store_info.store_ref + randomsNumber\n    \n}\n\n\n\n \n\nselectFromPop(item){\n//console.log(item)\nthis.selectedItem = {\n  id:item.id,\n  dateCreated:item.dateCreated,\n  pay_ref:this.payInvo.pay_ref,\n  item_desc:item.item_desc,\n  item_name:item.item_name,\n  item_unit:item.item_unit,\n  parcode:item.parcode,\n  pay_price:item.pay_price,\n  perch_price:item.perch_price,\n  qty:\"\",\n  tot:item.pay_price,\n  availQty:item.quantity,\n  aliasEn:item.aliasEn,\n  tax:item.tax,\n  imageUrl:item.imageUrl\n} \n this.searchTerm = item.item_name\n  //console.log( this.selectedItem); \n  this.didDissmis()\n  //perform calculate here so moataz can get the qty\n}\n\n \n\n \n\n\npickDetail(ev){ \n  let fl : Array<any>=[]\n  if(this.searchLang == 1){\n     fl= this.items.filter(x=>x.item_desc == ev.target.value)\n    //console.log('hyrr',fl);\n  } else {\n     fl= this.items.filter(x=>x.item_name == ev.target.value)\n    //console.log(fl);\n  }\n \n  if (fl.length > 0) {\n    this.selectedItem = {\n    id:fl[0]['id'],\n    dateCreated:fl[0]['dateCreated'],\n    pay_ref:this.payInvo.pay_ref,\n    item_desc:fl[0]['item_desc'],\n    item_name:fl[0]['item_name'],\n    item_unit:fl[0]['item_unit'],\n    parcode:fl[0]['parcode'],\n    pay_price:fl[0]['pay_price'],\n    perch_price:fl[0]['perch_price'],\n    qty:\"\",\n    tot:fl[0]['pay_price'],\n    availQty:fl[0]['quantity'],\n    aliasEn:fl[0]['aliasEn'],\n    tax:fl[0]['tax'],\n    imageUrl:fl[0]['imageUrl']\n  }\n  //console.log( this.selectedItem);\n  this.setFocusOnInput('qtyId')\n  }else{\n    this.presentToast('خطأ في اسم الصنف ', 'danger') \n    this.selectedItem.item_name =\"\"\n    this.selectedItem.item_desc =\"\"\n  } \n}\n\nqtyhange(ev){\n  //console.log(ev);\n  this.selectedItem.tot =  (this.selectedItem.qty * +this.selectedItem.pay_price).toFixed(2)\n\n  let fl : Array<any> = []\n  if (this.itemList.length > 0) {\n      fl = this.itemList.filter(x => x.item_name == this.selectedItem.item_name )\n    if (fl.length> 0){\n      //console.log(fl)\n      if(+this.selectedItem.qty + +fl[0].quantity > +this.selectedItem.availQty){\n        this.presentToast('الصنف موجود بالقائمة , مجموع الكمية الجديد اكبر من المتوفر في المخزن','warning')\n       }\n    }else{\n      if(+this.selectedItem.qty > +this.selectedItem.availQty){\n        this.presentToast('الكمية في المخزن غير كافية','warning')\n       }\n    }\n  }else{\n    if(+this.selectedItem.qty > +this.selectedItem.availQty){\n      this.presentToast('الكمية في المخزن غير كافية','warning')\n     }\n  }\n\n \n}\n\npricehange(ev){\n  //console.log(ev);\n  this.selectedItem.tot =  (this.selectedItem.qty * +this.selectedItem.pay_price).toFixed(2)\n}\n\npayChange(ev){\n  //console.log(ev); \n  if(this.discountPerc>0){\n    this.payInvo.discount = (+this.payInvo.tot_pr * +this.discountPerc/100).toFixed(2)\n  }\n  this.payInvo.changee = +( this.payInvo.tot_pr - +this.payInvo.discount) - ev.target.value \n\n}\n\nonDiscountTypeChange(event: any) {\n    this.discountType = event.detail.value;\n    // Reset discount values when switching types\n    this.discountPerc = 0;\n    this.discountAmount = 0;\n    this.payInvo.discount = 0;\n    this.calculatedDiscountPerc = 0;\n    this.calculatedDiscountAmount = 0;\n    this.calculateChange();\n  }\n\n  onPercentageDiscountChange(event: any) {\n    this.discountPerc = event.target.value || 0;\n    if (this.payInvo.tot_pr > 0) {\n      // Calculate discount amount based on percentage\n      this.calculatedDiscountAmount = (+this.payInvo.tot_pr * +this.discountPerc / 100);\n      this.payInvo.discount = this.calculatedDiscountAmount.toFixed(2);\n      this.calculateChange();\n    }\n  }\n\n   onAmountDiscountChange(event: any) {\n    this.discountAmount = event.target.value || 0;\n    if (this.payInvo.tot_pr > 0 && this.discountAmount > 0) {\n      // Calculate discount percentage based on amount\n      this.calculatedDiscountPerc = ((+this.discountAmount / +this.payInvo.tot_pr) * 100);\n      this.payInvo.discount = this.discountAmount;\n      this.calculateChange();\n    } else {\n      this.calculatedDiscountPerc = 0;\n      this.payInvo.discount = 0;\n      this.calculateChange();\n    }\n  }\n\n  calculateChange() {\n    this.payInvo.changee = +(this.payInvo.tot_pr - +this.payInvo.discount) - this.payInvo.pay;\n  }\n\n  // Update your existing discountChange method\n  discountChange(ev) {\n    // Keep this for backward compatibility if needed\n    this.discountPerc = ((+this.payInvo.discount / +this.payInvo.tot_pr) * 100).toFixed(2);\n    this.payInvo.changee = +(this.payInvo.tot_pr - ev.target.value) - this.payInvo.pay;\n  }\n\n  // Update your existing discountPerChange method\n  discountPerChange(ev) {\n    // Keep this for backward compatibility if needed\n    this.payInvo.discount = (+this.payInvo.tot_pr * +this.discountPerc / 100).toFixed(2);\n    this.payInvo.changee = +(this.payInvo.tot_pr - this.payInvo.discount) - this.payInvo.pay;\n  }\n\n  // Update your getTotal method to reset discount calculations\n  getTotal() {\n    let sum = this.itemList.reduce((acc, obj) => { return acc + +obj.tot; }, 0);\n    this.payInvo.tot_pr = sum - +this.payInvo.discount;\n    this.payInvo.changee = +(sum - +this.payInvo.discount) - this.payInvo.pay;\n    this.payInvo.tot_pr = this.payInvo.tot_pr.toFixed(2);\n    this.payInvo.changee = this.payInvo.changee.toFixed(2);\n    \n    // Recalculate discount labels when total changes\n    if (this.discountType === 'percentage' && this.discountPerc > 0) {\n      this.calculatedDiscountAmount = (sum * +this.discountPerc / 100);\n    } else if (this.discountType === 'amount' && this.discountAmount > 0) {\n      this.calculatedDiscountPerc = ((+this.discountAmount / sum) * 100);\n    }\n  }\n \n\n// getTotal(){\n//   let sum = this.itemList.reduce( (acc, obj)=> { return acc + +obj.tot; }, 0);\n//   //console.log('sum', sum)\n//   this.payInvo.tot_pr = sum - +this.payInvo.discount \n//   this.payInvo.changee = +(sum - +this.payInvo.discount) - this.payInvo.pay\n//   this.payInvo.tot_pr = this.payInvo.tot_pr.toFixed(2)\n//   this.payInvo.changee = this.payInvo.changee.toFixed(2)\n// } \n\n\n\n// discountChange(ev){\n//   //console.log('discountChange' ,ev); \n//   this.discountPerc = ((+this.payInvo.discount /+this.payInvo.tot_pr) * 100 ).toFixed(2)\n//   this.payInvo.changee = +( this.payInvo.tot_pr - ev.target.value) - this.payInvo.pay\n// }\n\n// discountPerChange(ev){\n//   //console.log('discountPerChange',ev);\n//   this.payInvo.discount = (+this.payInvo.tot_pr * +this.discountPerc/100).toFixed(2)\n//   this.payInvo.changee = +( this.payInvo.tot_pr -  this.payInvo.discount ) - this.payInvo.pay\n// }\n\ndeleteItem(index){\n//console.log( index); \nconst displayList = this.getDisplayItemList();\nconst itemToDelete = displayList[index];\n\n// Find the item in the original itemList and remove it\nconst originalIndex = this.itemList.findIndex(item => \n  item.item_name === itemToDelete.item_name && \n  item.pay_price === itemToDelete.pay_price &&\n  item.quantity === itemToDelete.quantity\n);\n\nif (originalIndex !== -1) {\n  this.itemList.splice(originalIndex, 1);\n}\n\nthis.payInvo.pay = 0\nthis.discountPerc = 0\nthis.payInvo.discount = 0 \nthis.getTotal()\nthis.updateSortedList()\n}\n\nasync presentToast(msg,color?) {\n  const toast = await this.toast.create({\n    message: msg,\n    duration: 2000,\n    color:color,\n    cssClass:'cust_Toast',\n    mode:'ios',\n    position:'top' \n  });\n  toast.present();\n}\n\n\n\nrefresh(item?){ \n  console.log('refreshPerform')\n    this.getAllStockItemsWithouteCounts()\n   \n}\n\naddTolist() {\n    if (this.selectedItem.item_name == \"\" || this.selectedItem.id == \"\" || +this.selectedItem.qty == 0 ) {\n      this.presentToast('الرجاء اختيار الصنف وتحديد الكمية', 'danger')\n    } else {\n      let fl: any = []\n      if (this.itemList.length > 0) {\n        fl = this.itemList.filter(x => x.item_name == this.selectedItem.item_name &&  x.pay_price == this.selectedItem.pay_price)\n      }\n\n      if (fl.length == 0) {\n        let d =   new Date\n        let r= this.datePipe.transform(d, 'dd-MM-YYYY')\n  \n        this.itemList.push({\n        \"id\" : 'NULL',\n        \"pay_ref\" :this.selectedItem.pay_ref,\n        \"item_name\" :this.selectedItem.item_name,\n        \"pay_price\" :this.selectedItem.pay_price,\n        \"quantity\" : +this.selectedItem.qty,\n        \"tot\" :this.selectedItem.tot, \n        \"store_id\" :+this.store_info.id, \n        \"yearId\" :+this.year.id, \n        \"item_id\" : +this.selectedItem.id,\n        \"dateCreated\" : r,\n        \"perch_price\":this.selectedItem.perch_price,\n        \"tax\":this.selectedItem.tax,\n        \"imageUrl\":this.selectedItem.imageUrl\n        })\n         \n        \n      } else {\n        //console.log(this.itemList);\n        //console.log(fl[0].quantity);\n        //console.log(+this.selectedItem.qty);\n\n        this.selectedItem.qty = +fl[0].quantity + +this.selectedItem.qty\n        let index = this.itemList.map(e => e.item_name).indexOf(this.selectedItem.item_name);\n        this.itemList[index].quantity = +this.selectedItem.qty\n        this.itemList[index].tot =  (this.selectedItem.qty * +this.selectedItem.pay_price).toFixed(2)\n       // this.itemList[index].tot.toFixed(2)\n        \n      }\n\n      this.selectedItem = {\n        id: undefined,\n        dateCreated: \"\", \n        pay_ref:this.payInvo.pay_ref,\n        item_desc: \"\",\n        item_name: \"\",\n        item_unit: \"\",\n        parcode: 0,\n        pay_price: 0,\n        perch_price: 0,\n        qty: 0,\n        tot: 0,\n        availQty:0,\n        aliasEn:\"\",\n        tax:0,\n        imageUrl:\"\"\n      }\n      this.discountPerc = 0\n      this.payInvo.discount = 0\n      \n      this.getTotal()\n      this.setFocusOnInput('dstPop')\n    }  \n}\n\n  qtyClick(i){\n    //console.log(i)\n    this.showMe = i\n  }\n\n  hideMe(i){\n    this.showMe = null \n  }\n\n  editCell(i){\n    const displayList = this.getDisplayItemList();\n    const itemToEdit = displayList[i];\n    \n    // Find the corresponding item in the original itemList\n    const originalIndex = this.itemList.findIndex(item => \n      item.item_name === itemToEdit.item_name && \n      item.pay_price === itemToEdit.pay_price\n    );\n    \n    if (originalIndex !== -1 && +displayList[i].quantity > 0 && +displayList[i].pay_price > 0) {\n      // Update both the display list and original list\n      displayList[i].tot = +displayList[i].quantity * displayList[i].pay_price;\n      this.itemList[originalIndex].quantity = displayList[i].quantity;\n      this.itemList[originalIndex].pay_price = displayList[i].pay_price;\n      this.itemList[originalIndex].tot = displayList[i].tot;\n      \n      this.discountPerc = 0\n      this.payInvo.discount = 0\n      this.hideMe(i)\n      this.getTotal() \n    } else {\n      this.presentToast(\"خطأ في الإدخال \", \"danger\")\n    }\n   \n  }\n\n\nvalidate():boolean{\n  // Simplified validation - no more radio dependencies\n  if (this.itemList.length == 0  || this.payInvo.pay_ref == \"\" ) {\n    this.presentToast('الرجاء ادخال اصناف الي القائمة','danger')\n    return false\n  }\n  else if(!this.payInvo.cust_id || !this.selectedAccount.sub_name) {\n    this.presentToast('الرجاء إختيار حساب العميل','danger')\n    return false\n  }\n  else if(this.payInvo.pay_date == \"\" || this.payInvo.pay_date == undefined) {\n    this.presentToast('الرجاء تحديد التاريخ ','danger')\n    return false\n  }\n  else if(this.payInvo.changee < 0 ) {\n    this.presentToast('الرجاء مراجعة المبلغ المستلم والخصم  ','danger')\n    return false\n  }\n  else {\n    return true\n  }\n}\n\nsaveIntial(){ \n  // Account info already set by account-selector service  \n  // check if the invoice is exist\n if(this.initialInvoices.length > 0){ \n  this.initialInvoices = this.initialInvoices.filter(x=>x['payInvo'].pay_ref != this.payInvo.pay_ref) \n  }\n\n  this.initialInvoices.push({\n    \"payInvo\": this.payInvo,\n    \"itemList\": this.itemList\n  })\n  this.storage.set('initialInvoices', this.initialInvoices).then((response) => {\n    this.printArr = []\n    \n    this.printArr.push({\n      'payInvo': this.payInvo,\n      'itemList':this.itemList,\n      'selectedAccount' : this.selectedAccount,\n      'sub_nameNew' : this.sub_nameNew ,\n      \"user_name\" : this.user_info.full_name ,\n      \"sub_balanse\": this.selectedAccount.sub_balance,\n      \"balanceStatus\":  this.selectedAccount.currentCustumerStatus \n    }) \n      //console.log(this.printArr)\n      this.presentAlertConfirm()\n      this.presentToast('تم الحفظ بنجاح', 'success')\n      this.prepareInvo()\n      this.status = 'new'\n    });  \n}\n\n\nsaveInvoInit() {\n  // Optimized: Save invoice and items together in single API call\n  const invoiceWithItems = {\n    invoice: this.payInvo,\n    items: this.itemList\n  };\n  \n  console.log('Sending invoice data to saveInvoInit:', invoiceWithItems);\n  console.log('PayInvo object:', this.payInvo);\n  console.log('ItemList array:', this.itemList);\n  \n  this.api.saveSalesInvoInitWithItems(invoiceWithItems).subscribe(\n    (response: any) => {\n      console.log('Initial invoice and items saved:', response);\n      this.handleSaveSuccess();\n    }, \n    (err) => {\n      console.log('Save error:', err);\n      console.log('Error details:', err);\n      this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري', 'danger');\n      this.loadingController.dismiss();\n    }\n  );\n}\n \ndeleteInitial(){\n  if(this.initialInvoices.length > 0){ \n     this.initialInvoices = this.initialInvoices.filter(x=>x['payInvo'].pay_ref != this.payInvo.pay_ref) \n    } \n     this.storage.set('initialInvoices', this.initialInvoices).then((response) => { \n      this.presentToast('تم الحذف بنجاح' , 'success') \n      this.status = 'new'\n      this.prepareInvo()\n      });    \n}\n\n\n\ndeleteSalesInvoInit(){ \n  if(this.status != 'toFinal'){\n    this.presentLoadingWithOptions('جاري حذف البيانات ...') \n  } \n \n  const deletionData = {\n    pay_id: this.payInvo.pay_id,\n    pay_ref: this.payInvo.pay_ref\n  };\n\n  this.api.deleteSalesInvoInitWithItems(deletionData).subscribe(data => {\n    //console.log(data)\n    if (data['success']) {\n      if(this.status != 'toFinal'){\n        this.presentToast('تم الحذف بنجاح' , 'success') \n        this.prepareInvo()\n        // Navigate back to previous page after successful deletion\n        setTimeout(() => {\n          this.back()\n        }, 1500); // Give time for toast to show\n      } \n    }else{\n      this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n    }\n  },(err) => {\n    //console.log(err);\n    this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n  },() => {\n    if(this.status != 'toFinal'){\n      this.loadingController.dismiss()\n    }\n  }) \n}\n\n\ndeleteSalesitemListInit(){  \n  this.api.deleteSalesitemListInit(this.payInvo.pay_ref).subscribe(data => {\n  //console.log(data)\n  if (data['message'] != 'Post Not Deleted') { \n    if(this.status != 'toFinal'){\n      this.presentToast('تم الحذف بنجاح' , 'success') \n     this.prepareInvo()\n    } \n  }else{\n   this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n  }\n},(err) => {\n  //console.log(err);\n  this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n  \n },() => {\n   this.loadingController.dismiss()\n }) \n}\n\n  save() {\n    let d: Date = this.payInvo.pay_date\n    this.payInvo.sub_name = this.selectedAccount.sub_name\n    this.payInvo.pay_date = this.datePipe.transform(d, 'yyyy-MM-dd')\n    //console.log('save testing', this.payInvo, this.payInvo.sub_name)\n    if (this.validate() == true) {\n      // Check quantity validation for final invoices (radioVal2 = 1)\n      if (this.radioVal2 == 1) {\n        this.validateStockQuantityBeforeSave()\n      } else {\n        this.proceedWithSave()\n      }\n    }\n  }\n\n  private validateStockQuantityBeforeSave() {\n    this.presentLoadingWithOptions('جاري التحقق من الكميات المتوفرة ...')\n    console.log('validateStockQuantityBeforeSave' ,this.itemList)\n    // Prepare item list for validation\n    const itemsToValidate = this.itemList.map(item => ({\n      item_id: item.item_id,\n      quantity: item.quantity\n    }))\n    console.log('item' , itemsToValidate  )\n\n    this.api.validateStockQuantity(this.store_info.id, itemsToValidate).subscribe(\n      (response: any) => {\n        this.loadingController.dismiss()\n        \n        if (response.success && response.valid) {\n          // All items have sufficient stock, proceed with save\n          this.proceedWithSave()\n        } else if (response.success && !response.valid) {\n          // Some items have insufficient stock, show dialog\n          console.log('response insuffiecnt',response.insufficient_items)\n          this.showInsufficientStockDialog(response.insufficient_items)\n        } else {\n          // API error\n          this.presentToast('خطأ في التحقق من الكميات المتوفرة', 'danger')\n        }\n      },\n      (error) => {\n        this.loadingController.dismiss()\n        console.error('Stock validation error:', error)\n        this.presentToast('خطأ في الاتصال أثناء التحقق من الكميات', 'danger')\n      }\n    )\n  }\n\n  private async showInsufficientStockDialog(insufficientItems: any[]) {\n    const { InsufficientStockDialogComponent } = await import('../component/insufficient-stock-dialog/insufficient-stock-dialog.component')\n    \n    const modal = await this.modalController.create({\n      component: InsufficientStockDialogComponent,\n      componentProps: {\n        insufficientItems: insufficientItems,\n        store_info: this.store_info,\n        user_info: this.user_info,\n        year: this.year\n      },\n      cssClass: 'insufficient-stock-modal',\n      backdropDismiss: false\n    })\n\n    return await modal.present()\n  }\n\n  private proceedWithSave() {\n    this.presentLoadingWithOptions('جاري حفظ البيانات ...')\n    \n    // Simplified save logic - account already selected via account-selector\n    if (this.radioVal2 == 0 && this.status == 'new') {\n      // Initial invoice\n      this.saveInvoInit()\n    } else if(this.radioVal2 == 0 && this.status == 'initial') {\n      // Update initial invoice\n      this.updateInitInvo()\n    } else {\n      // Final invoice - account already exists with valid ID\n      this.saveInvo()\n    }\n  }\n\n\n \n\n\n      saveLogHistory(){  \n        //let mdata =  this.prepareLogHistory(itemData , firstq , role) \n        //console.log('this.logHistoryArr[0]',this.logHistoryArr[0])\n         let role\n         let cust\n         let invo \n         if (this.logHistoryArr.length > 1) {\n          invo = this.logHistoryArr[1]\n          cust = this.logHistoryArr[0]\n          role = 'new account'\n         } else {\n          invo = this.logHistoryArr[0]\n          role = undefined\n         }\n        this.api.saveLogHistoryMultiSales(invo ,cust,role).subscribe(data => {\n         //console.log(data)\n         if (data['message'] != 'Post Not Created') { \n          this.logHistoryArr = []\n          this.presentAlertConfirm() \n          this.presentToast('تم الحفظ بنجاح', 'success')\n          // this.getStockItems()\n         }else{\n           this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري', 'danger') \n         }\n       }, (err) => {\n         //console.log(err);\n         this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري', 'danger')\n       }) \n      }\n\n\n   async presentLoadingWithOptions(msg?) {\n    const loading = await this.loadingController.create({\n      spinner: 'bubbles',\n      mode:'ios',\n      duration: 5000,\n      message: msg,\n      translucent: true,\n      backdropDismiss: false\n    });\n    await loading.present(); \n    const { role, data } = await loading.onDidDismiss();\n  }\n\n  async presentModal(printArr: any, page: string) {\n    const modal = await this.modalController.create({\n      component: PrintModalPage,\n      componentProps: {\n        printArr: printArr,\n        page: page\n      }\n    });\n    return await modal.present();\n  }\n\n  async  performSync(){\n   \n  await this.getAllStockItemsWithouteCounts()\n  }\n\n\n\n  back(){\n    this._location.back()\n  }\n\n  updateInitInvo(){\n    this.api.updateInitSalesInvo(this.payInvo).subscribe(data => {\n    //console.log(data)\n     this.deleteSalesitemListInit4update()\n      }, (err) => {\n      //console.log(err);\n      this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري', 'danger').then(()=>{\n        this.loadingController.dismiss()\n      })\n     })\n  }\n\n\n    deleteSalesitemListInit4update(){  \n      this.api.deleteSalesitemListInit(this.payInvo.pay_ref).subscribe(data => {\n      //console.log(data)\n      if (data['message'] != 'Post Not Deleted') { \n        this.saveitemListinit()   \n      }else{\n       this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري', 'danger').then(()=>{\n        this.loadingController.dismiss()\n      })\n      } \n    },(err) => {\n      //console.log(err);\n      this.presentToast('لم يتم حذف البيانات , خطا في الإتصال حاول مرة اخري', 'danger').then(()=>{\n        this.loadingController.dismiss()\n      })\n      \n     }) \n    }\n\n\n    preparenewaccount(){ \n      if (this.selectedAccount.sub_name.length>0 && this.selectedAccount.id == null) {\n      // this.selectedAccount.sub_name = this.payInvo.sub_name\n      } else {\n        //console.log('slwcted from drop' ) \n          this.selectedAccount.sub_name = this.sub_nameNew\n          this.payInvo.sub_name  =this.selectedAccount.sub_name\n      }\n        this.selectedAccount.id=null  \n        this.selectedAccount.ac_id = 1 \n        this.selectedAccount.sub_type=\"debit\"\n        this.selectedAccount.sub_code=null\n        this.selectedAccount.sub_balance=\"0\"\n        this.selectedAccount.cat_id = 1\n        this.selectedAccount.cat_name = 'العملاء'\n        this.selectedAccount.store_id=this.store_info.id  \n    }\n\n \n doubleCheckForFinalStatus (){\n\n  this.route.queryParams.subscribe(params => { \n    if (params && params.payInvo) {\n      this.status = 'toFinal'\n      this.payInvo = JSON.parse(params.payInvo);\n      this.payInvo.yearId = this.year.id\n      this.itemList.forEach(element => {\n        element.yearId = this.payInvo.yearId\n      }); \n    }\n  })\n }\n\n  saveInvo() { \n\n    this.doubleCheckForFinalStatus()\n    // Optimized: Save invoice and items together in single API call\n    const invoiceWithItems = {\n      invoice: this.payInvo,\n      items: this.itemList\n    };\n    console.log('status' , this.status , invoiceWithItems)\n    this.api.saveSalesInvoWithItems(invoiceWithItems).subscribe(\n      (response: any) => {\n        console.log('Final invoice and items saved:', response);\n       \n        this.handleSaveSuccess();\n      }, \n      (err) => {\n        console.log('Save error:', err);\n        this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري', 'danger');\n        this.loadingController.dismiss();\n      }\n    );\n  }\n\n\n  \n\n\n  // Shared success handler for optimized save process\n  private handleSaveSuccess() {\n    this.presentToast('تم الحفظ بنجاح', 'success');\n\n     // Check if invoice was converted from initial to final and delete initial invoice\n     if (this.status == 'toFinal') {\n      console.log('case delete intial', this.status)\n      this.deleteSalesInvoInit();\n    }\n\n    this.printArr = []; \n    this.printArr.push({\n      'payInvo': this.payInvo,\n      'itemList': this.itemList,\n      'selectedAccount': this.selectedAccount,\n      'sub_nameNew': this.sub_nameNew,\n      \"user_name\": this.user_info.full_name,\n      \"sub_balanse\": this.selectedAccount.sub_balance,\n      \"balanceStatus\": this.selectedAccount.currentCustumerStatus\n    });\n    \n    console.log('Print array prepared:', this.printArr);\n    this.presentAlertConfirm();\n    this.prepareInvo();\n    \n   \n    \n    this.status = 'new';\n\n    \n    // Navigate back if coming from items page\n    if (this.showBackButton) {\n      setTimeout(() => {\n        this.goBack();\n      }, 1500); // Give time for toast to show\n    }\n    \n    this.loadingController.dismiss();\n  }\n\n  // Legacy method - kept for compatibility but no longer used in optimized flow\n  saveitemList(){  \n    this.api.saveSalesitemList(this.itemList).subscribe(data=>{ \n      //console.log(data)  \n      this.presentToast('تم الحفظ بنجاح' , 'success') \n      this.printArr = []\n   \n      this.printArr.push({\n        'payInvo': this.payInvo,\n        'itemList':this.itemList,\n        'selectedAccount' : this.selectedAccount,\n        'sub_nameNew' : this.sub_nameNew ,\n        \"user_name\" : this.user_info.full_name ,\n        \"sub_balanse\": this.selectedAccount.sub_balance,\n        \"balanceStatus\":  this.selectedAccount.currentCustumerStatus \n      }) \n        //console.log(this.printArr)\n        this.presentAlertConfirm()\n        this.presentToast('تم الحفظ بنجاح', 'success')\n        this.prepareInvo()\n        this.status = 'new'\n \n    }, (err) => {\n      //console.log(err);\n      this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n    }, () => {\n      this.loadingController.dismiss()\n    }\n    )      \n    }\n\n // Legacy method - kept for compatibility but no longer used in optimized flow\n saveitemListinit(){  \n  this.api.saveSalesitemListInit(this.itemList).subscribe(data=>{ \n   \n    this.printArr = []\n   \n    this.printArr.push({\n      'payInvo': this.payInvo,\n      'itemList':this.itemList,\n      'selectedAccount' : this.selectedAccount,\n      'sub_nameNew' : this.sub_nameNew ,\n      \"user_name\" : this.user_info.full_name ,\n      \"sub_balanse\": this.selectedAccount.sub_balance,\n      \"balanceStatus\":  this.selectedAccount.currentCustumerStatus \n    }) \n      //console.log(this.printArr)\n      this.presentAlertConfirm()\n      this.presentToast('تم الحفظ بنجاح', 'success')\n      this.prepareInvo()\n      this.status = 'new'\n      \n      // Navigate back if coming from items page\n      if (this.showBackButton) {\n        setTimeout(() => {\n          this.goBack();\n        }, 1500); // Give time for toast to show\n      }\n  }, (err) => {\n    //console.log(err);\n    this.presentToast('لم يتم حفظ البيانات , خطا في الإتصال حاول مرة اخري' , 'danger')\n  }, () => {\n    this.loadingController.dismiss()\n  }\n  )      \n}\n\ngoBack() {\n  this._location.back();\n}\n\n// Handle account selection from AccountSelectorComponent\nonAccountSelected(account: any) {\n  if (account) {\n    this.selectedAccount = {\n      id: account.id,\n      ac_id: account.ac_id,\n      sub_name: account.sub_name,\n      sub_type: account.sub_type,\n      sub_code: account.sub_code,\n      sub_balance: account.sub_balance,\n      store_id: account.store_id,\n      cat_name: account.cat_name,\n      cat_id: account.cat_id,\n      phone: account.phone,\n      address: account.address,\n      currentCustumerStatus: 0\n    };\n    \n    // Update invoice with selected account\n    this.payInvo.cust_id = account.id;\n    this.payInvo.sub_name = account.sub_name;\n    \n    console.log('Account selected in sales:', this.selectedAccount);\n  }\n}\n\n// Handle account balance loaded\nonAccountBalanceLoaded(balance: any) {\n  if (balance && this.selectedAccount) {\n    // Update the current customer status based on balance\n    this.currentCustumerStatus = balance.status === 'debit' ? 0 : 1;\n    console.log('Account balance loaded in sales:', balance);\n  }\n}\n\nasync openPriceAdjustmentDialog() {\n  if (!this.itemList || this.itemList.length === 0) {\n    this.presentToast('لا توجد أصناف في القائمة لتعديل أسعارها', 'warning');\n    return;\n  }\n\n  // Transform itemList to the format expected by the dialog\n  const itemsToPass = this.itemList.map(item => ({\n    qty: item.quantity,\n    id: item.item_id,\n    item_name: item.item_name,\n    perch_price: item.perch_price,\n    pay_price: item.pay_price,\n    item_unit: item.item_unit || '',\n    parcode: item.parcode || 0,\n    tax: item.tax || 0,\n    imageUrl: item.imageUrl || ''\n  }));\n\n  const modal = await this.modalController.create({\n    component: PriceAdjustmentDialogComponent,\n    cssClass: 'price-adjustment-modal',\n    componentProps: {\n      itemsList: itemsToPass,\n      mode: 'sales'\n    }\n  });\n\n  modal.onDidDismiss().then((result) => {\n    if (result.data) {\n      this.handlePriceAdjustmentResult(result.data);\n    }\n  });\n\n  return await modal.present();\n}\n\nprivate handlePriceAdjustmentResult(updatedItems: any[]) {\n  if (!updatedItems || updatedItems.length === 0) return;\n\n  // Update the itemList with new prices\n  updatedItems.forEach(updatedItem => {\n    const itemIndex = this.itemList.findIndex(item => \n      item.item_id === updatedItem.id && item.item_name === updatedItem.item_name\n    );\n    \n    if (itemIndex !== -1) {\n      // Update the pay_price and recalculate total\n      this.itemList[itemIndex].pay_price = parseFloat(updatedItem.pay_price) || 0;\n      this.itemList[itemIndex].tot = (this.itemList[itemIndex].quantity * this.itemList[itemIndex].pay_price).toFixed(2);\n    }\n  });\n\n  // Recalculate totals using existing method\n  this.getTotal();\n  \n  this.presentToast('تم تعديل الأسعار بنجاح', 'success');\n}\n\nsortItemListAlphabetically() {\n  if (!this.itemList || this.itemList.length === 0) {\n    return;\n  }\n  \n  if (this.isItemListSorted) {\n    // If already sorted, restore original order\n    this.sortedItemList = [...this.itemList];\n    this.isItemListSorted = false;\n  } else {\n    // Sort alphabetically by item_name\n    this.sortedItemList = [...this.itemList].sort((a, b) => {\n      const nameA = a.item_name ? a.item_name.toString().toLowerCase() : '';\n      const nameB = b.item_name ? b.item_name.toString().toLowerCase() : '';\n      return nameA.localeCompare(nameB, 'ar', { numeric: true });\n    });\n    this.isItemListSorted = true;\n  }\n}\n\ngetDisplayItemList() {\n  return this.sortedItemList.length > 0 ? this.sortedItemList : this.itemList;\n}\n\nupdateSortedList() {\n  if (this.isItemListSorted) {\n    this.sortItemListAlphabetically();\n  } else {\n    this.sortedItemList = [...this.itemList];\n  }\n}\n\nonSearchTermChange() {\n  this.searchMatches = [];\n  this.highlightedIndex = -1;\n  \n  if (this.searchTerm.trim() === '') {\n    return;\n  }\n  \n  const displayList = this.getDisplayItemList();\n  const searchTermLower = this.searchTerm.toLowerCase().trim();\n  \n  displayList.forEach((item, index) => {\n    if (item.item_name && item.item_name.toLowerCase().includes(searchTermLower)) {\n      this.searchMatches.push(index);\n    }\n  });\n  \n  if (this.searchMatches.length > 0) {\n    this.highlightedIndex = 0;\n    this.scrollToHighlightedItem();\n  }\n}\n\nnavigateSearch(direction: 'next' | 'prev') {\n  if (this.searchMatches.length === 0) return;\n  \n  if (direction === 'next') {\n    this.highlightedIndex = (this.highlightedIndex + 1) % this.searchMatches.length;\n  } else {\n    this.highlightedIndex = this.highlightedIndex <= 0 ? this.searchMatches.length - 1 : this.highlightedIndex - 1;\n  }\n  \n  this.scrollToHighlightedItem();\n}\n\nscrollToHighlightedItem() {\n  if (this.highlightedIndex >= 0 && this.searchMatches.length > 0) {\n    const targetIndex = this.searchMatches[this.highlightedIndex];\n    setTimeout(() => {\n      const tableContainer = document.querySelector('.table-container');\n      const targetRow = document.querySelector(`tr[data-index=\"${targetIndex}\"]`);\n      if (tableContainer && targetRow) {\n        targetRow.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      }\n    }, 100);\n  }\n}\n\nisHighlighted(index: number): boolean {\n  return this.searchMatches.includes(index) && this.searchMatches[this.highlightedIndex] === index;\n}\n\nisSearchMatch(index: number): boolean {\n  return this.searchMatches.includes(index);\n}\n\nclearSearch() {\n  this.searchTerm = '';\n  this.searchMatches = [];\n  this.highlightedIndex = -1;\n}\n\ngetSearchResultText(): string {\n  if (this.searchTerm.trim() === '') return '';\n  if (this.searchMatches.length === 0) return 'لا توجد نتائج';\n  return `${this.highlightedIndex + 1} من ${this.searchMatches.length}`;\n}\n\nhighlightText(text: string, searchTerm: string): string {\n  if (!text || !searchTerm.trim()) {\n    return text || '';\n  }\n  \n  const regex = new RegExp(`(${searchTerm.trim()})`, 'gi');\n  return text.replace(regex, '<mark>$1</mark>');\n}\n\n}"],"names":[],"sourceRoot":"webpack:///"}